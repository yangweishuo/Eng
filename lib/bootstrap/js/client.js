/**
 * crisp-client - Simple customer service built for startups.
 * @version v2.0.1
 * @author Crisp IM, Inc. https://crisp.im/
 * @date 5/7/2017
 */
(function(){var e=!1;try{var t={};t.Library=new(function(){function e(){var e="constructor";try{this.ns="CrispLibrary";var i={},r=t,n={environment:"production"};i.Console=function(){var e={};return e._environment=n.environment,e._development="development"==e._environment,e._available="undefined"!=typeof window.console,e._has=e._development&&e._available,e._log_sink=function(e,t,i){},e.warn=function(t,i){e._has&&console.warn(t,i),e._log_sink("warn",t,i)},e.error=function(t,i){e._has&&console.error(t,i),e._log_sink("error",t,i)},e.info=function(t,i){e._has&&console.info(t,i),e._log_sink("info",t,i)},e.log=function(t,i){e._has&&console.log(t,i),e._log_sink("log",t,i)},e.debug=function(t,i){e._has&&("undefined"!=typeof console.debug?console.debug(t,i):console.log(t,i)),e._log_sink("debug",t,i)},e.set_log_sink=function(t){if("function"!=typeof t)throw new Error("Expected log sink argument to be a function");e._log_sink=t},e}(),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof __crisp_void_define&&define.amd)define([],e);else{var t;"undefined"!=typeof i?t=i:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.jade=e()}}(function(){return function e(t,i,r){function n(a,o){if(!i[a]){if(!t[a]){var c="function"==typeof require&&require;if(!o&&c)return c(a,!0);if(s)return s(a,!0);var _=new Error("Cannot find module '"+a+"'");throw _.code="MODULE_NOT_FOUND",_}var l=i[a]={exports:{}};t[a][0].call(l.exports,function(e){var i=t[a][1][e];return n(i?i:e)},l,l.exports,e,t,i,r)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(e,t,i){"use strict";function r(e){return null!=e&&""!==e}function n(e){return(Array.isArray(e)?e.map(n):e&&"object"==typeof e?Object.keys(e).filter(function(t){return e[t]}):[e]).filter(r).join(" ")}i.merge=function e(t,i){if(1===arguments.length){for(var n=t[0],s=1;s<t.length;s++)n=e(n,t[s]);return n}var a=t.class,o=i.class;(a||o)&&(a=a||[],o=o||[],Array.isArray(a)||(a=[a]),Array.isArray(o)||(o=[o]),t.class=a.concat(o).filter(r));for(var c in i)"class"!=c&&(t[c]=i[c]);return t},i.joinClasses=n,i.cls=function(e,t){for(var r=[],s=0;s<e.length;s++)t&&t[s]?r.push(i.escape(n([e[s]]))):r.push(n(e[s]));var a=n(r);return a.length?' class="'+a+'"':""},i.style=function(e){return e&&"object"==typeof e?Object.keys(e).map(function(t){return t+":"+e[t]}).join(";"):e},i.attr=function(e,t,r,n){return"style"===e&&(t=i.style(t)),"boolean"==typeof t||null==t?t?" "+(n?e:e+'="'+e+'"'):"":0==e.indexOf("data")&&"string"!=typeof t?(JSON.stringify(t).indexOf("&")!==-1&&console.warn("Since Jade 2.0.0, ampersands (`&`) in data attributes will be escaped to `&amp;`"),t&&"function"==typeof t.toISOString&&console.warn("Jade will eliminate the double quotes around dates in ISO form after 2.0.0")," "+e+"='"+JSON.stringify(t).replace(/'/g,"&apos;")+"'"):r?(t&&"function"==typeof t.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+e+'="'+i.escape(t)+'"'):(t&&"function"==typeof t.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+e+'="'+t+'"')},i.attrs=function(e,t){var r=[],s=Object.keys(e);if(s.length)for(var a=0;a<s.length;++a){var o=s[a],c=e[o];"class"==o?(c=n(c))&&r.push(" "+o+'="'+c+'"'):r.push(i.attr(o,c,!1,t))}return r.join("")},i.escape=function(e){var t=String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");return t===""+e?e:t},i.rethrow=function t(i,r,n,s){if(!(i instanceof Error))throw i;if(!("undefined"==typeof window&&r||s))throw i.message+=" on line "+n,i;try{s=s||e("fs").readFileSync(r,"utf8")}catch(e){t(i,null,n)}var a=3,o=s.split("\n"),c=Math.max(n-a,0),_=Math.min(o.length,n+a),a=o.slice(c,_).map(function(e,t){var i=t+c+1;return(i==n?"  > ":"    ")+i+"| "+e}).join("\n");throw i.path=r,i.message=(r||"Jade")+":"+n+"\n"+a+"\n\n"+i.message,i}},{fs:2}],2:[function(e,t,i){},{}]},{},[1])(1)}),function(e,t){"function"==typeof __crisp_void_define&&define.amd?define(t):"undefined"!=typeof exports?module.exports=t():e.cash=e.$=t()}(i,function(){function e(t,i){return new e.fn.init(t,i)}function t(e){var t=t||s.createDocumentFragment(),i=i||t.appendChild(s.createElement("div"));return i.innerHTML=e,i}function i(e,t){return parseInt(a.getComputedStyle(e[0],null)[t],10)}function r(){function e(e){var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t}return e()+e(!0)+e(!0)+e()}function n(t,i,n){var s=e(t).data("cshid")||r();e(t).data("cshid",s),s in f||(f[s]={}),i in f[s]||(f[s][i]=[]),f[s][i].push(n)}var s=document,a=window,o=Array.prototype,c=o.slice,_=o.filter,l=/^#[\w-]*$/,p=/^\.[\w-]*$/,h=/^[\w-]*$/,u=e.fn=e.prototype={cash:!0,length:0};u.init=function(t,i){var r,n,a=[];if(!t)return this;if(this.length=1,"string"!=typeof t)return t.cash?t:(this[0]=t,this);if("<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3)a=e.parseHTML(t);else{if(r=l.test(t),n=t.slice(1),!i&&r)return this[0]=s.getElementById(n),this;i=e(i)[0]||s,a=c.call(h.test(n)?p.test(t)?s.getElementsByClassName(n):s.getElementsByTagName(t):i.querySelectorAll(t))}return this.length=0,e.merge(this,a),this},u.init.prototype=u,e.each=function(e,t){for(var i=e.length,r=0;r<i;r++)t.call(e[r],e[r],r,e)},e.extend=u.extend=function(e,t){var i;t||(t=e,e=this);for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},e.matches=function(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)},e.merge=function(e,t){for(var i=+t.length,r=e.length,n=0;n<i;r++,n++)e[r]=t[n];return e.length=r,e},e.parseHTML=function(e){var i=/^<(\w+)\s*\/?>(?:<\/\1>|)$/.exec(e);return i?[s.createElement(i[1])]:(i=t(e),c.call(i.childNodes))},e.unique=function(t){return e.merge(e(),c.call(t).filter(function(e,t,i){return i.indexOf(e)===t}))};var d=/\S+/g;u.extend({addClass:function(e){var t,i,r=e.match(d);return this.each(function(e){if(i=r.length,e.classList)for(;i--;)e.classList.add(r[i]);else for(;i--;)t=" "+e.className+" ",t.indexOf(" "+r[i]+" ")===-1&&(e.className+=" "+r[i])}),this},attr:function(e,t){return t?(this.each(function(i){return i.setAttribute(e,t)}),this):this[0].getAttribute(e)},hasClass:function(e){return this[0].classList?this[0].classList.contains(e):this[0].className.indexOf(e)!==-1},prop:function(e){return this[0][e]},removeAttr:function(e){return this.each(function(t){return t.removeAttribute(e)}),this},removeClass:function(e){var t,i,r=e.match(d);return this.each(function(e){if(t=r.length,e.classList)for(;t--;)e.classList.remove(r[t]);else{for(i=" "+e.className+" ";t--;)i=i.replace(" "+r[t]+" "," ");e.className=i.trim()}}),this}}),u.extend({add:function(){var t,i=c.call(this),r=0;for(t=arguments.length;r<t;r++)i=i.concat(c.call(e(arguments[r])));return e.unique(i)},each:function(t){e.each(this,t)},eq:function(t){return e(this[t])},filter:function(t){return"string"==typeof t?_.call(this,function(i){return e.matches(i,t)}):_.call(this,t)},first:function(){return e(this[0])},get:function(e){return this[e]},index:function(t){return t?c.call(e(t).children()).indexOf(this[0]):c.call(e(this[0]).parent().children()).indexOf(this[0])},last:function(){return e(this[this.length-1])}}),u.extend({css:function(e,t){return"object"!=typeof e?t?(this.each(function(i){return i.style[e]=t}),this):a.getComputedStyle(this[0],null)[e]:void this.each(function(t){for(var i in e)e.hasOwnProperty(i)&&(t.style[i]=e[i])})}}),u.extend({data:function(t,i){return i?(this.each(function(r){r.dataset?r.dataset[t]=i:e(r).attr("data-"+t,i)}),this):this[0].dataset?this[0].dataset[t]:e(this[0]).attr("data-"+t)},removeData:function(t){return this.each(function(i){i.dataset?delete i.dataset[t]:e(i).removeAttr("data-"+t)}),this}}),u.extend({height:function(){return this[0].getBoundingClientRect().height},innerWidth:function(){return this[0].clientWidth},innerHeight:function(){return this[0].clientHeight},outerWidth:function(e){return e===!0?this[0].offsetWidth+(i(this,"margin-left")||i(this,"marginLeft")||0)+(i(this,"margin-right")||i(this,"marginRight")||0):this[0].offsetWidth},outerHeight:function(e){return e===!0?this[0].offsetHeight+(i(this,"margin-top")||i(this,"marginTop")||0)+(i(this,"margin-bottom")||i(this,"marginBottom")||0):this[0].offsetHeight},width:function(){return this[0].getBoundingClientRect().width}});var f={};u.extend({off:function(t,i){return this.each(function(r){if(i)r.removeEventListener(t,i);else for(var n in f[e(r).data("cshid")][t])r.removeEventListener(t,f[e(r).data("cshid")][t][n])}),this},on:function(t,i,r){return"function"==typeof i?(r=i,this.each(function(i){n(e(i),t,r),i.addEventListener(t,r)}),this):(this.each(function(s){function a(t){var n=t.target;if(e.matches(n,i))r.call(n);else{for(;!e.matches(n,i);){if(n===s)return n=!1;n=n.parentNode}n&&r.call(n)}}n(e(s),t,a),s.addEventListener(t,a)}),this)},ready:function(e){this[0].addEventListener("DOMContentLoaded",e)},trigger:function(e){var t=s.createEvent("HTMLEvents");return t.initEvent(e,!0,!1),this.each(function(e){return e.dispatchEvent(t)}),this}});var g=encodeURIComponent;return u.extend({serialize:function(){var e,t,i,r=this[0],n="";for(t=r.elements.length-1;t>=0;t--)if(e=r.elements[t],e.name&&"file"!==e.type&&"reset"!==e.type)if("select-multiple"===e.type)for(i=r.elements[t].options.length-1;i>=0;i--)e.options[i].selected&&(n+="&"+e.name+"="+g(e.options[i].value).replace(/%20/g,"+"));else"submit"!==e.type&&"button"!==e.type&&(n+="&"+e.name+"="+g(e.value).replace(/%20/g,"+"));return n.substr(1)},val:function(e){return void 0===e?this[0].value:(this.each(function(t){return t.value=e}),this)}}),u.extend({append:function(t){return this[0].appendChild(e(t)[0]),this},appendTo:function(t){return e(t)[0].appendChild(this[0]),this},clone:function(){return e(this[0].cloneNode(!0))},empty:function(){return this.each(function(e){return e.innerHTML=""}),this},html:function(t){var i;return"undefined"===t?this[0].innerHTML:(i="object"==typeof t?e(t)[0].outerHTML:t,this.each(function(e){return e.innerHTML=""+i}),this)},insertAfter:function(t){return e(t)[0].insertAdjacentHTML("afterend",this[0].outerHTML),this},insertBefore:function(t){return e(t)[0].insertAdjacentHTML("beforebegin",this[0].outerHTML),this},prepend:function(t){return e(this)[0].insertAdjacentHTML("afterBegin",e(t)[0].outerHTML),this},prependTo:function(t){return e(t)[0].insertAdjacentHTML("afterBegin",this[0].outerHTML),this},remove:function(){this.each(function(e){return e.parentNode.removeChild(e)})},text:function(e){return e?(this.each(function(t){return t.textContent=e}),this):this[0].textContent}}),u.extend({children:function(t){return t?e(this[0].children).filter(function(i){return e.matches(i,t)}):e.fn.extend(this[0].children,e.fn)},closest:function(t){return!t||e.matches(this[0],t)?this:this.parent().closest(t)},is:function(t){return!!t&&(t.cash?this[0]===t[0]:"string"==typeof t&&e.matches(this[0],t))},find:function(t){return e.fn.extend(this[0].querySelectorAll(t),e.fn)},has:function(t){return _.call(this,function(i){return 0!==e(i).find(t).length})},next:function(){return e(this[0].nextElementSibling)},not:function(t){return _.call(this,function(i){return!e.matches(i,t)})},parent:function(){var t=o.map.call(this,function(e){return e.parentElement||s.body.parentNode});return e.unique(t)},parents:function(t){var i,r=[],n=0;return this.each(function(a){for(i=a;i!==s.body.parentNode;)i=i.parentElement,(!t||t&&e.matches(i,t))&&(r[n]=i,n++)}),e.unique(r)},prev:function(){return e(this[0].previousElementSibling)},siblings:function(){var e=this.parent().children(),t=this[0];return _.call(e,function(e){return e!==t})}}),e}),function(e,t){e.CrispLibraryWeb=new t}(i,function(){function e(){}return e.prototype.init=function(e){var t=function(){function e(e){this.parent=e,this.__smiley_list={angry:/(^|\s|\()((?:=|:)(?:-)?@)($|\s|\))/i,blushing:/(^|\s|\()((?:=|:)(?:-)?\$)($|\s|\))/i,cool:/(^|\s|\()(8(?:-)?\))($|\s|\))/i,confused:/(^|\s|\()(x(?:-)?\))($|\s|\))/i,crying:/(^|\s|\()((?:=|:)&#039;(?:-)?\()($|\s|\))/i,embarrased:/(^|\s|\()((?:=|:)(?:-)?\/)($|\s|\))/i,heart:/(^|\s|\()(&lt;3)($|\s|\))/i,laughing:/(^|\s|\()((?:=|:)(?:-)?&#039;D)($|\s|\))/i,sad:/(^|\s|\()((?:=|:)(?:-)?(?:\(|\|))($|\s|\))/i,sick:/(^|\s|\()((?:=|:)(?:-)?S)($|\s|\))/i,"small-smile":/(^|\s|\()((?:=|:)(?:-)?\))($|\s|\))/i,"big-smile":/(^|\s|\()((?:=|:)(?:-)?D)($|\s|\))/i,"thumbs-up":/(^|\s|\()(\+1)($|\s|\))/i,surprised:/(^|\s|\()((?:=|:)(?:-)?o)($|\s|\))/i,tongue:/(^|\s|\()((?:=|:)(?:-)?P)($|\s|\))/i,winking:/(^|\s|\()(;(?:-)?\))($|\s|\))/i}}return e.prototype.code=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"small",i=this.parent.template.render("smiley",{name:e,size:t});return i},e.prototype.parse=function(e){var t=void 0,i=void 0,r=void 0,n=void 0,s=void 0,a=e;for(t in this.__smiley_list)this.__smiley_list.hasOwnProperty(t)&&(i=this.__smiley_list[t],s=a.match(i),s&&(r="small",a===s[2]&&(r="large"),n=this.code(t,r),a=a.replace(i,"$1"+n+"$3")));return a},e.prototype.name=function(e){var t=void 0,i=void 0,r=null;for(t in this.__smiley_list)if(this.__smiley_list.hasOwnProperty(t)&&(i=this.__smiley_list[t],e.match(i))){r=t;break}return r},e}(),i=function(){function e(e){this.parent=e,this.__gtld_list=["ac","ad","ae","aero","af","ag","ai","al","am","an","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","be","bf","bg","bh","bi","biz","bj","bm","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","cl","cm","cn","co","com","coop","cr","cu","cv","cw","cx","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","es","eu","fi","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","im","in","info","int","io","iq","ir","is","it","je","jo","jobs","jp","kg","ki","km","kn","kp","kr","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","na","name","nc","ne","net","nf","ng","nl","no","nr","nu","nz","om","org","pa","pe","pf","ph","pk","pl","pm","pn","post","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","st","su","sv","sx","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tp","travel","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","yt","امارات","বাংলা","中国","中國","الجزائر","مصر","გე","香港","भारत","بھارت","భారత్","ભારત","ਭਾਰਤ","ভারত","இந்தியா","ایران","ايران","الاردن","한국","қаз","ලංකා","இலங்கை","المغرب","мон","مليسيا","عمان","فلسطين","срб","рф","قطر","السعودية","السعودیة","السعودیۃ","السعوديه","سورية","سوريا","新加坡","சிங்கப்பூர்","ไทย","تونس","台灣","台湾","臺灣","укр","اليمن","xxx","онлайн","сайт","شبكة","游戏","企业","camera","clothing","lighting","singles","ventures","voyage","guru","holdings","equipment","bike","estate","tattoo","在线","中文网","land","plumbing","contractors","sexy","menu","世界","uno","gallery","technology","集团","reviews","guide","我爱你","graphics","construction","onl","みんな","diamonds","kiwi","enterprises","today","futbol","photography","tips","directory","kitchen","移动","kim","삼성","monash","wed","pink","ruhr","buzz","careers","shoes","موقع","career","otsuka","中信","gift","recipes","coffee","luxury","domains","photos","limo","viajes","wang","democrat","mango","cab","support","dance","nagoya","computer","wien","berlin","codes","email","بازار","repair","holiday","center","systems","wiki","ceo","international","solar","company","education","training","academy","marketing","florist","solutions","build","institute","builders","red","blue","ninja","business","gal","social","house","camp","immobilien","moda","glass","management","kaufen","farm","公益","政务","club","voting","tokyo","moe","guitars","bargains","组织机构","desi","cool","boutique","pics","орг","公司","网络","cheap","广东","photo","network","zone","机构","link","qpon","संगठन","agency","tienda","works","london","watch","rocks","shiksha","дети","budapest","nrw","vote","fishing","expert","horse","christmas","cooking","商城","casa","rich","voto","tools","八卦","praxi","events","flights","report","partners","neustar","rentals","catering","community","maison","parts","cleaning","okinawa","foundation","properties","vacations","productions","industries","haus","vision","mormon","cards","ink","villas","consulting","cruises","krd","xyz","dating","exposed","condos","eus","caravan","actor","saarland","yokohama","pub","рус","ren","fish","bar","dnp","bid","supply","miami","supplies","quebec","moscow","globo","axa","москва","商店","vodka","rest","frogans","wtc","rodeo","sohu","best","country","kred","feedback","work","luxe","ryukyu","autos","homes","jetzt","yachts","motorcycles","mini","ggee","beer","佛山","college","ovh","meet","网址","gop","blackfriday","lacaixa","商标","vegas","black","soy","trade","gent","ing","dad","shriram","bayern","scot","webcam","foo","eat","nyc","prod","how","day","meme","mov","paris","boo","new","ifm","life","archi","spiegel","brussels","church","here","dabur","vlaanderen","cologne","手机","wme","nhk","suzuki","whoswho","scb","hamburg","services","bzh","rio","cash","gives","hiphop","degree","digital","rehab","wtf","financial","limited","discount","fail","vet","ngo","fitness","schule","navy","bio","ong","town","toys","army","engineering","capital","exchange","fan","market","media","lease","university","reisen","airforce","pictures","gripe","engineering","associates","政府","williamhill","hiv","sca","reise","accountants","clinic","versicherung","top","furniture","dental","fund","creditcard","insure","audio","claims","loans","auction","attorney","finance","investments","juegos","dentist","lds","lawyer","surgery","gratis","software","mortgage","republican","credit","tax","africa","joburg","durban","capetown","sap","datsun","infiniti","firmdale","organic","nissan","website","space","schmidt","cuisinella","samsung","crs","doosan","press","emerck","erni","direct","yandex","lotto","toshiba","bauhaus","host","ltda","global","abogado","place","tirol","gmx","tatar","scholarships","eurovision","wedding","active","madrid","youtube","sharp","uol","physio","gmail","channel","fly","zip","esq","rsvp","wales","cymru","green","lgbt","网店","cancerresearch","everbank","frl","property","forsale","seat","deals","nra","娱乐","realtor","bnpparibas","melbourne","hosting","yoga","city","bond","click","cern"],this.__html_escape={"&amp;":/&/g,"&lt;":/</g,"&gt;":/>/g,"&quot;":/"/g,"&#039;":/'/g},this.__attribute_escape={"\\\\":/\\/g,"\\t":/\t/g,"\\n":/\n/g,"\\u00A0":/\u00A0/g},this.__links_regex={email:new RegExp("(\\s|<[^<>]+\\/>|<[^a][^<>]*>|^)([\\w\\._-]+@[\\w\\.\\/_-]+)(,|\\s|<[^<>]+\\/>|</[^a][^<>]*>|$)","gi"),domain:new RegExp("(\\s|<[^<>]+\\/>|<[^a][^<>]*>|^|\\()((?:[^<>\\s@]+)(?:\\.(?:"+this.__gtld_list.map(this.__regex_escape).join("|")+")))(,|\\s|<[^<>]+\\/>|</[^a][^<>]*>|$)","gim"),uri:new RegExp("(\\s|<[^<>]+\\/>|<[^a][^<>]*>|^|\\()((?:https?|ftps?|file):(?:[^<>\\s]+))(,|\\s|<[^<>]+\\/>|</[^a][^<>]*>|$)","gim")},this.__markdown_regex=[["title",/(^)(#{1})([^#].*)($)/gim],["title",/(^)(#{2})([^#].*)($)/gim],["title",/(^)(#{3})([^#].*)($)/gim],["title",/(^)(#{4})([^#].*)($)/gim],["title",/(^)(#{5})([^#].*)($)/gim],["title",/(^)(#{6})([^#].*)($)/gim],["image",new RegExp("(\\s|<[^<>]+\\/>|<[^<>]+>|^)!\\[([^\\[]*)\\]\\(([^\\)]+)\\)(\\s|<[^<>]+\\/>|$)","gim")],["link",new RegExp("(\\s|<[^<>]+\\/>|<[^a][^<>]*>|^)\\[([^\\[]+)\\]\\(([^\\)]+)\\)(\\s|<[^<>]+\\/>|</[^a][^<>]*>|$)","gim")],["bold",/(\s|<[^<>]+\/>|^)(\*\*)(.*?)(?:\2)/gim],["underline",/(\s|<[^<>]+\/>|^)(__)(.*?)(?:\2)/gim],["italic",/(\s|<[^<>]+\/>|^)(\*|_)(.*?)(?:\2)/gim],["delete",/(\s|<[^<>]+\/>|^)(\~\~)(.*?)(?:\2)/gim],["list",/(^\s*)(\*|(?:[\d]+\.))(?:[\s]+)(.*?)($)/gim],["code",/(\s|<[^<>]+\/>|^)(`{1,3})([^`].*)(?:\2)(\s|$)/gim],["blockquote",/(^)(&gt;|\>)(.*)($)/gim],["line",/(^)(\s+)?(-{3,})(\s|$)/gim]],this.__markdown_trim_items=["title","list","code","blockquote"],this.__shortcuts_regex_cache={},this.__shortcuts_list={},this.__shorcuts_list_extended=!1,this.__format_pipeline=[this.__apply_escape,this.__apply_consecutive_lines,this.__apply_markdown,this.__apply_shortcuts,this.__apply_links_uri,this.__apply_links_domain,this.__apply_emails,this.__apply_smileys,this.__apply_new_lines]}return e.prototype.format=function(e){var t=void 0,i=e;for(t=0;t<this.__format_pipeline.length;t++)i=this.__format_pipeline[t].bind(this)(i);return i},e.prototype.replace=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=void 0,r=void 0,n=e;for(i=0;i<t.length;i++)r=i+1,n=n.replace("%"+r+"s",t[i]);return n},e.prototype.attribute=function(e){return this.__apply_escape(e,"attribute")},e.prototype.__apply_escape=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"html",i=void 0,r=void 0,n=e,s=this["__"+t+"_escape"];for(r in s)s.hasOwnProperty(r)&&(i=s[r],n=n.replace(i,r));return n},e.prototype.__apply_consecutive_lines=function(e){return e.replace(/\n(\s+)?\n(\s+)?\n/g,"\n\n")},e.prototype.__apply_new_lines=function(e){var t=this.parent.template.render("new_line");return e.trim().replace(/\n/g,t)},e.prototype.__apply_emails=function(e){var t=this;return e.replace(this.__links_regex.email,function(e,i,r,n){var s=t.parent.template.render("link_email",{email:r,no_external_link:t.parent.config.runtime.no_external_link||!1});return""+i+s+n})},e.prototype.__apply_markdown=function(e){e="\n"+e+"\n";for(var t=0;t<this.__markdown_regex.length;t++)e=e.replace(this.__markdown_regex[t][1],this.__replace_markdown_item(this.__markdown_regex[t]));return e=e.trim()},e.prototype.__apply_links_domain=function(e){var t=this;return e.replace(this.__links_regex.domain,function(e,i,r,n){var s=t.parent.template.render("link_domain",{domain_value:r,domain_name:r,no_external_link:t.parent.config.runtime.no_external_link||!1});return""+i+s+n})},e.prototype.__apply_links_uri=function(e){var t=this;return e.replace(this.__links_regex.uri,function(e,i,r,n){var s=t.parent.template.render("link_uri",{uri_value:r,uri_name:r,no_external_link:t.parent.config.runtime.no_external_link||!1});return""+i+s+n})},e.prototype.__apply_shortcuts=function(e){var t=this,i=void 0,r=void 0,n=e;return this.__discover_shortcuts(),Object.keys(this.__shortcuts_list).forEach(function(e){t.__shortcuts_list.hasOwnProperty(e)&&(i=t.__shortcuts_list[e],"undefined"==typeof t.__shortcuts_regex_cache[e]&&(r=t.__regex_escape(e),t.__shortcuts_regex_cache[e]=new RegExp("([^\\w.<>/-]+|^)"+("("+r+")")+"([^\\w.<>/-]+|$)","gi")),n=n.replace(t.__shortcuts_regex_cache[e],function(e,r,n,s){var a=t.parent.template.render("link_uri",{uri_value:i,uri_name:n});return""+r+a+s}))}),n},e.prototype.__apply_smileys=function(e){return this.parent.Smileys.parse(e)},e.prototype.__replace_markdown_item=function(e){var t=this;return function(i,r,n,s,a){var o="",c="",_={type:null,value:null,url_crisp_image:t.parent.config.url.crisp_image,no_external_link:t.parent.config.runtime.no_external_link||!1};o=("string"==typeof r?r:null)||"",c=("string"==typeof a?a:null)||"",_.type=n,_.value=s,t.__markdown_trim_items.indexOf(e[0])!==-1&&"string"==typeof _.value&&(_.value=_.value.trim());var l=t.parent.template.render("markdown_"+e[0],_);return""+o+l+c}},e.prototype.__discover_shortcuts=function(){this.__shorcuts_list_extended!==!0&&(this.__shortcuts_list.crisp=this.parent.config.url.crisp_web,this.parent.config.context&&this.parent.config.context.name&&this.parent.config.context.protocol&&this.parent.config.context.domain&&(this.__shortcuts_list[(""+this.parent.config.context.name).toLowerCase()]=this.parent.config.context.protocol+"//"+(this.parent.config.context.domain+"/")),this.__shorcuts_list_extended=!0)},e.prototype.__regex_escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},e}(),r=function(){function e(e){this.parent=e,this.__full_name_regex=/^(\S+)((\s+)(.+))?$/}return e.prototype.parse_first_name=function(e){var t=e;if(t){t=t.trim();var i=t.match(this.__full_name_regex);i&&(t=i[1])}return t},e}();this.__configure(e),this.Smileys=new t(this),this.Parse=new i(this),this.Name=new r(this)},e.prototype.__configure=function(e){e&&e.template&&(this.template=e.template),e&&e.config&&(this.config=e.config)},e}()),function(e,t){e.CrispLibraryClient=new t}(i,function(){function e(){}return e.prototype.init=function(e){var t={},i=function(){function e(e){this.parent=e,this.__init_storage()}return e.prototype.set_ignore_privacy=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._ignore_privacy=e},e.prototype._clear=function(){this.__init_storage()},e.prototype.__init_storage=function(){this._ignore_privacy=!1},e}(),r=function(){function e(e){this.parent=e,this.__message_compose_resend_delay=6e4,this.__message_compose_debounce_delay=2e3,this.__message_compose_regex=/(^(?:\S+(?:\s+|\?|\!|\.|\(|\)|:|;))+).*$/i,this.__init_storage(),this.__init_events()}return e.prototype.send_text_message=function(e){this.__send_raw_message({type:"text",origin:"chat",content:e,timestamp:Date.now(),fingerprint:this.__gen_fingerprint()})},e.prototype.send_file_message=function(e,t,i){this.__send_raw_message({type:"file",origin:"chat",content:{name:e,url:t,type:i},timestamp:Date.now(),fingerprint:this.__gen_fingerprint()})},e.prototype.send_animation_message=function(e,t){this.__send_raw_message({type:"animation",origin:"chat",content:{url:e,type:t},timestamp:Date.now(),fingerprint:this.__gen_fingerprint()})},e.prototype.send_message_compose=function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.parent.Config._ignore_privacy!==!0&&"1"===(navigator||{}).doNotTrack&&(i=null),i=this.__rasterize_message_compose_excerpt(i);var r=e!==this.__message_compose.local.type&&!0;(r===!0||i!==(this.__message_compose.local.excerpt||null)||"start"===this.__message_compose.local.type&&this.__message_compose_local_since&&Date.now()-this.__message_compose_local_since>=this.__message_compose_resend_delay)&&(this.__message_compose_local_since=Date.now(),this.__message_compose.local={type:e},i&&(this.__message_compose.local.excerpt=i),r===!0&&null!==this.__defer_compose_debounce&&(clearTimeout(this.__defer_compose_debounce),this.__defer_compose_debounce=null),null===this.__defer_compose_debounce&&(this.__defer_compose_debounce=setTimeout(function(){t.__defer_compose_debounce=null,t.parent.socket.emit("message:compose:send",t.__message_compose.local),t.parent.event.publish("message:compose:send",t.__message_compose.local)},r===!0?0:this.__message_compose_debounce_delay)))},e.prototype.receive_message_local=function(e,t,i){var r={from:"operator",type:e,origin:"local",timestamp:Date.now(),content:t,fingerprint:this.__gen_fingerprint(),user:i};this.parent.socket.emit("message:received:local",r),this.__handle_message_received_local(r)},e.prototype.get_message_compose=function(){this.parent.event.publish("message:compose:received",this.__message_compose.remote)},e.prototype.count_message_history=function(){return this.__messages_history_diff.length},e.prototype.get_message_history=function(){for(var e=0;e<this.__messages.length;e++){var t=this.__messages[e];t.origin="history",t.index={current:e+1,total:this.__messages.length},t.is_me?this.parent.event.publish("history:message:sent",t):this.parent.event.publish("history:message:received",t)}for(var i=0;i<this.__messages_history_diff.length;i++){var r=this.__messages_history_diff[i];r.is_me?this.__handle_message_sent(r,origin="diff"):this.__handle_message_received(r,origin="diff")}this.__messages_history_diff=[]},e.prototype.is_sending_messages=function(){return this.__sending_messages_index.length>0&&!0},e.prototype.set_messages_in_view=function(e){this.__messages_in_view=e,this.__check_mark_messages_read()===!0&&this.__write_messages_cache()},e.prototype.get_unread_messages=function(){this.__unread_messages_count=-1,this.__handle_unread_messages()},e.prototype.set_unread_messages_callback=function(e){this.__unread_messages_callback=e},e.prototype._clear=function(){this.__init_storage()},e.prototype._storage_session_message_handle=function(e){this._restore_messages(e)},e.prototype._sync_message_compose_diff=function(e){e&&(this.__message_compose.remote=e)},e.prototype._sync_message_history_diff=function(e){if(e){this.__sort_messages_by_timestamp(e);for(var t=0;t<e.length;t++)this.__messages_history_diff.push(e[t]);this.__handle_unread_messages()}},e.prototype._restore_messages=function(e){e||(e=[]),this.__messages=e,this.__sort_messages_by_timestamp(this.__messages);for(var t=0;t<this.__messages.length;t++){var i=this.__messages[t];this.__received_messages_index.push(i.fingerprint),e[t].is_me||i.read||this.__unread_messages_index.push(i.fingerprint)}this.__handle_unread_messages()},e.prototype.__init_storage=function(){this.__messages=[],this.__messages_history_diff=[],this.__received_messages_index=[],this.__unread_messages_index=[],this.__sending_messages_index=[],this.__updated_messages_index=[],this.__defer_compose_debounce=null,this.__messages_in_view=!1,this.__unread_messages_callback=function(){},this.__unread_messages_count=-1,this.__message_compose_local_since=0,this.__message_compose={local:{type:"stop"},remote:{type:"stop"}}},e.prototype.__init_events=function(){this.parent.socket.on("message:sent",this.__handle_message_sent.__crisp_bind(this)),this.parent.socket.on("message:received",this.__handle_message_received.__crisp_bind(this)),this.parent.socket.on("message:received:local",this.__handle_message_received_local.__crisp_bind(this)),this.parent.socket.on("message:compose:received",this.__handle_message_compose_received.__crisp_bind(this)),this.parent.socket.on("message:acknowledge:read:send",this.__handle_message_read_send.__crisp_bind(this)),this.parent.socket.on("message:acknowledge:read:received",this.__handle_message_read_received.__crisp_bind(this)),this.parent.socket.on("message:acknowledge:pending",this.__handle_message_acknowledge_pending.__crisp_bind(this))},e.prototype.__rasterize_message_compose_excerpt=function(e){var t=null;if(null!==e){var i=e.match(this.__message_compose_regex);i&&(t=(i[1]||"").trim())}return t},e.prototype.__send_raw_message=function(e){this.__sending_messages_index.indexOf(e.fingerprint)===-1&&this.__sending_messages_index.push(e.fingerprint),this.parent.socket.emit("message:send",e),this.parent.event.publish("message:send",e)},e.prototype.__acknowledge_messages_pending=function(e){this.parent.socket.emit("message:acknowledge:pending",{origin:"chat",fingerprints:e}),this.parent.socket.emit("message:acknowledge:delivered",{origin:"chat",fingerprints:e})},e.prototype.__acknowledge_messages_read_received=function(e){this.parent.socket.emit("message:acknowledge:read:received",{origin:"chat",fingerprints:e})},e.prototype.__mark_messages_read=function(e,t){var i=!1;t===!1&&(this.__unread_messages_index=[],this.__handle_unread_messages());for(var r=0;r<this.__messages.length;r++){var n=this.__messages[r];if(n.read!==!0&&(0===e.length||e.indexOf(n.fingerprint)!==-1)){var s=n.is_me===!0;t===s&&(n.read=!0,i=!0,this.__set_message_updated(n))}}return i},e.prototype.__check_mark_messages_read=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t||!1;return t===!1&&this.__messages_in_view===!0&&this.__unread_messages_index.length>0&&(this.__acknowledge_messages_read_received(this.__unread_messages_index),i=!0),i===!0&&this.__mark_messages_read(e,t)},e.prototype.__write_messages_cache=function(e,t){if(this.__updated_messages_index.length>0){for(var i=[],r=0;r<this.__messages.length;r++)this.__updated_messages_index.indexOf(this.__messages[r].fingerprint)!==-1&&i.push(this.__messages[r]);this.__updated_messages_index=[],this.parent.Storage.update("message",i,e,t)}else"function"==typeof e&&e();
},e.prototype.__cache_message=function(e,t,i){this.__is_message_received(e)?"function"==typeof t&&t():(this.__received_messages_index.push(e.fingerprint),this.__messages.push(e),this.__check_mark_messages_read(),this.__set_message_updated(e),this.__write_messages_cache(t,i))},e.prototype.__set_message_updated=function(e){this.__updated_messages_index.indexOf(e.fingerprint)===-1&&this.__updated_messages_index.push(e.fingerprint)},e.prototype.__sort_messages_by_timestamp=function(e){e.sort(function(e,t){return e.timestamp<t.timestamp?-1:e.timestamp>t.timestamp?1:0})},e.prototype.__gen_fingerprint=function(){var e=100,t=15,i=""+Date.now()+Math.ceil(Math.random()*e);return i.length<t&&(i+=new Array(t-i.length+1).join("0")),i=parseInt(i,10)},e.prototype.__handle_unread_messages=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.__unread_messages_index.length;t!==this.__unread_messages_count&&(this.__unread_messages_count=t,"function"==typeof this.__unread_messages_callback&&this.__unread_messages_callback(t,this.__unread_messages_index,[].concat(this.__messages,e)))},e.prototype.__handle_message_sent=function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"network",r=this.__sending_messages_index.indexOf(e.fingerprint);r!==-1&&this.__sending_messages_index.splice(r,1),e.origin=i,e.index={current:1,total:1},this.__cache_message(e,function(){t.parent.event.publish("message:sent",e)})},e.prototype.__handle_message_received=function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"network",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"message:received";e.origin=i,e.index={current:1,total:1},this.__unread_messages_index.push(e.fingerprint),this.__handle_unread_messages(pending_messages=[e]),this.__cache_message(e,function(){t.__acknowledge_messages_pending([e.fingerprint]),t.parent.event.publish(r,e)})},e.prototype.__handle_message_received_local=function(e){this.__handle_message_received(e,origin="local",event="message:received:local")},e.prototype.__handle_message_compose_received=function(e){this.__message_compose.remote=e,this.parent.event.publish("message:compose:received",e)},e.prototype.__handle_message_read_send=function(e){this.__check_mark_messages_read(e.fingerprints,!0)===!0&&this.__write_messages_cache(),this.parent.event.publish("message:acknowledge:read:send",e.fingerprints)},e.prototype.__handle_message_read_received=function(e){for(var t=0;t<e.fingerprints.length;t++){var i=this.__unread_messages_index.indexOf(e.fingerprints[t]);i!==-1&&this.__unread_messages_index.splice(i,1)}this.__handle_unread_messages()},e.prototype.__handle_message_acknowledge_pending=function(e){this.parent.event.publish("message:acknowledge:pending",e.fingerprints)},e.prototype.__is_message_received=function(e){return this.__received_messages_index.indexOf(e.fingerprint)>-1},e}(),n=function(){function e(e){this.parent=e,this.__regex_referer=new RegExp("^(https?\\:\\/\\/[^/]+)\\/chat\\/resume\\/\\?target_url=(.+)&session_id=(.+)$"),this.__regex_parameter_sid=/^\?.*(crisp_sid=([^&=]+)).*$/,this.__consider_inactive_delay=9e4,this.__interval_heartbeat_soft=24e4,this.__interval_heartbeat_hard=3e5,this.__user_data_keys=["email","phone","nickname","avatar"],this.parent.disable_autoload||(this.__init_storage(),this.__init_events())}return e.prototype.save=function(){this.parent.cookie.set(this.__get_cookie_key(),this.__session_id,{domain:this.__get_base_domain(),expires:1/0}),this.parent.event.publish("session:saved",this.__session_id)},e.prototype.storage_session_retrieve=function(e){this.__storage_session_state_handle(e.state),this.parent.Message._storage_session_message_handle(e.message)},e.prototype.sync_session_diff=function(e){this.parent.Message._sync_message_compose_diff(e.compose),this.parent.Message._sync_message_history_diff(e.messages)},e.prototype.sync_user_data=function(e){for(var t=0;t<this.__user_data_keys.length;t++){var i=this.__user_data_keys[t];this.__user_data[i]&&this.__user_data[i]!==e[i]?this["set_"+i](this.__user_data[i],!0):this.__user_data[i]=e[i]||null}this.__sync_segments_diff(e.segments||[],this.__user_data.segments),this.__sync_data_diff(e.data||{},this.__user_data.data)},e.prototype.send_device=function(){this.parent.socket.emit("session:device",{page_url:this.parent.device.page_url,page_title:this.parent.device.page_title,page_referrer:this.parent.device.page_referrer})},e.prototype.get_request_initiate=function(e){Object.keys&&0===Object.keys(this.__state).length&&this.parent.Message.count_message_history()>0&&this.__handle_session_request_initiate({}),"function"==typeof e&&e()},e.prototype.get_state=function(e){this.handle_state(this.__state,e)},e.prototype.handle_state=function(e,t){this.__state=e,this.parent.event.publish("session:state",this.__state),"function"==typeof t&&t()},e.prototype.set_state=function(e,t){for(var i in e)this.__state[i]=e[i];this.parent.Storage.update("state",e),this.sync_state(e,t)},e.prototype.sync_state=function(e,t){this.parent.socket.emit("session:state",e),"function"==typeof t&&t()},e.prototype.create=function(){var e={website_id:this.parent.website_id,website_domain:this.parent.website_domain,useragent:this.parent.device.useragent,timezone:this.parent.device.timezone,locales:this.parent.device.locales};this.parent.token_id&&(e.token_id=this.parent.token_id),this.parent.socket.emit("session:create",e)},e.prototype.get_email=function(){return this.__user_data.email},e.prototype.set_email=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.__set_user_data_value("email",e,t)},e.prototype.get_phone=function(){return this.__user_data.phone},e.prototype.set_phone=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.__set_user_data_value("phone",e,t)},e.prototype.get_nickname=function(){return this.__user_data.nickname},e.prototype.set_nickname=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.__set_user_data_value("nickname",e,t)},e.prototype.get_avatar=function(){return this.__user_data.avatar},e.prototype.set_avatar=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.__set_user_data_value("avatar",e,t)},e.prototype.get_data=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e?this.__user_data.data:this.__user_data.data[e]||null},e.prototype.set_data=function(e,t){var i={};i[e]=t,this.__sync_data_diff(this.__user_data.data||{},i)},e.prototype.set_segments=function(e){this.__sync_segments_diff(this.__user_data.segments||[],e)},e.prototype.mark_active=function(){var e=Date.now(),t=Math.min(this.__last_active||e,this.__last_heartbeat||e);e-t>=this.__consider_inactive_delay&&this.__keep_alive(!0),this.__last_active=e},e.prototype.restore=function(){var e=this.__obtain_cached_session_id(),t=null,i=(location.search||"").match(this.__regex_parameter_sid),r=(document.referrer||"").match(this.__regex_referer);i&&i[2]&&i[2]!==e&&(t=i[2]||null),r&&r[1]===this.parent.url_go&&r[3]!==e&&(t=r[3]||null);var n=t||e,s=t&&!0;this.__restore_session(n,s)},e.prototype.join=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.parent.socket.emit("session:join",{session_id:this.__session_id,expire:this.__interval_heartbeat_hard,storage:!0,sync:e,useragent:this.parent.device.useragent,timezone:this.parent.device.timezone,locales:this.parent.device.locales})},e.prototype.clear=function(e,t){var i=null;try{this.parent.Config._clear(),this.parent.Message._clear(),this.parent.Browsing._clear(),this.parent.Storage._clear(),this.__clear()}catch(e){i=e}i?"function"==typeof t&&t(i):"function"==typeof e&&e()},e.prototype.__init_storage=function(){this.__session_id=null,this.__connected=!1,this.__last_active=0,this.__last_heartbeat=Date.now(),this.__defer_heartbeat=null,this.__user_data={},this.__state={}},e.prototype.__init_events=function(){var e=this;this.parent.socket.on("session:created",this.__handle_session_created.__crisp_bind(this)),this.parent.socket.on("session:joined",this.__handle_session_joined.__crisp_bind(this)),this.parent.socket.on("session:state",this.__handle_session_state.__crisp_bind(this)),this.parent.socket.on("session:error",this.__handle_session_error.__crisp_bind(this)),this.parent.socket.on("session:request:initiate",this.__handle_session_request_initiate.__crisp_bind(this)),this.parent.socket.on("connect",function(){e.__connected?e.join():e.restore()})},e.prototype.__handle_session_created=function(e){e.error?this.parent.event.publish("session:created",{error:e.error}):(this.__session_id=e.session_id,this.save(),this.join(),this.parent.event.publish("session:created",{session_id:this.__session_id}))},e.prototype.__handle_session_joined=function(e){e.error?this.parent.event.publish("session:joined",{error:e.error}):(this.__connected||(this.__connected=!0,this.send_device()),this.parent.Website.set_users_available(e.users_available),this.storage_session_retrieve(e.storage||{}),this.sync_session_diff(e.sync||{}),this.sync_user_data(e),this.parent.Browsing.restore_browsing_state(),this.parent.event.publish("session:joined",e),this.__start_keep_alive(e.last_active))},e.prototype.__handle_session_state=function(e){this.handle_state(e)},e.prototype.__handle_session_error=function(e){this.parent.event.publish("session:error",e)},e.prototype.__handle_session_request_initiate=function(e){this.parent.event.publish("session:request:initiate",e)},e.prototype.__clear=function(){this.__init_storage(),this.parent.cookie.expire(this.__get_cookie_key(),{domain:this.__get_base_domain()})},e.prototype.__obtain_cached_session_id=function(){return this.parent.cookie.get(this.__get_cookie_key())||null},e.prototype.__restore_session=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?(this.__session_id=e,t===!0&&this.save(),this.join(!0)):this.create()},e.prototype.__storage_session_state_handle=function(e){this.__state=e||{}},e.prototype.__start_keep_alive=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.__last_active=e||Date.now(),this.__keep_alive()},e.prototype.__keep_alive=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.__defer_heartbeat&&clearTimeout(this.__defer_heartbeat),this.__defer_heartbeat=setTimeout(function(){e.__defer_heartbeat=null,e.__last_heartbeat=Date.now(),e.parent.socket.emit("session:heartbeat",{last_active:e.__last_active||0,availability:{type:"online",time:{for:e.__interval_heartbeat_hard}}}),e.__keep_alive()},t===!0?0:this.__interval_heartbeat_soft)},e.prototype.__get_cookie_key=function(){return"crisp-client/session/"+this.parent.website_id+(this.parent.token_id?"/"+this.parent.token_id:"")},e.prototype.__get_base_domain=function(){var e=document.domain,t=e;try{for(var i=0,r=t.split("."),n="crisp-client/domain-detect/"+Date.now();i<r.length-1&&document.cookie.indexOf(n+"="+n)===-1;)t=r.slice(-1-++i).join("."),document.cookie=n+"="+n+";domain="+t+";";document.cookie=n+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+t+";"}catch(e){}finally{return t||e}},e.prototype.__set_user_data_value=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((this.__user_data[e]!==t||i===!0)&&(this.__user_data[e]=t,this.__connected===!0)){var r={};r[e]=t,this.parent.socket.emit("session:set_"+e,r)}},e.prototype.__sync_segments_diff=function(e,t){for(var i=[],r=0;r<(t||[]).length;r++)e.indexOf(t[r])===-1&&i.push(t[r]);this.__user_data.segments=e.concat(i),i.length>0&&this.__connected===!0&&this.parent.socket.emit("session:set_segments",{segments:i})},e.prototype.__sync_data_diff=function(e,t){var i=!1,r={};for(var n in t||{})e[n]!==t[n]&&(i=!0,r[n]=t[n]);this.__user_data.data=e;for(var s in r)this.__user_data.data[s]=r[s];i===!0&&this.__connected===!0&&this.parent.socket.emit("session:set_data",{data:r})},e}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e){this.parent=e,this.__ray_entropy_factor=1e4,this.__init_storage(),this.__init_events()}return e.prototype.update=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},n={ray:this.__gen_ray(e),type:e,data:t};this.__pending_rays_index.push(n.ray),this.__callback_register[n.ray]={success:i,error:r},this.parent.socket.emit("storage:sync:update",n),this.parent.event.publish("storage:sync:update",n)},e.prototype.is_syncing_storage=function(){return this.__pending_rays_index.length>0&&!0},e.prototype._clear=function(){this.__init_storage()},e.prototype.__init_storage=function(){this.__ray_entropy_seed=1,this.__ray_entropy_increment=0,this.__callback_register={},this.__pending_rays_index=[]},e.prototype.__init_events=function(){this.parent.socket.on("storage:sync:updated",this.__handle_storage_sync_updated.__crisp_bind(this))},e.prototype.__handle_storage_sync_updated=function(e){if("object"===s(this.__callback_register[e.ray])){e.error?this.__callback_register[e.ray].error():this.__callback_register[e.ray].success(),delete this.__callback_register[e.ray];var t=this.__pending_rays_index.indexOf(e.ray);t!==-1&&this.__pending_rays_index.splice(t,1)}this.parent.event.publish("storage:sync:updated",e)},e.prototype.__gen_ray=function(e){var t=void 0,i=void 0;return t=Math.sin(this.__ray_entropy_seed++)*this.__ray_entropy_factor,t-=Math.floor(t),i=this.__ray_entropy_increment++,e+"/"+Date.now()+"/"+t+"/"+i},e}(),o=function(){function e(e){this.parent=e,this.__init_storage(),this.__init_events()}return e.prototype.get_users_available=function(){this.__publish_users_available()},e.prototype.set_users_available=function(e){this.__users_available=e},e.prototype.__init_storage=function(){this.__users_available=!1},e.prototype.__init_events=function(){this.parent.socket.on("website:users:available",this.__handle_website_users_available.__crisp_bind(this))},e.prototype.__handle_website_users_available=function(e){"boolean"==typeof e&&(this.set_users_available(e),this.__publish_users_available())},e.prototype.__publish_users_available=function(){this.parent.event.publish("website:users:available",this.__users_available)},e}(),c=function(){function e(e){this.parent=e,this.__init_events()}return e.prototype.get_url_upload=function(e,t){var i={id:Date.now(),from:"visitor",file:{name:e,type:t}};this.parent.socket.emit("bucket:url:upload:generate",i),this.parent.event.publish("bucket:url:upload:generate",i)},e.prototype.__init_events=function(){this.parent.socket.on("bucket:url:upload:generated",this.__handle_bucket_url_upload_generate.__crisp_bind(this))},e.prototype.__handle_bucket_url_upload_generate=function(e){this.parent.event.publish("bucket:url:upload:generated",e)},e}(),_=function(){function e(e){this.parent=e,this.__init_events()}return e.prototype.get_animation_list=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i={id:Date.now(),from:"visitor",list:{page:t}};e&&(i.list.query=e),this.parent.socket.emit("media:animation:list",i),this.parent.event.publish("media:animation:list",i)},e.prototype.__init_events=function(){this.parent.socket.on("media:animation:listed",this.__handle_media_animation_list.__crisp_bind(this))},e.prototype.__handle_media_animation_list=function(e){this.parent.event.publish("media:animation:listed",e)},e}(),l=function(){function e(e){this.parent=e,this.__interval_heartbeat=1e4,this.__timeout_dead_peer=45e3,this.__resize_defer_delay=1e3,this.__throttle_delay=750,this.__is_initiated=!1,this.__browsing_id=null,this.__is_playing=!1,this.__last_heartbeat=null,this.__keep_alive_interval=null,this.__tree_mirror=null,this.__mouse_position={x:0,y:0,last_x:0,last_y:0},this.__scroll_position={x:0,y:0,last_x:0,last_y:0},this.__resize_params={last_call:Date.now(),defer_event:null},this.__initial_stream=null,this.__init_events(),this.__restore_browsing_cache(),this.__bind_mouse(),this.__bind_resize(),this.__bind_scroll(),this.__bind_click()}return e.prototype.init=function(e){this.parent.Config._ignore_privacy!==!0&&"1"===(navigator||{}).doNotTrack?this.parent.socket.emit("browsing:request:decline",{}):(this.__tree_mirror=e.deps.tree_mirror||null,this.__is_initiated=!0,e.resume===!0?(this.parent.socket.emit("browsing:resume",{browsing_id:this.__browsing_id}),this.__keep_alive(!0),this.__is_playing===!0&&this.__start(!0)):(this.__keep_alive(!0),this.parent.socket.emit("browsing:request:accept",{useragent:navigator.userAgent})))},e.prototype.restore_browsing_state=function(){this.__browsing_id&&(this.__is_dead_remote_peer()===!1?this.__handle_request_initiate({resume:!0}):this.__stop())},e.prototype._clear=function(){this.__init_storage(),"undefined"!=typeof window.sessionStorage&&window.sessionStorage.removeItem(this.__get_cookie_key())},e.prototype.__init_storage=function(){this.__browsing_id=null,this.__is_playing=!1,this.__last_heartbeat=null,this.__keep_alive_interval=null,this.__keep_alive_interval=null,this.__mouse_interval=null,this.__scroll_interval=null},e.prototype.__get_cookie_key=function(){return"crisp-client/browsing/"+this.parent.website_id},e.prototype.__init_events=function(){this.parent.socket.on("browsing:request:initiate",this.__handle_request_initiate.__crisp_bind(this)),this.parent.socket.on("browsing:request:initiated",this.__handle_request_initiated.__crisp_bind(this)),this.parent.socket.on("browsing:action:start",this.__handle_action_start.__crisp_bind(this)),this.parent.socket.on("browsing:action:stop",this.__handle_action_stop.__crisp_bind(this)),this.parent.socket.on("browsing:action:heartbeat",this.__handle_action_heartbeat.__crisp_bind(this))},e.prototype.__restore_browsing_cache=function(){if(void 0!==window.sessionStorage){var e=window.sessionStorage.getItem(this.__get_cookie_key());e&&(e=JSON.parse(e),this.__browsing_id=e.browsing_id||null,this.__is_playing=e.is_playing||!1,this.__last_heartbeat=e.last_heartbeat||null)}},e.prototype.__handle_request_initiate=function(e){this.__is_initiated===!0&&e.resume!==!0||(e.resume!==!0&&this.__stop(),this.parent.event.publish("browsing:request:initiate",e||{}))},e.prototype.__handle_request_initiated=function(e){this.__is_initiated===!0&&(this.__browsing_id=e.browsing_id,this.__last_heartbeat=Date.now(),this.__save_cache())},e.prototype.__handle_action_start=function(){this.__is_initiated===!0&&this.__browsing_id&&this.__start()},e.prototype.__handle_action_stop=function(){this.__is_initiated===!0&&this.__browsing_id&&this.__stop()},e.prototype.__handle_action_heartbeat=function(){this.__is_initiated===!0&&this.__browsing_id&&(this.__last_heartbeat=Date.now(),this.__save_cache())},e.prototype.__save_cache=function(){"undefined"!=typeof window.sessionStorage&&JSON&&"function"==typeof JSON.stringify&&window.sessionStorage.setItem(this.__get_cookie_key(),JSON.stringify({browsing_id:this.__browsing_id,is_playing:this.__is_playing,last_heartbeat:this.__last_heartbeat}))},e.prototype.__start=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.__is_playing=!0,this.__last_heartbeat=Date.now(),this.__save_cache(),this.__stream(),this.__mouse_timer(!0),this.__scroll_timer(!0),e!==!0&&this.parent.socket.emit("browsing:action:started",{})},e.prototype.__stop=function(){var e=this.__is_playing;this.__browsing_id=null,this.__is_playing=!1,this.__last_heartbeat=null,this.__save_cache(),this.__keep_alive(!1),this.__mouse_timer(!1),this.__scroll_timer(!1),e===!0&&this.parent.socket.emit("browsing:action:stopped",{})},e.prototype.__stream=function(){var e=this;return this.__stream_mouse(),this.__stream_tab(),this.__stream_scroll(),this.__mirror_client?this.__stream_mirror(this.__initial_stream):void(this.__mirror_client=new this.__tree_mirror(document,{initialize:function(t,i){e.__initial_stream={f:"initialize",args:[t,i]},e.__stream_mirror(e.__initial_stream)},applyChanged:function(t,i,r,n){e.__stream_mirror({f:"applyChanged",args:[t,i,r,n]})}}))},e.prototype.__stream_mirror=function(e){this.parent.socket.emit("browsing:stream:mirror",e)},e.prototype.__stream_tab=function(){this.parent.socket.emit("browsing:stream:tab",{title:document.title,url:document.location.href,width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight})},e.prototype.__stream_mouse=function(){this.parent.socket.emit("browsing:stream:mouse",{x:this.__mouse_position.x,y:this.__mouse_position.y})},e.prototype.__stream_scroll=function(){this.parent.socket.emit("browsing:stream:scroll",{x:this.__scroll_position.x,y:this.__scroll_position.y})},e.prototype.__stream_click=function(){this.parent.socket.emit("browsing:stream:click",{})},e.prototype.__bind_mouse=function(){var e=this,t=void 0;"function"==typeof document.onmousemove&&(t=document.onmousemove),document.onmousemove=function(i){e.__mouse_position.last_x=i.pageX,e.__mouse_position.last_y=i.pageY,"function"==typeof t&&t(i)}},e.prototype.__bind_resize=function(){var e=this,t=void 0;"function"==typeof window.onmousemove&&(t=window.onresize),window.onresize=function(i){null!==e.__resize_params.defer_event&&clearTimeout(e.__resize_params.defer_event),e.__resize_params.defer_event=setTimeout(function(){e.__resize_params.defer_event=null;var t=e.__resize_params.last_call;e.__resize_params.last_call=Date.now(),t&&Date.now()>t+e.__throttle_delay&&e.__is_playing&&e.__stream_tab()},e.__resize_defer_delay),"function"==typeof t&&t(i)}},e.prototype.__bind_scroll=function(){var e=this,t=(!(arguments.length>0&&void 0!==arguments[0])||arguments[0],void 0);"function"==typeof window.onscroll&&(t=window.onscroll),window.onscroll=function(i){var r=document.documentElement;e.__scroll_position.last_x=(window.pageXOffset||r.scrollLeft)-(r.clientLeft||0),e.__scroll_position.last_y=(window.pageYOffset||r.scrollTop)-(r.clientTop||0),"function"==typeof t&&t(i)}},e.prototype.__bind_click=function(){var e=this;window.addEventListener("click",function(){e.__is_playing&&(e.__stream_click(),e.__stream_mouse())})},e.prototype.__is_dead_remote_peer=function(){return null===this.__last_heartbeat||null!==this.__last_heartbeat&&Date.now()-this.__last_heartbeat>=this.__timeout_dead_peer},e.prototype.__keep_alive=function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null!==this.__keep_alive_interval&&clearInterval(this.__keep_alive_interval),t===!0&&(this.__keep_alive_interval=setInterval(function(){e.parent.socket.emit("browsing:heartbeat",{}),e.__is_dead_remote_peer()===!0&&e.__stop()},this.__interval_heartbeat))},e.prototype.__mouse_timer=function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t===!1&&null!==this.__mouse_interval?void clearInterval(this.__mouse_interval):void(this.__mouse_interval=setInterval(function(){e.__mouse_position.last_x===e.__mouse_position.x&&e.__mouse_position.last_y===e.__mouse_position.y||e.__is_playing!==!0||(e.__mouse_position.x=e.__mouse_position.last_x,e.__mouse_position.y=e.__mouse_position.last_y,e.__stream_mouse())},this.__throttle_delay))},e.prototype.__scroll_timer=function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t===!1&&null!==this.__scroll_interval?void clearInterval(this.__scroll_interval):void(this.__scroll_interval=setInterval(function(){e.__scroll_position.last_x===e.__scroll_position.x&&e.__scroll_position.last_y===e.__scroll_position.y||e.__is_playing!==!0||(e.__scroll_position.x=e.__scroll_position.last_x,e.__scroll_position.y=e.__scroll_position.last_y,e.__stream_mouse(),e.__stream_scroll())},this.__throttle_delay))},e}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=function(){function e(e){this.parent=e,this.__interval_heartbeat=1e4,this.__is_initiated=!1,this.__peer_connection=null,this.__keep_alive_interval=null,this.__ice_configuration=[],this.__init_events()}return e.prototype.init=function(e){this.__ice_configuration=e.ice,this.__is_initiated=!0,this.parent.socket.emit("call:request:accept",{})},e.prototype.__init_events=function(){this.parent.socket.on("call:request:initiate",this.__handle_request_initiate.bind(this)),this.parent.socket.on("call:request:initiated",this.__handle_request_initiated.bind(this)),this.parent.socket.on("call:action:stopped",this.__handle_action_stopped.bind(this)),this.parent.socket.on("call:signaling:sdp",this.__handle_signaling_sdp.bind(this)),this.parent.socket.on("call:signaling:candidate",this.__handle_signaling_candidate.bind(this))},e.prototype.__handle_request_initiate=function(e){this.__is_initiated!==!0&&this.parent.event.publish("call:request:initiate",e||{})},e.prototype.__handle_request_initiated=function(e){this.__keep_alive(!0)},e.prototype.__handle_action_stopped=function(){this.parent.event.publish("call:action:stopped",{}),this.__stop()},e.prototype.__handle_signaling_sdp=function(e){var t=this;this.__assert_peer_connection(),"operator"===e.from&&this.__peer_connection.setRemoteDescription(new RTCSessionDescription(e.sdp)).then(function(){return t.parent.event.publish("call:peer:remote:success",{}),t.__create_local_stream()}).catch(function(){t.parent.event.publish("call:peer:remote:error",{})})},e.prototype.__handle_signaling_candidate=function(e){this.__assert_peer_connection(),"operator"===e.from&&"object"===s(e.candidate)&&null!==e.candidate&&this.__peer_connection.addIceCandidate(new RTCIceCandidate({sdpMLineIndex:e.candidate.sdpMLineIndex,candidate:e.candidate.candidate}))},e.prototype.__assert_peer_connection=function(){var e=this;null===this.__peer_connection&&(this.__peer_connection=new RTCPeerConnection({iceServers:this.__ice_configuration}),this.__peer_connection.onicecandidate=function(t){t&&t.candidate&&e.parent.socket.emit("call:signaling:candidate",{from:"user",candidate:t.candidate})},this.__peer_connection.onaddstream=function(t){e.parent.event.publish("call:media:remote:success",t)},this.__peer_connection.oniceconnectionstatechange=function(){var t=e.__peer_connection;"failed"!==t.iceConnectionState&&"disconnected"!==t.iceConnectionState&&"closed"!==t.iceConnectionState||e.__unbind()},this.__peer_connection.onclose=function(){e.__unbind()})},e.prototype.__create_local_stream=function(){var e=this;navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(t){return e.parent.event.publish("call:media:local:success",t),e.__create_local_peer(t)}).catch(function(){e.parent.event.publish("call:media:local:error",{})})},e.prototype.__create_local_peer=function(e){var t=this,i=void 0;this.__peer_connection.addStream(e),this.__peer_connection.createAnswer({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}).then(function(e){return i=e,t.__peer_connection.setLocalDescription(i)}).then(function(){t.parent.socket.emit("call:signaling:sdp",{from:"user",sdp:i}),t.parent.event.publish("call:peer:local:success",{})}).catch(function(){t.parent.event.publish("call:peer:local:error",{})})},e.prototype.__stop=function(){this.__peer_connection&&this.__peer_connection.close(),__unbind()},e.prototype.__unbind=function(){this.__peer_connection=null,this.__is_initiated=!1,this.__keep_alive(!1)},e.prototype.__is_dead_remote_peer=function(){return null===this.__last_heartbeat||null!==this.__last_heartbeat&&Date.now()-this.__last_heartbeat>=this.__timeout_dead_peer},e.prototype.__keep_alive=function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null!==this.__keep_alive_interval&&clearInterval(this.__keep_alive_interval),t===!0&&(this.__keep_alive_interval=setInterval(function(){e.parent.socket.emit("call:heartbeat",{}),e.__is_dead_remote_peer()===!0&&e.__unbind()},this.__interval_heartbeat))},e}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=function(){function e(e){this.parent=e,this.__init_storage()}return e.prototype.configure=function(e){this._state_project=e.project,this._state_revision=e.revision,this._state_environment=e.environment,this._state_useragent=e.useragent,this._state_page=e.page},e.prototype.report=function(e,t,i){if(!(this._state_project&&this._state_revision&&this._state_environment&&this._state_useragent&&this._state_page))throw new Error("Missing a configuration parameter. Did you call configure() before?");"object"===("undefined"==typeof i?"undefined":s(i))&&i instanceof Error&&(i={fileName:i.fileName,lineNumber:i.lineNumber,columnNumber:i.columnNumber,message:i.message,stack:i.stack});var r={project:this._state_project,revision:this._state_revision,environment:this._state_environment,useragent:this._state_useragent,page:this._state_page,level:e,namespace:t,traceback:i};this.parent.socket.emit("issue:report",r),this.parent.event.publish("issue:report",r)},e.prototype.__init_storage=function(){this._state_project=null,this._state_revision=null,this._state_environment=null,this._state_useragent=null,this._state_page=null},e}();(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof __crisp_void_define&&define.amd?define([],t):"object"==typeof exports?exports.io=t():e.io=t()})(t,function(){return function(e){function t(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function r(e,t){"object"===("undefined"==typeof e?"undefined":s(e))&&(t=e,e=void 0),t=t||{};var i,r=a(e),o=r.source,p=r.id,h=r.path,u=l[p]&&h in l[p].nsps,d=t.forceNew||t["force new connection"]||!1===t.multiplex||u;return d?(_("ignoring socket cache for %s",o),i=c(o,t)):(l[p]||(_("new io instance for %s",o),l[p]=c(o,t)),i=l[p]),r.query&&!t.query?t.query=r.query:t&&"object"===s(t.query)&&(t.query=n(t.query)),i.socket(r.path,t)}function n(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t.join("&")}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=i(1),o=i(7),c=i(17),_=i(3)("socket.io-client");e.exports=t=r;var l=t.managers={};t.protocol=o.protocol,t.connect=r,t.Manager=i(17),t.Socket=i(44)},function(e,t,i){(function(t){"use strict";function r(e,i){var r=e;i=i||t.location,null==e&&(e=i.protocol+"//"+i.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?i.protocol+e:i.host+e),/^(https?|wss?):\/\//.test(e)||(s("protocol-less url %s",e),e="undefined"!=typeof i?i.protocol+"//"+e:"https://"+e),s("parse %s",e),r=n(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var a=r.host.indexOf(":")!==-1,o=a?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port,r.href=r.protocol+"://"+o+(i&&i.port===r.port?"":":"+r.port),r}var n=i(2),s=i(3)("socket.io-client:url");e.exports=r}).call(t,function(){return this}())},function(e,t){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,n=e.indexOf("["),s=e.indexOf("]");n!=-1&&s!=-1&&(e=e.substring(0,n)+e.substring(n,s).replace(/:/g,";")+e.substring(s,e.length));
for(var a=i.exec(e||""),o={},c=14;c--;)o[r[c]]=a[c]||"";return n!=-1&&s!=-1&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o}},function(e,t,i){(function(r){function n(){return"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function s(){var e=arguments,i=this.useColors;if(e[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+e[0]+(i?"%c ":" ")+"+"+t.humanize(this.diff),!i)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var n=0,s=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(s=n))}),e.splice(s,0,r),e}function a(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function o(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function c(){try{return t.storage.debug}catch(e){}if("undefined"!=typeof r&&"env"in r)return r.env.DEBUG}function _(){try{return window.localStorage}catch(e){}}t=e.exports=i(5),t.log=a,t.formatArgs=s,t.save=o,t.load=c,t.useColors=n,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:_(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(c())}).call(t,i(4))},function(e,t){function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function n(e){if(l===setTimeout)return setTimeout(e,0);if((l===i||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function s(e){if(p===clearTimeout)return clearTimeout(e);if((p===r||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function a(){f&&u&&(f=!1,u.length?d=u.concat(d):g=-1,d.length&&o())}function o(){if(!f){var e=n(a);f=!0;for(var t=d.length;t;){for(u=d,d=[];++g<t;)u&&u[g].run();g=-1,t=d.length}u=null,f=!1,s(e)}}function c(e,t){this.fun=e,this.array=t}function _(){}var l,p,h=e.exports={};(function(){try{l="function"==typeof setTimeout?setTimeout:i}catch(e){l=i}try{p="function"==typeof clearTimeout?clearTimeout:r}catch(e){p=r}})();var u,d=[],f=!1,g=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new c(e,t)),1!==d.length||f||n(o)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=_,h.addListener=_,h.once=_,h.off=_,h.removeListener=_,h.removeAllListeners=_,h.emit=_,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,i){function r(){return t.colors[l++%t.colors.length]}function n(e){function i(){}function n(){var e=n,i=+new Date,s=i-(_||i);e.diff=s,e.prev=_,e.curr=i,_=i,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=r());for(var a=new Array(arguments.length),o=0;o<a.length;o++)a[o]=arguments[o];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var c=0;a[0]=a[0].replace(/%([a-z%])/g,function(i,r){if("%%"===i)return i;c++;var n=t.formatters[r];if("function"==typeof n){var s=a[c];i=n.call(e,s),a.splice(c,1),c--}return i}),a=t.formatArgs.apply(e,a);var l=n.log||t.log||console.log.bind(console);l.apply(e,a)}i.enabled=!1,n.enabled=!0;var s=t.enabled(e)?n:i;return s.namespace=e,s}function s(e){t.save(e);for(var i=(e||"").split(/[\s,]+/),r=i.length,n=0;n<r;n++)i[n]&&(e=i[n].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function a(){t.enable("")}function o(e){var i,r;for(i=0,r=t.skips.length;i<r;i++)if(t.skips[i].test(e))return!1;for(i=0,r=t.names.length;i<r;i++)if(t.names[i].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=n.debug=n,t.coerce=c,t.disable=a,t.enable=s,t.enabled=o,t.humanize=i(6),t.names=[],t.skips=[],t.formatters={};var _,l=0},function(e,t){function i(e){if(e=String(e),!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return i*l;case"days":case"day":case"d":return i*_;case"hours":case"hour":case"hrs":case"hr":case"h":return i*c;case"minutes":case"minute":case"mins":case"min":case"m":return i*o;case"seconds":case"second":case"secs":case"sec":case"s":return i*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function r(e){return e>=_?Math.round(e/_)+"d":e>=c?Math.round(e/c)+"h":e>=o?Math.round(e/o)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function n(e){return s(e,_,"day")||s(e,c,"hour")||s(e,o,"minute")||s(e,a,"second")||e+" ms"}function s(e,t,i){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+i:Math.ceil(e/t)+" "+i+"s"}var a=1e3,o=60*a,c=60*o,_=24*c,l=365.25*_;e.exports=function(e,t){t=t||{};var s=typeof e;if("string"===s&&e.length>0)return i(e);if("number"===s&&isNaN(e)===!1)return t.long?n(e):r(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,i){function r(){}function n(e){var i="",r=!1;return i+=e.type,t.BINARY_EVENT!=e.type&&t.BINARY_ACK!=e.type||(i+=e.attachments,i+="-"),e.nsp&&"/"!=e.nsp&&(r=!0,i+=e.nsp),null!=e.id&&(r&&(i+=",",r=!1),i+=e.id),null!=e.data&&(r&&(i+=","),i+=h.stringify(e.data)),p("encoded %j as %s",e,i),i}function s(e,t){function i(e){var i=d.deconstructPacket(e),r=n(i.packet),s=i.buffers;s.unshift(r),t(s)}d.removeBlobs(e,i)}function a(){this.reconstructor=null}function o(e){var i={},r=0;if(i.type=Number(e.charAt(0)),null==t.types[i.type])return l();if(t.BINARY_EVENT==i.type||t.BINARY_ACK==i.type){for(var n="";"-"!=e.charAt(++r)&&(n+=e.charAt(r),r!=e.length););if(n!=Number(n)||"-"!=e.charAt(r))throw new Error("Illegal attachments");i.attachments=Number(n)}if("/"==e.charAt(r+1))for(i.nsp="";++r;){var s=e.charAt(r);if(","==s)break;if(i.nsp+=s,r==e.length)break}else i.nsp="/";var a=e.charAt(r+1);if(""!==a&&Number(a)==a){for(i.id="";++r;){var s=e.charAt(r);if(null==s||Number(s)!=s){--r;break}if(i.id+=e.charAt(r),r==e.length)break}i.id=Number(i.id)}return e.charAt(++r)&&(i=c(i,e.substr(r))),p("decoded %s as %j",e,i),i}function c(e,t){try{e.data=h.parse(t)}catch(e){return l()}return e}function _(e){this.reconPack=e,this.buffers=[]}function l(e){return{type:t.ERROR,data:"parser error"}}var p=i(8)("socket.io-parser"),h=i(11),u=i(13),d=i(14),f=i(16);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=a,r.prototype.encode=function(e,i){if(p("encoding packet %j",e),t.BINARY_EVENT==e.type||t.BINARY_ACK==e.type)s(e,i);else{var r=n(e);i([r])}},u(a.prototype),a.prototype.add=function(e){var i;if("string"==typeof e)i=o(e),t.BINARY_EVENT==i.type||t.BINARY_ACK==i.type?(this.reconstructor=new _(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!f(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");i=this.reconstructor.takeBinaryData(e),i&&(this.reconstructor=null,this.emit("decoded",i))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},_.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},_.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,i){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function n(){var e=arguments,i=this.useColors;if(e[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+e[0]+(i?"%c ":" ")+"+"+t.humanize(this.diff),!i)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var n=0,s=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(s=n))}),e.splice(s,0,r),e}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function o(){var e;try{e=t.storage.debug}catch(e){}return e}function c(){try{return window.localStorage}catch(e){}}t=e.exports=i(9),t.log=s,t.formatArgs=n,t.save=a,t.load=o,t.useColors=r,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(o())},function(e,t,i){function r(){return t.colors[l++%t.colors.length]}function n(e){function i(){}function n(){var e=n,i=+new Date,s=i-(_||i);e.diff=s,e.prev=_,e.curr=i,_=i,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=r());var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var o=0;a[0]=a[0].replace(/%([a-z%])/g,function(i,r){if("%%"===i)return i;o++;var n=t.formatters[r];if("function"==typeof n){var s=a[o];i=n.call(e,s),a.splice(o,1),o--}return i}),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a));var c=n.log||t.log||console.log.bind(console);c.apply(e,a)}i.enabled=!1,n.enabled=!0;var s=t.enabled(e)?n:i;return s.namespace=e,s}function s(e){t.save(e);for(var i=(e||"").split(/[\s,]+/),r=i.length,n=0;n<r;n++)i[n]&&(e=i[n].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function a(){t.enable("")}function o(e){var i,r;for(i=0,r=t.skips.length;i<r;i++)if(t.skips[i].test(e))return!1;for(i=0,r=t.names.length;i<r;i++)if(t.names[i].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=n,t.coerce=c,t.disable=a,t.enable=s,t.enabled=o,t.humanize=i(10),t.names=[],t.skips=[],t.formatters={};var _,l=0},function(e,t){function i(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return i*l;case"days":case"day":case"d":return i*_;case"hours":case"hour":case"hrs":case"hr":case"h":return i*c;case"minutes":case"minute":case"mins":case"min":case"m":return i*o;case"seconds":case"second":case"secs":case"sec":case"s":return i*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i}}}}function r(e){return e>=_?Math.round(e/_)+"d":e>=c?Math.round(e/c)+"h":e>=o?Math.round(e/o)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function n(e){return s(e,_,"day")||s(e,c,"hour")||s(e,o,"minute")||s(e,a,"second")||e+" ms"}function s(e,t,i){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+i:Math.ceil(e/t)+" "+i+"s"}var a=1e3,o=60*a,c=60*o,_=24*c,l=365.25*_;e.exports=function(e,t){return t=t||{},"string"==typeof e?i(e):t.long?n(e):r(e)}},function(e,t,i){(function(e,i){var r=!1;(function(){function n(e,t){function i(e){if(i[e]!==g)return i[e];var n;if("bug-string-char-index"==e)n="a"!="a"[0];else if("json"==e)n=i("json-stringify")&&i("json-parse");else{var a,o='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var c=t.stringify,l="function"==typeof c&&v;if(l){(a=function(){return 1}).toJSON=a;try{l="0"===c(0)&&"0"===c(new r)&&'""'==c(new s)&&c(m)===g&&c(g)===g&&c()===g&&"1"===c(a)&&"[1]"==c([a])&&"[null]"==c([g])&&"null"==c(null)&&"[null,null,null]"==c([g,m,null])&&c({a:[a,!0,!1,null,"\0\b\n\f\r\t"]})==o&&"1"===c(null,a)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new _((-864e13)))&&'"+275760-09-13T00:00:00.000Z"'==c(new _(864e13))&&'"-000001-01-01T00:00:00.000Z"'==c(new _((-621987552e5)))&&'"1969-12-31T23:59:59.999Z"'==c(new _((-1)))}catch(e){l=!1}}n=l}if("json-parse"==e){var p=t.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){a=p(o);var h=5==a.a.length&&1===a.a[0];if(h){try{h=!p('"\t"')}catch(e){}if(h)try{h=1!==p("01")}catch(e){}if(h)try{h=1!==p("1.")}catch(e){}}}}catch(e){h=!1}n=h}}return i[e]=!!n}e||(e=c.Object()),t||(t=c.Object());var r=e.Number||c.Number,s=e.String||c.String,o=e.Object||c.Object,_=e.Date||c.Date,l=e.SyntaxError||c.SyntaxError,p=e.TypeError||c.TypeError,h=e.Math||c.Math,u=e.JSON||c.JSON;"object"==typeof u&&u&&(t.stringify=u.stringify,t.parse=u.parse);var d,f,g,y=o.prototype,m=y.toString,v=new _((-0xc782b5b800cec));try{v=v.getUTCFullYear()==-109252&&0===v.getUTCMonth()&&1===v.getUTCDate()&&10==v.getUTCHours()&&37==v.getUTCMinutes()&&6==v.getUTCSeconds()&&708==v.getUTCMilliseconds()}catch(e){}if(!i("json")){var b="[object Function]",w="[object Date]",k="[object Number]",L="[object String]",x="[object Array]",C="[object Boolean]",S=i("bug-string-char-index");if(!v)var j=h.floor,z=[0,31,59,90,120,151,181,212,243,273,304,334],A=function(e,t){return z[t]+365*(e-1970)+j((e-1969+(t=+(t>1)))/4)-j((e-1901+t)/100)+j((e-1601+t)/400)};if((d=y.hasOwnProperty)||(d=function(e){var t,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=m?d=function(e){var t=this.__proto__,i=e in(this.__proto__=null,this);return this.__proto__=t,i}:(t=i.constructor,d=function(e){var i=(this.constructor||t).prototype;return e in this&&!(e in i&&this[e]===i[e])}),i=null,d.call(this,e)}),f=function(e,t){var i,r,n,s=0;(i=function(){this.valueOf=0}).prototype.valueOf=0,r=new i;for(n in r)d.call(r,n)&&s++;return i=r=null,s?f=2==s?function(e,t){var i,r={},n=m.call(e)==b;for(i in e)n&&"prototype"==i||d.call(r,i)||!(r[i]=1)||!d.call(e,i)||t(i)}:function(e,t){var i,r,n=m.call(e)==b;for(i in e)n&&"prototype"==i||!d.call(e,i)||(r="constructor"===i)||t(i);(r||d.call(e,i="constructor"))&&t(i)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(e,t){var i,n,s=m.call(e)==b,o=!s&&"function"!=typeof e.constructor&&a[typeof e.hasOwnProperty]&&e.hasOwnProperty||d;for(i in e)s&&"prototype"==i||!o.call(e,i)||t(i);for(n=r.length;i=r[--n];o.call(e,i)&&t(i));}),f(e,t)},!i("json-stringify")){var E={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},T="000000",B=function(e,t){return(T+(t||0)).slice(-e)},I="\\u00",O=function(e){for(var t='"',i=0,r=e.length,n=!S||r>10,s=n&&(S?e.split(""):e);i<r;i++){var a=e.charCodeAt(i);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=E[a];break;default:if(a<32){t+=I+B(2,a.toString(16));break}t+=n?s[i]:e.charAt(i)}}return t+'"'},P=function(e,t,i,r,n,s,a){var o,c,_,l,h,u,y,v,b,S,z,E,T,I,M,D;try{o=t[e]}catch(e){}if("object"==typeof o&&o)if(c=m.call(o),c!=w||d.call(o,"toJSON"))"function"==typeof o.toJSON&&(c!=k&&c!=L&&c!=x||d.call(o,"toJSON"))&&(o=o.toJSON(e));else if(o>-1/0&&o<1/0){if(A){for(h=j(o/864e5),_=j(h/365.2425)+1970-1;A(_+1,0)<=h;_++);for(l=j((h-A(_,0))/30.42);A(_,l+1)<=h;l++);h=1+h-A(_,l),u=(o%864e5+864e5)%864e5,y=j(u/36e5)%24,v=j(u/6e4)%60,b=j(u/1e3)%60,S=u%1e3}else _=o.getUTCFullYear(),l=o.getUTCMonth(),h=o.getUTCDate(),y=o.getUTCHours(),v=o.getUTCMinutes(),b=o.getUTCSeconds(),S=o.getUTCMilliseconds();o=(_<=0||_>=1e4?(_<0?"-":"+")+B(6,_<0?-_:_):B(4,_))+"-"+B(2,l+1)+"-"+B(2,h)+"T"+B(2,y)+":"+B(2,v)+":"+B(2,b)+"."+B(3,S)+"Z"}else o=null;if(i&&(o=i.call(t,e,o)),null===o)return"null";if(c=m.call(o),c==C)return""+o;if(c==k)return o>-1/0&&o<1/0?""+o:"null";if(c==L)return O(""+o);if("object"==typeof o){for(I=a.length;I--;)if(a[I]===o)throw p();if(a.push(o),z=[],M=s,s+=n,c==x){for(T=0,I=o.length;T<I;T++)E=P(T,o,i,r,n,s,a),z.push(E===g?"null":E);D=z.length?n?"[\n"+s+z.join(",\n"+s)+"\n"+M+"]":"["+z.join(",")+"]":"[]"}else f(r||o,function(e){var t=P(e,o,i,r,n,s,a);t!==g&&z.push(O(e)+":"+(n?" ":"")+t)}),D=z.length?n?"{\n"+s+z.join(",\n"+s)+"\n"+M+"}":"{"+z.join(",")+"}":"{}";return a.pop(),D}};t.stringify=function(e,t,i){var r,n,s,o;if(a[typeof t]&&t)if((o=m.call(t))==b)n=t;else if(o==x){s={};for(var c,_=0,l=t.length;_<l;c=t[_++],o=m.call(c),(o==L||o==k)&&(s[c]=1));}if(i)if((o=m.call(i))==k){if((i-=i%1)>0)for(r="",i>10&&(i=10);r.length<i;r+=" ");}else o==L&&(r=i.length<=10?i:i.slice(0,10));return P("",(c={},c[""]=e,c),n,s,r,"",[])}}if(!i("json-parse")){var M,D,q=s.fromCharCode,N={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},R=function(){throw M=D=null,l()},U=function(){for(var e,t,i,r,n,s=D,a=s.length;M<a;)switch(n=s.charCodeAt(M)){case 9:case 10:case 13:case 32:M++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=S?s.charAt(M):s[M],M++,e;case 34:for(e="@",M++;M<a;)if(n=s.charCodeAt(M),n<32)R();else if(92==n)switch(n=s.charCodeAt(++M)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=N[n],M++;break;case 117:for(t=++M,i=M+4;M<i;M++)n=s.charCodeAt(M),n>=48&&n<=57||n>=97&&n<=102||n>=65&&n<=70||R();e+=q("0x"+s.slice(t,M));break;default:R()}else{if(34==n)break;for(n=s.charCodeAt(M),t=M;n>=32&&92!=n&&34!=n;)n=s.charCodeAt(++M);e+=s.slice(t,M)}if(34==s.charCodeAt(M))return M++,e;R();default:if(t=M,45==n&&(r=!0,n=s.charCodeAt(++M)),n>=48&&n<=57){for(48==n&&(n=s.charCodeAt(M+1),n>=48&&n<=57)&&R(),r=!1;M<a&&(n=s.charCodeAt(M),n>=48&&n<=57);M++);if(46==s.charCodeAt(M)){for(i=++M;i<a&&(n=s.charCodeAt(i),n>=48&&n<=57);i++);i==M&&R(),M=i}if(n=s.charCodeAt(M),101==n||69==n){for(n=s.charCodeAt(++M),43!=n&&45!=n||M++,i=M;i<a&&(n=s.charCodeAt(i),n>=48&&n<=57);i++);i==M&&R(),M=i}return+s.slice(t,M)}if(r&&R(),"true"==s.slice(M,M+4))return M+=4,!0;if("false"==s.slice(M,M+5))return M+=5,!1;if("null"==s.slice(M,M+4))return M+=4,null;R()}return"$"},$=function(e){var t,i;if("$"==e&&R(),"string"==typeof e){if("@"==(S?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=U(),"]"!=e;i||(i=!0))i&&(","==e?(e=U(),"]"==e&&R()):R()),","==e&&R(),t.push($(e));return t}if("{"==e){for(t={};e=U(),"}"!=e;i||(i=!0))i&&(","==e?(e=U(),"}"==e&&R()):R()),","!=e&&"string"==typeof e&&"@"==(S?e.charAt(0):e[0])&&":"==U()||R(),t[e.slice(1)]=$(U());return t}R()}return e},H=function(e,t,i){var r=F(e,t,i);r===g?delete e[t]:e[t]=r},F=function(e,t,i){var r,n=e[t];if("object"==typeof n&&n)if(m.call(n)==x)for(r=n.length;r--;)H(n,r,i);else f(n,function(e){H(n,e,i)});return i.call(e,t,n)};t.parse=function(e,t){var i,r;return M=0,D=""+e,i=$(U()),"$"!=U()&&R(),M=D=null,t&&m.call(t)==b?F((r={},r[""]=i,r),"",t):i}}}return t.runInContext=n,t}var s="function"==typeof __crisp_void_define&&r.amd,a={function:!0,object:!0},o=a[typeof t]&&t&&!t.nodeType&&t,c=a[typeof window]&&window||this,_=o&&a[typeof e]&&e&&!e.nodeType&&"object"==typeof i&&i;if(!_||_.global!==_&&_.window!==_&&_.self!==_||(c=_),o&&!s)n(c,o);else{var l=c.JSON,p=c.JSON3,h=!1,u=n(c,c.JSON3={noConflict:function(){return h||(h=!0,c.JSON=l,c.JSON3=p,l=p=null),u}});c.JSON={parse:u.parse,stringify:u.stringify}}s&&r(function(){return u})}).call(this)}).call(t,i(12)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){function i(e){if(e)return r(e)}function r(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}e.exports=i,i.prototype.on=i.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},i.prototype.once=function(e,t){function i(){r.off(e,i),t.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},i.fn=t,this.on(e,i),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks[e];if(!i)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r,n=0;n<i.length;n++)if(r=i[n],r===t||r.fn===t){i.splice(n,1);break}return this},i.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks[e];if(i){i=i.slice(0);for(var r=0,n=i.length;r<n;++r)i[r].apply(this,t)}return this},i.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},i.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,i){(function(e){var r=i(15),n=i(16);t.deconstructPacket=function(e){function t(e){if(!e)return e;if(n(e)){var s={_placeholder:!0,num:i.length};return i.push(e),s}if(r(e)){for(var a=new Array(e.length),o=0;o<e.length;o++)a[o]=t(e[o]);return a}if("object"==typeof e&&!(e instanceof Date)){var a={};for(var c in e)a[c]=t(e[c]);return a}return e}var i=[],s=e.data,a=e;return a.data=t(s),a.attachments=i.length,{packet:a,buffers:i}},t.reconstructPacket=function(e,t){function i(e){if(e&&e._placeholder){var n=t[e.num];return n}if(r(e)){for(var s=0;s<e.length;s++)e[s]=i(e[s]);return e}if(e&&"object"==typeof e){for(var a in e)e[a]=i(e[a]);return e}return e}return e.data=i(e.data),e.attachments=void 0,e},t.removeBlobs=function(t,i){function s(t,c,_){if(!t)return t;if(e.Blob&&t instanceof Blob||e.File&&t instanceof File){a++;var l=new FileReader;l.onload=function(){_?_[c]=this.result:o=this.result,--a||i(o)},l.readAsArrayBuffer(t)}else if(r(t))for(var p=0;p<t.length;p++)s(t[p],p,t);else if(t&&"object"==typeof t&&!n(t))for(var h in t)s(t[h],h,t)}var a=0,o=t;s(o),a||i(o)}}).call(t,function(){return this}())},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t){(function(t){function i(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}e.exports=i}).call(t,function(){return this}())},function(e,t,i){"use strict";function r(e,t){return this instanceof r?(e&&"object"===("undefined"==typeof e?"undefined":n(e))&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new u({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new c.Encoder,this.decoder=new c.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new r(e,t)}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=i(18),a=i(44),o=i(35),c=i(7),_=i(46),l=i(47),p=i(3)("socket.io-client:manager"),h=i(42),u=i(48),d=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)d.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)d.call(this.nsps,e)&&(this.nsps[e].id=this.engine.id)},o(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e,t){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=s(this.uri,this.opts);var i=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var n=_(i,"open",function(){r.onopen(),e&&e()}),a=_(i,"error",function(t){if(p("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var i=new Error("Connection error");i.data=t,e(i)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var o=this._timeout;p("connect attempt will timeout after %d",o);var c=setTimeout(function(){p("connect attempt timed out after %d",o),n.destroy(),i.close(),i.emit("error","timeout"),r.emitAll("connect_timeout",o)},o);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(n),this.subs.push(a),this},r.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(_(e,"data",l(this,"ondata"))),this.subs.push(_(e,"ping",l(this,"onping"))),this.subs.push(_(e,"pong",l(this,"onpong"))),this.subs.push(_(e,"error",l(this,"onerror"))),this.subs.push(_(e,"close",l(this,"onclose"))),this.subs.push(_(this.decoder,"decoded",l(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){p("error",e),this.emitAll("error",e)},r.prototype.socket=function(e,t){function i(){~h(n.connecting,r)||n.connecting.push(r)}var r=this.nsps[e];if(!r){r=new a(this,e,t),this.nsps[e]=r;var n=this;r.on("connecting",i),r.on("connect",function(){r.id=n.engine.id}),this.autoConnect&&i()}return r},r.prototype.destroy=function(e){var t=h(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){p("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(i){for(var r=0;r<i.length;r++)t.engine.write(i[r],e.options);t.encoding=!1,t.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){p("cleanup");for(var e=this.subs.length,t=0;t<e;t++){var i=this.subs.shift();i.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){p("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){p("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();p("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var i=setTimeout(function(){e.skipReconnect||(p("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(p("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(p("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(i)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,i){e.exports=i(19)},function(e,t,i){e.exports=i(20),e.exports.parser=i(27)},function(e,t,i){(function(t){function r(e,i){if(!(this instanceof r))return new r(e,i);i=i||{},e&&"object"==typeof e&&(i=e,e=null),e?(e=l(e),i.hostname=e.host,i.secure="https"===e.protocol||"wss"===e.protocol,i.port=e.port,e.query&&(i.query=e.query)):i.host&&(i.hostname=l(i.host).host),this.secure=null!=i.secure?i.secure:t.location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.agent=i.agent||!1,this.hostname=i.hostname||(t.location?location.hostname:"localhost"),this.port=i.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=i.query||{},"string"==typeof this.query&&(this.query=h.decode(this.query)),this.upgrade=!1!==i.upgrade,this.path=(i.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!i.forceJSONP,this.jsonp=!1!==i.jsonp,this.forceBase64=!!i.forceBase64,this.enablesXDR=!!i.enablesXDR,this.timestampParam=i.timestampParam||"t",this.timestampRequests=i.timestampRequests,this.transports=i.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=i.policyPort||843,this.rememberUpgrade=i.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=i.onlyBinaryUpgrades,this.perMessageDeflate=!1!==i.perMessageDeflate&&(i.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=i.pfx||null,this.key=i.key||null,this.passphrase=i.passphrase||null,this.cert=i.cert||null,this.ca=i.ca||null,this.ciphers=i.ciphers||null,this.rejectUnauthorized=void 0===i.rejectUnauthorized?null:i.rejectUnauthorized,this.forceNode=!!i.forceNode;var n="object"==typeof t&&t;n.global===n&&(i.extraHeaders&&Object.keys(i.extraHeaders).length>0&&(this.extraHeaders=i.extraHeaders),i.localAddress&&(this.localAddress=i.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function n(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}var s=i(21),a=i(35),o=i(3)("engine.io-client:socket"),c=i(42),_=i(27),l=i(2),p=i(43),h=i(36);e.exports=r,r.priorWebsocketSuccess=!1,a(r.prototype),r.protocol=_.protocol,r.Socket=r,r.Transport=i(26),r.transports=i(21),r.parser=i(27),r.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=n(this.query);t.EIO=_.protocol,t.transport=e,this.id&&(t.sid=this.id);var i=new s[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,
pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return i},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(h.onlyBinaryUpgrades){var t=!this.supportsBinary&&h.transport.supportsBinary;p=p||t}p||(o('probe transport "%s" opened',e),l.send([{type:"ping",data:"probe"}]),l.once("packet",function(t){if(!p)if("pong"===t.type&&"probe"===t.data){if(o('probe transport "%s" pong',e),h.upgrading=!0,h.emit("upgrading",l),!l)return;r.priorWebsocketSuccess="websocket"===l.name,o('pausing current transport "%s"',h.transport.name),h.transport.pause(function(){p||"closed"!==h.readyState&&(o("changing transport and sending upgrade packet"),_(),h.setTransport(l),l.send([{type:"upgrade"}]),h.emit("upgrade",l),l=null,h.upgrading=!1,h.flush())})}else{o('probe transport "%s" failed',e);var i=new Error("probe error");i.transport=l.name,h.emit("upgradeError",i)}}))}function i(){p||(p=!0,_(),l.close(),l=null)}function n(t){var r=new Error("probe error: "+t);r.transport=l.name,i(),o('probe transport "%s" failed because of error: %s',e,t),h.emit("upgradeError",r)}function s(){n("transport closed")}function a(){n("socket closed")}function c(e){l&&e.name!==l.name&&(o('"%s" works - aborting "%s"',e.name,l.name),i())}function _(){l.removeListener("open",t),l.removeListener("error",n),l.removeListener("close",s),h.removeListener("close",a),h.removeListener("upgrading",c)}o('probing transport "%s"',e);var l=this.createTransport(e,{probe:1}),p=!1,h=this;r.priorWebsocketSuccess=!1,l.once("open",t),l.once("error",n),l.once("close",s),this.once("close",a),this.once("upgrading",c),l.open()},r.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(p(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,i){return this.sendPacket("message",e,t,i),this},r.prototype.sendPacket=function(e,t,i,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof i&&(r=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){i=i||{},i.compress=!1!==i.compress;var n={type:e,data:t,options:i};this.emit("packetCreate",n),this.writeBuffer.push(n),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),o("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function i(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():e()}):this.upgrading?i():e()}return this},r.prototype.onError=function(e){o("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',e);var i=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),i.writeBuffer=[],i.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],i=0,r=e.length;i<r;i++)~c(this.transports,e[i])&&t.push(e[i]);return t}}).call(t,function(){return this}())},function(e,t,i){(function(e){function r(t){var i,r=!1,o=!1,c=!1!==t.jsonp;if(e.location){var _="https:"===location.protocol,l=location.port;l||(l=_?443:80),r=t.hostname!==location.hostname||l!==t.port,o=t.secure!==_}if(t.xdomain=r,t.xscheme=o,i=new n(t),"open"in i&&!t.forceJSONP)return new s(t);if(!c)throw new Error("JSONP disabled");return new a(t)}var n=i(22),s=i(24),a=i(39),o=i(40);t.polling=r,t.websocket=o}).call(t,function(){return this}())},function(e,t,i){(function(t){var r=i(23);e.exports=function(e){var i=e.xdomain,n=e.xscheme,s=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!i||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&s)return new XDomainRequest}catch(e){}if(!i)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,function(){return this}())},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,i){(function(t){function r(){}function n(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,t.location){var i="https:"===location.protocol,r=location.port;r||(r=i?443:80),this.xd=e.hostname!==t.location.hostname||r!==e.port,this.xs=e.secure!==i}else this.extraHeaders=e.extraHeaders}function s(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function a(){for(var e in s.requests)s.requests.hasOwnProperty(e)&&s.requests[e].abort()}var o=i(22),c=i(25),_=i(35),l=i(37),p=i(3)("engine.io-client:polling-xhr");e.exports=n,e.exports.Request=s,l(n,c),n.prototype.supportsBinary=!0,n.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new s(e)},n.prototype.doWrite=function(e,t){var i="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:i}),n=this;r.on("success",t),r.on("error",function(e){n.onError("xhr post error",e)}),this.sendXhr=r},n.prototype.doPoll=function(){p("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},_(s.prototype),s.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var i=this.xhr=new o(e),r=this;try{p("xhr open %s: %s",this.method,this.uri),i.open(this.method,this.uri,this.async);try{if(this.extraHeaders){i.setDisableHeaderCheck(!0);for(var n in this.extraHeaders)this.extraHeaders.hasOwnProperty(n)&&i.setRequestHeader(n,this.extraHeaders[n])}}catch(e){}if(this.supportsBinary&&(i.responseType="arraybuffer"),"POST"===this.method)try{this.isBinary?i.setRequestHeader("Content-type","application/octet-stream"):i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{i.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in i&&(i.withCredentials=!0),this.requestTimeout&&(i.timeout=this.requestTimeout),this.hasXDR()?(i.onload=function(){r.onLoad()},i.onerror=function(){r.onError(i.responseText)}):i.onreadystatechange=function(){4===i.readyState&&(200===i.status||1223===i.status?r.onLoad():setTimeout(function(){r.onError(i.status)},0))},p("xhr data %s",this.data),i.send(this.data)}catch(e){return void setTimeout(function(){r.onError(e)},0)}t.document&&(this.index=s.requestsCount++,s.requests[this.index]=this)},s.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},s.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},s.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},s.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}t.document&&delete s.requests[this.index],this.xhr=null}},s.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if("application/octet-stream"===t)e=this.xhr.response||this.xhr.responseText;else if(this.supportsBinary)try{e=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(t){for(var i=new Uint8Array(this.xhr.response),r=[],n=0,s=i.length;n<s;n++)r.push(i[n]);e=String.fromCharCode.apply(null,r)}else e=this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},s.prototype.hasXDR=function(){return"undefined"!=typeof t.XDomainRequest&&!this.xs&&this.enablesXDR},s.prototype.abort=function(){this.cleanup()},s.requestsCount=0,s.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",a):t.addEventListener&&t.addEventListener("beforeunload",a,!1))}).call(t,function(){return this}())},function(e,t,i){function r(e){var t=e&&e.forceBase64;l&&!t||(this.supportsBinary=!1),n.call(this,e)}var n=i(26),s=i(36),a=i(27),o=i(37),c=i(38),_=i(3)("engine.io-client:polling");e.exports=r;var l=function(){var e=i(22),t=new e({xdomain:!1});return null!=t.responseType}();o(r,n),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){_("paused"),i.readyState="paused",e()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(_("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){_("pre-pause polling complete"),--r||t()})),this.writable||(_("we are currently writing - waiting to pause"),r++,this.once("drain",function(){_("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){_("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;_("polling got data %s",e);var i=function(e,i,r){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)};a.decodePayload(e,this.socket.binaryType,i),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():_('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){_("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(_("transport open - closing"),e()):(_("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var i=function(){t.writable=!0,t.emit("drain")};a.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,i)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",i="";!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=s.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(i=":"+this.port),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+i+this.path+e}},function(e,t,i){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var n=i(27),s=i(35);e.exports=r,s(r.prototype),r.prototype.onError=function(e,t){var i=new Error(e);return i.type="TransportError",i.description=t,this.emit("error",i),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=n.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,i){(function(e){function r(e,i){var r="b"+t.packets[e.type]+e.data.data;return i(r)}function n(e,i,r){if(!i)return t.encodeBase64Packet(e,r);var n=e.data,s=new Uint8Array(n),a=new Uint8Array(1+n.byteLength);a[0]=m[e.type];for(var o=0;o<s.length;o++)a[o+1]=s[o];return r(a.buffer)}function s(e,i,r){if(!i)return t.encodeBase64Packet(e,r);var n=new FileReader;return n.onload=function(){e.data=n.result,t.encodePacket(e,i,!0,r)},n.readAsArrayBuffer(e.data)}function a(e,i,r){if(!i)return t.encodeBase64Packet(e,r);if(y)return s(e,i,r);var n=new Uint8Array(1);n[0]=m[e.type];var a=new w([n.buffer,e.data]);return r(a)}function o(e){try{e=d.decode(e)}catch(e){return!1}return e}function c(e,t,i){for(var r=new Array(e.length),n=u(e.length,i),s=function(e,i,n){t(i,function(t,i){r[e]=i,n(t,r)})},a=0;a<e.length;a++)s(a,e[a],n)}var _,l=i(28),p=i(29),h=i(30),u=i(31),d=i(32);e&&e.ArrayBuffer&&(_=i(33));var f="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),g="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),y=f||g;t.protocol=3;var m=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},v=l(m),b={type:"error",data:"parser error"},w=i(34);t.encodePacket=function(t,i,s,o){"function"==typeof i&&(o=i,i=!1),"function"==typeof s&&(o=s,s=null);var c=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&c instanceof ArrayBuffer)return n(t,i,o);if(w&&c instanceof e.Blob)return a(t,i,o);if(c&&c.base64)return r(t,o);var _=m[t.type];return void 0!==t.data&&(_+=s?d.encode(String(t.data)):String(t.data)),o(""+_)},t.encodeBase64Packet=function(i,r){var n="b"+t.packets[i.type];if(w&&i.data instanceof e.Blob){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];r(n+e)},s.readAsDataURL(i.data)}var a;try{a=String.fromCharCode.apply(null,new Uint8Array(i.data))}catch(e){for(var o=new Uint8Array(i.data),c=new Array(o.length),_=0;_<o.length;_++)c[_]=o[_];a=String.fromCharCode.apply(null,c)}return n+=e.btoa(a),r(n)},t.decodePacket=function(e,i,r){if(void 0===e)return b;if("string"==typeof e){if("b"==e.charAt(0))return t.decodeBase64Packet(e.substr(1),i);if(r&&(e=o(e),e===!1))return b;var n=e.charAt(0);return Number(n)==n&&v[n]?e.length>1?{type:v[n],data:e.substring(1)}:{type:v[n]}:b}var s=new Uint8Array(e),n=s[0],a=h(e,1);return w&&"blob"===i&&(a=new w([a])),{type:v[n],data:a}},t.decodeBase64Packet=function(e,t){var i=v[e.charAt(0)];if(!_)return{type:i,data:{base64:!0,data:e.substr(1)}};var r=_.decode(e.substr(1));return"blob"===t&&w&&(r=new w([r])),{type:i,data:r}},t.encodePayload=function(e,i,r){function n(e){return e.length+":"+e}function s(e,r){t.encodePacket(e,!!a&&i,!0,function(e){r(null,n(e))})}"function"==typeof i&&(r=i,i=null);var a=p(e);return i&&a?w&&!y?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void c(e,s,function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,i,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,i,r);"function"==typeof i&&(r=i,i=null);var n;if(""==e)return r(b,0,1);for(var s,a,o="",c=0,_=e.length;c<_;c++){var l=e.charAt(c);if(":"!=l)o+=l;else{if(""==o||o!=(s=Number(o)))return r(b,0,1);if(a=e.substr(c+1,s),o!=a.length)return r(b,0,1);if(a.length){if(n=t.decodePacket(a,i,!0),b.type==n.type&&b.data==n.data)return r(b,0,1);var p=r(n,c+s,_);if(!1===p)return}c+=s,o=""}}return""!=o?r(b,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,i){function r(e,i){t.encodePacket(e,!0,!0,function(e){return i(null,e)})}return e.length?void c(e,r,function(e,t){var r=t.reduce(function(e,t){var i;return i="string"==typeof t?t.length:t.byteLength,e+i.toString().length+i+2},0),n=new Uint8Array(r),s=0;return t.forEach(function(e){var t="string"==typeof e,i=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);i=r.buffer}t?n[s++]=0:n[s++]=1;for(var o=i.byteLength.toString(),a=0;a<o.length;a++)n[s++]=parseInt(o[a]);n[s++]=255;for(var r=new Uint8Array(i),a=0;a<r.length;a++)n[s++]=r[a]}),i(n.buffer)}):i(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,i){function r(e,i){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);e=r.buffer,t[0]=0}for(var s=e instanceof ArrayBuffer?e.byteLength:e.size,a=s.toString(),o=new Uint8Array(a.length+1),n=0;n<a.length;n++)o[n]=parseInt(a[n]);if(o[a.length]=255,w){var c=new w([t.buffer,o.buffer,e]);i(null,c)}})}c(e,r,function(e,t){return i(new w(t))})},t.decodePayloadAsBinary=function(e,i,r){"function"==typeof i&&(r=i,i=null);for(var n=e,s=[],a=!1;n.byteLength>0;){for(var o=new Uint8Array(n),c=0===o[0],_="",l=1;255!=o[l];l++){if(_.length>310){a=!0;break}_+=o[l]}if(a)return r(b,0,1);n=h(n,2+_.length),_=parseInt(_);var p=h(n,0,_);if(c)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(e){var u=new Uint8Array(p);p="";for(var l=0;l<u.length;l++)p+=String.fromCharCode(u[l])}s.push(p),n=h(n,_)}var d=s.length;s.forEach(function(e,n){r(t.decodePacket(e,i,!0),n,d)})}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t=[],i=Object.prototype.hasOwnProperty;for(var r in e)i.call(e,r)&&t.push(r);return t}},function(e,t,i){(function(t){function r(e){function i(e){if(!e)return!1;if(t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer||t.Blob&&e instanceof Blob||t.File&&e instanceof File)return!0;if(n(e)){for(var r=0;r<e.length;r++)if(i(e[r]))return!0}else if(e&&"object"==typeof e){e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON());for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&i(e[s]))return!0}return!1}return i(e)}var n=i(15);e.exports=r}).call(t,function(){return this}())},function(e,t){e.exports=function(e,t,i){var r=e.byteLength;if(t=t||0,i=i||r,e.slice)return e.slice(t,i);if(t<0&&(t+=r),i<0&&(i+=r),i>r&&(i=r),t>=r||t>=i||0===r)return new ArrayBuffer(0);for(var n=new Uint8Array(e),s=new Uint8Array(i-t),a=t,o=0;a<i;a++,o++)s[o]=n[a];return s.buffer}},function(e,t){function i(e,t,i){function n(e,r){if(n.count<=0)throw new Error("after called too many times");--n.count,e?(s=!0,t(e),t=i):0!==n.count||s||t(null,r)}var s=!1;return i=i||r,n.count=e,0===e?t():n}function r(){}e.exports=i},function(e,t,i){var r;(function(e,n){(function(s){function a(e){for(var t,i,r=[],n=0,s=e.length;n<s;)t=e.charCodeAt(n++),t>=55296&&t<=56319&&n<s?(i=e.charCodeAt(n++),56320==(64512&i)?r.push(((1023&t)<<10)+(1023&i)+65536):(r.push(t),n--)):r.push(t);return r}function o(e){for(var t,i=e.length,r=-1,n="";++r<i;)t=e[r],t>65535&&(t-=65536,n+=v(t>>>10&1023|55296),t=56320|1023&t),n+=v(t);return n}function c(e,t){return v(e>>t&63|128)}function _(e){if(0==(4294967168&e))return v(e);var t="";return 0==(4294965248&e)?t=v(e>>6&31|192):0==(4294901760&e)?(t=v(e>>12&15|224),t+=c(e,6)):0==(4292870144&e)&&(t=v(e>>18&7|240),t+=c(e,12),t+=c(e,6)),t+=v(63&e|128)}function l(e){for(var t,i=a(e),r=i.length,n=-1,s="";++n<r;)t=i[n],s+=_(t);return s}function p(){if(m>=y)throw Error("Invalid byte index");var e=255&g[m];if(m++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function h(){var e,t,i,r,n;if(m>y)throw Error("Invalid byte index");if(m==y)return!1;if(e=255&g[m],m++,0==(128&e))return e;if(192==(224&e)){var t=p();if(n=(31&e)<<6|t,n>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=p(),i=p(),n=(15&e)<<12|t<<6|i,n>=2048)return n;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=p(),i=p(),r=p(),n=(15&e)<<18|t<<12|i<<6|r,n>=65536&&n<=1114111))return n;throw Error("Invalid WTF-8 detected")}function u(e){g=a(e),y=g.length,m=0;for(var t,i=[];(t=h())!==!1;)i.push(t);return o(i)}var d="object"==typeof t&&t,f=("object"==typeof e&&e&&e.exports==d&&e,"object"==typeof n&&n);f.global!==f&&f.window!==f||(s=f);var g,y,m,v=String.fromCharCode,b={version:"1.0.0",encode:l,decode:u};r=function(){return b}.call(t,i,t,e),!(void 0!==r&&(e.exports=r))})(this)}).call(t,i(12)(e),function(){return this}())},function(e,t){(function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),r=0;r<e.length;r++)i[e.charCodeAt(r)]=r;t.encode=function(t){var i,r=new Uint8Array(t),n=r.length,s="";for(i=0;i<n;i+=3)s+=e[r[i]>>2],s+=e[(3&r[i])<<4|r[i+1]>>4],s+=e[(15&r[i+1])<<2|r[i+2]>>6],s+=e[63&r[i+2]];return n%3===2?s=s.substring(0,s.length-1)+"=":n%3===1&&(s=s.substring(0,s.length-2)+"=="),s},t.decode=function(e){var t,r,n,s,a,o=.75*e.length,c=e.length,_=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var l=new ArrayBuffer(o),p=new Uint8Array(l);for(t=0;t<c;t+=4)r=i[e.charCodeAt(t)],n=i[e.charCodeAt(t+1)],s=i[e.charCodeAt(t+2)],a=i[e.charCodeAt(t+3)],p[_++]=r<<2|n>>4,p[_++]=(15&n)<<4|s>>2,p[_++]=(3&s)<<6|63&a;return l}})()},function(e,t){(function(t){function i(e){for(var t=0;t<e.length;t++){var i=e[t];if(i.buffer instanceof ArrayBuffer){var r=i.buffer;if(i.byteLength!==r.byteLength){var n=new Uint8Array(i.byteLength);n.set(new Uint8Array(r,i.byteOffset,i.byteLength)),r=n.buffer}e[t]=r}}}function r(e,t){t=t||{};var r=new s;i(e);for(var n=0;n<e.length;n++)r.append(e[n]);return t.type?r.getBlob(t.type):r.getBlob()}function n(e,t){return i(e),new Blob(e,t||{})}var s=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,a=function(){try{var e=new Blob(["hi"]);return 2===e.size}catch(e){return!1}}(),o=a&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return 2===e.size}catch(e){return!1}}(),c=s&&s.prototype.append&&s.prototype.getBlob;e.exports=function(){return a?o?t.Blob:n:c?r:void 0}()}).call(t,function(){return this}())},function(e,t,i){function r(e){if(e)return n(e)}function n(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,this.on(e,i),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,n=0;n<i.length;n++)if(r=i[n],r===t||r.fn===t){i.splice(n,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks["$"+e];if(i){i=i.slice(0);for(var r=0,n=i.length;r<n;++r)i[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){t.encode=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&(t.length&&(t+="&"),t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t},t.decode=function(e){for(var t={},i=e.split("&"),r=0,n=i.length;r<n;r++){var s=i[r].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},function(e,t){e.exports=function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},function(e,t){"use strict";function i(e){var t="";do t=a[e%o]+t,e=Math.floor(e/o);while(e>0);return t}function r(e){var t=0;for(l=0;l<e.length;l++)t=t*o+c[e.charAt(l)];return t}function n(){var e=i(+new Date);return e!==s?(_=0,s=e):e+"."+i(_++)}for(var s,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,c={},_=0,l=0;l<o;l++)c[a[l]]=l;n.encode=i,n.decode=r,e.exports=n},function(e,t,i){(function(t){function r(){}function n(e){s.call(this,e),this.query=this.query||{},o||(t.___eio||(t.___eio=[]),o=t.___eio),this.index=o.length;var i=this;o.push(function(e){i.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){i.script&&(i.script.onerror=r)},!1)}var s=i(25),a=i(37);e.exports=n;var o,c=/\n/g,_=/\\n/g;a(n,s),n.prototype.supportsBinary=!1,n.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),s.prototype.doClose.call(this)},n.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(t,i):(document.head||document.body).appendChild(t),this.script=t;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},n.prototype.doWrite=function(e,t){function i(){r(),t()}function r(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';s=document.createElement(e)}catch(e){s=document.createElement("iframe"),s.name=n.iframeId,s.src="javascript:0"}s.id=n.iframeId,n.form.appendChild(s),n.iframe=s}var n=this;if(!this.form){var s,a=document.createElement("form"),o=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=l,a.method="POST",a.setAttribute("accept-charset","utf-8"),o.name="d",a.appendChild(o),document.body.appendChild(a),this.form=a,this.area=o}this.form.action=this.uri(),r(),e=e.replace(_,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&i()}:this.iframe.onload=i}}).call(t,function(){return this}())},function(e,t,i){(function(t){function r(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=p&&!e.forceNode,this.usingBrowserWebSocket||(h=n),s.call(this,e)}var n,s=i(26),a=i(27),o=i(36),c=i(37),_=i(38),l=i(3)("engine.io-client:websocket"),p=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{n=i(41)}catch(e){}var h=p;h||"undefined"!=typeof window||(h=n),e.exports=r,c(r,s),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?new h(e):new h(e,t,i)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},r.prototype.write=function(e){function i(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var n=e.length,s=0,o=n;s<o;s++)(function(e){a.encodePacket(e,r.supportsBinary,function(s){if(!r.usingBrowserWebSocket){var a={};if(e.options&&(a.compress=e.options.compress),r.perMessageDeflate){var o="string"==typeof s?t.Buffer.byteLength(s):s.length;o<r.perMessageDeflate.threshold&&(a.compress=!1)}}try{r.usingBrowserWebSocket?r.ws.send(s):r.ws.send(s,a)}catch(e){l("websocket closed before onclose event")}--n||i()})})(e[s])},r.prototype.onClose=function(){s.prototype.onClose.call(this)},r.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",i="";this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=_()),this.supportsBinary||(e.b64=1),e=o.encode(e),
e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+i+this.path+e},r.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===r.prototype.name)}}).call(t,function(){return this}())},function(e,t){},function(e,t){var i=[].indexOf;e.exports=function(e,t){if(i)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t){(function(t){var i=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,n=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,s=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,o=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(a,"").replace(o,""),t.JSON&&JSON.parse?JSON.parse(e):i.test(e.replace(r,"@").replace(n,"]").replace(s,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},function(e,t,i){"use strict";function r(e,t,i){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}var n=i(7),s=i(35),a=i(45),o=i(46),c=i(47),_=i(3)("socket.io-client:socket"),l=i(29);e.exports=t=r;var p={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=s.prototype.emit;s(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[o(e,"open",c(this,"onopen")),o(e,"packet",c(this,"onpacket")),o(e,"close",c(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(p.hasOwnProperty(e))return h.apply(this,arguments),this;var t=a(arguments),i=n.EVENT;l(t)&&(i=n.BINARY_EVENT);var r={type:i,data:t};return r.options={},r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(_("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),delete this.flags,this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){_("transport is open - connecting"),"/"!==this.nsp&&(this.query?this.packet({type:n.CONNECT,query:this.query}):this.packet({type:n.CONNECT}))},r.prototype.onclose=function(e){_("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case n.CONNECT:this.onconnect();break;case n.EVENT:this.onevent(e);break;case n.BINARY_EVENT:this.onevent(e);break;case n.ACK:this.onack(e);break;case n.BINARY_ACK:this.onack(e);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];_("emitting event %j",t),null!=e.id&&(_("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,i=!1;return function(){if(!i){i=!0;var r=a(arguments);_("sending ack %j",r);var s=l(r)?n.BINARY_ACK:n.ACK;t.packet({type:s,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(_("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):_("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){_("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(_("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){function i(e,t){var i=[];t=t||0;for(var r=t||0;r<e.length;r++)i[r-t]=e[r];return i}e.exports=i},function(e,t){function i(e,t,i){return e.on(t,i),{destroy:function(){e.removeListener(t,i)}}}e.exports=i},function(e,t){var i=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=i.call(arguments,2);return function(){return t.apply(e,r.concat(i.call(arguments)))}}},function(e,t){function i(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=i,i.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),i=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-i:e+i}return 0|Math.min(e,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(e){this.ms=e},i.prototype.setMax=function(e){this.max=e},i.prototype.setJitter=function(e){this.jitter=e}}])}),function(e,t){"use strict";if("function"==typeof __crisp_void_define&&define.amd)define(["exports"],t);else if("object"==typeof exports)t(exports);else{var i={};e.PubSub=i,t(i)}}("object"==typeof t&&t||this,function(e){"use strict";function t(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function i(e){return function(){throw e}}function r(e,t,r){try{e(t,r)}catch(e){setTimeout(i(e),0)}}function n(e,t,i){e(t,i)}function s(e,t,i,s){var a,o=_[t],c=s?n:r;if(_.hasOwnProperty(t))for(a in o)o.hasOwnProperty(a)&&c(o[a],e,i)}function a(e,t,i){return function(){var r=String(e),n=r.lastIndexOf(".");for(s(e,e,t,i);n!==-1;)r=r.substr(0,n),n=r.lastIndexOf("."),s(e,r,t,i)}}function o(e){for(var i=String(e),r=Boolean(_.hasOwnProperty(i)&&t(_[i])),n=i.lastIndexOf(".");!r&&n!==-1;)i=i.substr(0,n),n=i.lastIndexOf("."),r=Boolean(_.hasOwnProperty(i)&&t(_[i]));return r}function c(e,t,i,r){var n=a(e,t,r),s=o(e);return!!s&&(i===!0?n():setTimeout(n,0),!0)}var _={},l=-1;e.publish=function(t,i){return c(t,i,!1,e.immediateExceptions)},e.publishSync=function(t,i){return c(t,i,!0,e.immediateExceptions)},e.subscribe=function(e,t){if("function"!=typeof t)return!1;_.hasOwnProperty(e)||(_[e]={});var i="uid_"+String(++l);return _[e][i]=t,i},e.clearAllSubscriptions=function(){_={}},e.clearSubscriptions=function(e){var t;for(t in _)_.hasOwnProperty(t)&&0===t.indexOf(e)&&delete _[t]},e.unsubscribe=function(e){var t,i,r,n="string"==typeof e&&_.hasOwnProperty(e),s=!n&&"string"==typeof e,a="function"==typeof e,o=!1;if(n)return void delete _[e];for(t in _)if(_.hasOwnProperty(t)){if(i=_[t],s&&i[e]){delete i[e],o=e;break}if(a)for(r in i)i.hasOwnProperty(r)&&i[r]===e&&(delete i[r],o=!0)}return o}}),function(e,t){"use strict";var i=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var i=function(e,t,r){return 1===arguments.length?i.get(e):i.set(e,t,r)};return i._document=e.document,i._cacheKeyPrefix="cookey.",i._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),i.defaults={path:"/",secure:!1},i.get=function(e){i._cachedDocumentCookie!==i._document.cookie&&i._renewCache();var r=i._cache[i._cacheKeyPrefix+e];return r===t?t:decodeURIComponent(r)},i.set=function(e,r,n){return n=i._getExtendedOptions(n),n.expires=i._getExpiresDate(r===t?-1:n.expires),i._document.cookie=i._generateCookieString(e,r,n),i},i.expire=function(e,r){return i.set(e,t,r)},i._getExtendedOptions=function(e){return{path:e&&e.path||i.defaults.path,domain:e&&e.domain||i.defaults.domain,expires:e&&e.expires||i.defaults.expires,secure:e&&e.secure!==t?e.secure:i.defaults.secure}},i._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},i._getExpiresDate=function(e,t){if(t=t||new Date,"number"==typeof e?e=e===1/0?i._maxExpireDate:new Date(t.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!i._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},i._generateCookieString=function(e,t,i){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),i=i||{};var r=e+"="+t;return r+=i.path?";path="+i.path:"",r+=i.domain?";domain="+i.domain:"",r+=i.expires?";expires="+i.expires.toUTCString():"",r+=i.secure?";secure":""},i._getCacheFromString=function(e){for(var r={},n=e?e.split("; "):[],s=0;s<n.length;s++){var a=i._getKeyValuePairFromCookieString(n[s]);r[i._cacheKeyPrefix+a.key]===t&&(r[i._cacheKeyPrefix+a.key]=a.value)}return r},i._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=t<0?e.length:t;var i,r=e.substr(0,t);try{i=decodeURIComponent(r)}catch(e){console&&"function"==typeof console.error&&console.error('Could not decode cookie with key "'+r+'"',e)}return{key:i,value:e.substr(t+1)}},i._renewCache=function(){i._cache=i._getCacheFromString(i._document.cookie),i._cachedDocumentCookie=i._document.cookie},i._areEnabled=function(){var e="cookies.js",t="1"===i.set(e,1).get(e);return i.expire(e),t},i.enabled=i._areEnabled(),i},r="object"==typeof e.document?i(e):i;"function"==typeof __crisp_void_define&&define.amd?define(function(){return r}):"object"==typeof exports?("object"==typeof module&&"object"==typeof module.exports&&(exports=module.exports=r),exports.Cookies=r):e.Cookies=r}(t),this.__configure(e),this.__transports(e,t),this.Config=new i(this),this.Browsing=new l(this),this.Call=new p(this),this.Message=new r(this),this.Session=new n(this),this.Storage=new a(this),this.Website=new o(this),this.Bucket=new c(this),this.Media=new _(this),this.Issue=new h(this)},e.prototype.__configure=function(e){e&&e.environment&&(this.environment=e.environment||"development"),e&&e.disable_autoload&&(this.disable_autoload=e.disable_autoload),e&&e.url_go&&(this.url_go=e.url_go),e&&e.website_domain&&(this.website_domain=e.website_domain),e&&e.website_id&&(this.website_id=e.website_id),e&&e.token_id&&(this.token_id=e.token_id),this.device={},e&&e.useragent&&(this.device.useragent=e.useragent),e&&e.timezone&&(this.device.timezone=e.timezone),e&&e.locales&&(this.device.locales=e.locales),e&&e.page_url&&(this.device.page_url=e.page_url),e&&e.page_title&&(this.device.page_title=e.page_title),e&&e.page_referrer&&(this.device.page_referrer=e.page_referrer)},e.prototype.__transports=function(e,t){var i=this,r=["websocket","polling"];"production"===this.environment&&(r=["websocket"]),this.event=t.PubSub,this.socket=t.io(e.url_relay,{path:"/",transports:r,reconnectionDelay:1e4,reconnectionDelayMax:3e4}),window.addEventListener("unload",function(){i.socket.connected===!0&&i.socket.disconnect()}),this.cookie=t.Cookies(window)},e}());var s={};s.client=function(e){var t,i=[],n=e||{};return function(e,n,s,a,o,c,_,l,p,h,u,d){i.push('<div class="crisp-client"><div class="crisp-0"><style type="text/css">.crisp-client .crisp-1 .crisp-2,\n.crisp-client .crisp-1 .crisp-3:hover,\n.crisp-client .crisp-1 .crisp-3:focus {\n  color: '+r.Library.jade.runtime.escape(null==(t=a.reverse.hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a.reverse.hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-4,\n.crisp-client .crisp-1 .crisp-5:hover,\n.crisp-client .crisp-1 .crisp-5:focus {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[900].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[900].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-6,\n.crisp-client .crisp-1 .crisp-7:hover,\n.crisp-client .crisp-1 .crisp-7:focus {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[500].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[500].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-8,\n.crisp-client .crisp-1 .crisp-9:hover,\n.crisp-client .crisp-1 .crisp-9:focus {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[300].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[300].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-10 {\n  background-color: "+r.Library.jade.runtime.escape(null==(t=a.reverse.hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-11 {\n  background-color: "+r.Library.jade.runtime.escape(null==(t=a[500].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-12 {\n  background-color: "+r.Library.jade.runtime.escape(null==(t=a[10].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-13,\n.crisp-client .crisp-1 .crisp-14:hover,\n.crisp-client .crisp-1 .crisp-14:focus {\n  border-color: "+r.Library.jade.runtime.escape(null==(t=a.reverse.hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-15,\n.crisp-client .crisp-1 .crisp-16:hover,\n.crisp-client .crisp-1 .crisp-16:focus {\n  border-color: "+r.Library.jade.runtime.escape(null==(t=a.reverse.rgba(.6))?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-17,\n.crisp-client .crisp-1 .crisp-18:hover,\n.crisp-client .crisp-1 .crisp-18:focus {\n  border-color: "+r.Library.jade.runtime.escape(null==(t=a[800].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-19,\n.crisp-client .crisp-1 .crisp-20:hover,\n.crisp-client .crisp-1 .crisp-20:focus {\n  border-color: "+r.Library.jade.runtime.escape(null==(t=a[500].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-21:placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-21:-moz-placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-21::-moz-placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-21:-ms-input-placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-21::-webkit-input-placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-22:placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-22:-moz-placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-22::-moz-placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-22:-ms-input-placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-22::-webkit-input-placeholder {\n  color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n  -webkit-text-fill-color: "+r.Library.jade.runtime.escape(null==(t=a[200].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-23 {\n  background: "+r.Library.jade.runtime.escape(null==(t=a[500].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-23:hover,\n.crisp-client .crisp-1 .crisp-23:focus {\n  background: "+r.Library.jade.runtime.escape(null==(t=a[700].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-23:active {\n  background: "+r.Library.jade.runtime.escape(null==(t=a[900].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-24::-moz-selection,\n.crisp-client .crisp-1 .crisp-24 *::-moz-selection {\n  background-color: "+r.Library.jade.runtime.escape(null==(t=a[100].hex)?"":t)+" !important;\n}\n\n.crisp-client .crisp-1 .crisp-24::selection,\n.crisp-client .crisp-1 .crisp-24 *::selection {\n  background-color: "+r.Library.jade.runtime.escape(null==(t=a[100].hex)?"":t)+" !important;\n}</style>"),u.default_button_horizontal&&i.push('<style type="text/css">.crisp-client .crisp-1[data-full-view="false"][data-position-reverse="false"] .crisp-25 .crisp-26,\n.crisp-client .crisp-1[data-full-view="false"][data-position-reverse="false"] .crisp-25 .crisp-27 {\n  margin-right: '+r.Library.jade.runtime.escape(null==(t=u.default_button_horizontal)?"":t)+'px !important;\n}\n\n.crisp-client .crisp-1[data-full-view="false"][data-position-reverse="false"] .crisp-25 .crisp-26 .crisp-28 .crisp-29 {\n  margin-right: '+r.Library.jade.runtime.escape(null==(t=u.default_button_horizontal)?"":t)+'px !important;\n}\n\n.crisp-client .crisp-1[data-full-view="false"][data-position-reverse="true"] .crisp-25 .crisp-26,\n.crisp-client .crisp-1[data-full-view="false"][data-position-reverse="true"] .crisp-25 .crisp-27 {\n  margin-left: '+r.Library.jade.runtime.escape(null==(t=u.default_button_horizontal)?"":t)+'px !important;\n}\n\n.crisp-client .crisp-1[data-full-view="false"][data-position-reverse="true"] .crisp-25 .crisp-26 .crisp-28 .crisp-29 {\n  margin-left: '+r.Library.jade.runtime.escape(null==(t=u.default_button_horizontal)?"":t)+"px !important;\n}\n</style>"),u.default_button_vertical&&i.push('<style type="text/css">.crisp-client .crisp-1[data-full-view="false"] .crisp-25 .crisp-26,\n.crisp-client .crisp-1[data-full-view="false"] .crisp-25 .crisp-27 {\n  margin-bottom: '+r.Library.jade.runtime.escape(null==(t=u.default_button_vertical)?"":t)+'px !important;\n}\n\n.crisp-client .crisp-1[data-full-view="false"] .crisp-25 .crisp-26 .crisp-28 .crisp-29 {\n  margin-bottom: '+r.Library.jade.runtime.escape(null==(t=u.default_button_vertical)?"":t)+"px !important;\n}\n</style>"),u.mobile_button_horizontal&&i.push('<style type="text/css">.crisp-client .crisp-1[data-full-view="true"][data-position-reverse="false"] .crisp-25 .crisp-26 {\n  margin-right: '+r.Library.jade.runtime.escape(null==(t=u.mobile_button_horizontal)?"":t)+'px !important;\n}\n\n.crisp-client .crisp-1[data-full-view="true"][data-position-reverse="false"] .crisp-25 .crisp-26 .crisp-28 .crisp-29 {\n  margin-right: '+r.Library.jade.runtime.escape(null==(t=u.mobile_button_horizontal)?"":t)+'px !important;\n}\n\n.crisp-client .crisp-1[data-full-view="true"][data-position-reverse="true"] .crisp-25 .crisp-26 {\n  margin-left: '+r.Library.jade.runtime.escape(null==(t=u.mobile_button_horizontal)?"":t)+'px !important;\n}\n\n.crisp-client .crisp-1[data-full-view="true"][data-position-reverse="true"] .crisp-25 .crisp-26 .crisp-28 .crisp-29 {\n  margin-left: '+r.Library.jade.runtime.escape(null==(t=u.mobile_button_horizontal)?"":t)+"px !important;\n}\n</style>"),u.mobile_button_vertical&&i.push('<style type="text/css">.crisp-client .crisp-1[data-full-view="true"] .crisp-25 .crisp-26 {\n  margin-bottom: '+r.Library.jade.runtime.escape(null==(t=u.mobile_button_vertical)?"":t)+'px !important;\n}\n\n.crisp-client .crisp-1[data-full-view="true"] .crisp-25 .crisp-26 .crisp-28 .crisp-29 {\n  margin-bottom: '+r.Library.jade.runtime.escape(null==(t=u.mobile_button_vertical)?"":t)+"px !important;\n}</style>"),i.push("</div><div"+r.Library.jade.runtime.attr("lang",""+l,!0,!1)+r.Library.jade.runtime.attr("dir",""+o,!0,!1)+r.Library.jade.runtime.attr("data-blocked-page",""+s,!0,!1)+r.Library.jade.runtime.attr("data-blocked-locale",""+n,!0,!1)+r.Library.jade.runtime.attr("data-lock-maximized",""+h,!0,!1)+r.Library.jade.runtime.attr("data-last-operator-face",""+p,!0,!1)+r.Library.jade.runtime.attr("data-availability-tooltip",""+e,!0,!1)+r.Library.jade.runtime.attr("data-hide-on-away",""+_,!0,!1)+r.Library.jade.runtime.attr("data-position-reverse",""+d,!0,!1)+r.Library.jade.runtime.attr("data-force-identify",""+c,!0,!1)+' data-availability="none" data-was-availability-online="false" data-has-exchanged-messages="false" data-has-local-messages="false" class="crisp-1"></div></div>')}.call(this,"availability_tooltip"in n?n.availability_tooltip:"undefined"!=typeof availability_tooltip?availability_tooltip:void 0,"blocked_locale"in n?n.blocked_locale:"undefined"!=typeof blocked_locale?blocked_locale:void 0,"blocked_page"in n?n.blocked_page:"undefined"!=typeof blocked_page?blocked_page:void 0,"colors"in n?n.colors:"undefined"!=typeof colors?colors:void 0,"direction"in n?n.direction:"undefined"!=typeof direction?direction:void 0,"force_identify"in n?n.force_identify:"undefined"!=typeof force_identify?force_identify:void 0,"hide_on_away"in n?n.hide_on_away:"undefined"!=typeof hide_on_away?hide_on_away:void 0,"lang"in n?n.lang:"undefined"!=typeof lang?lang:void 0,"last_operator_face"in n?n.last_operator_face:"undefined"!=typeof last_operator_face?last_operator_face:void 0,"lock_maximized"in n?n.lock_maximized:"undefined"!=typeof lock_maximized?lock_maximized:void 0,"position"in n?n.position:"undefined"!=typeof position?position:void 0,"position_reverse"in n?n.position_reverse:"undefined"!=typeof position_reverse?position_reverse:void 0),i.join("")},s.viewport=function(e){var t=[],i=e||{};return function(e){t.push('<meta name="viewport"'+r.Library.jade.runtime.attr("content",""+e,!0,!1)+"/>")}.call(this,"content"in i?i.content:"undefined"!=typeof content?content:void 0),t.join("")},s.clear=function(e){var t=[];return t.push('<span class="crisp-30"></span>'),t.join("")},s.new_line=function(e){var t=[];return t.push('<br class="crisp-31"/>'),t.join("")},s.link_email=function(e){var t,i=[],n=e||{};return function(e){i.push("<a"+r.Library.jade.runtime.attr("href","mailto:"+e,!1,!1)+' class="crisp-32 crisp-33">'+(null==(t=e)?"":t)+"</a>")}.call(this,"email"in n?n.email:"undefined"!=typeof email?email:void 0),i.join("")},s.link_uri=function(e){var t,i=[],n=e||{};return function(e,n){i.push("<a"+r.Library.jade.runtime.attr("href",""+n,!1,!1)+' target="_blank" class="crisp-32 crisp-34">'+(null==(t=e)?"":t)+"</a>")}.call(this,"uri_name"in n?n.uri_name:"undefined"!=typeof uri_name?uri_name:void 0,"uri_value"in n?n.uri_value:"undefined"!=typeof uri_value?uri_value:void 0),i.join("")},s.link_domain=function(e){var t,i=[],n=e||{};return function(e,n){i.push("<a"+r.Library.jade.runtime.attr("href","http://"+n+"/",!1,!1)+' target="_blank" class="crisp-32 crisp-35">'+(null==(t=e)?"":t)+"</a>")}.call(this,"domain_name"in n?n.domain_name:"undefined"!=typeof domain_name?domain_name:void 0,"domain_value"in n?n.domain_value:"undefined"!=typeof domain_value?domain_value:void 0),i.join("")},s.markdown_blockquote=function(e){var t,i=[],r=e||{};return function(e){i.push('<span class="crisp-36 crisp-37">'+(null==(t=e)?"":t)+"</span>")}.call(this,"value"in r?r.value:"undefined"!=typeof value?value:void 0),i.join("")},s.markdown_bold=function(e){var t,i=[],r=e||{};return function(e){i.push('<span class="crisp-36 crisp-38 crisp-39">'+(null==(t=e)?"":t)+"</span>")}.call(this,"value"in r?r.value:"undefined"!=typeof value?value:void 0),i.join("")},s.markdown_code=function(e){var t,i=[],r=e||{};return function(e){i.push('<span class="crisp-36 crisp-40">'+(null==(t=e)?"":t)+"</span>")}.call(this,"value"in r?r.value:"undefined"!=typeof value?value:void 0),i.join("")},s.markdown_delete=function(e){var t,i=[],r=e||{};return function(e){i.push('<span class="crisp-36 crisp-41">'+(null==(t=e)?"":t)+"</span>")}.call(this,"value"in r?r.value:"undefined"!=typeof value?value:void 0),i.join("")},s.markdown_image=function(e){var t=[],i=e||{};return function(e,i,n,s){t.push("");var a=e(s);t.push("<img"+r.Library.jade.runtime.attr("src",""+n+"/process/original/?url="+a,!1,!1)+r.Library.jade.runtime.attr("alt",""+i,!1,!1)+' class="crisp-36 crisp-42"/>')}.call(this,"encodeURIComponent"in i?i.encodeURIComponent:"undefined"!=typeof encodeURIComponent?encodeURIComponent:void 0,"type"in i?i.type:"undefined"!=typeof type?type:void 0,"url_crisp_image"in i?i.url_crisp_image:"undefined"!=typeof url_crisp_image?url_crisp_image:void 0,"value"in i?i.value:"undefined"!=typeof value?value:void 0),t.join("")},s.markdown_italic=function(e){var t,i=[],r=e||{};return function(e){i.push('<span class="crisp-36 crisp-43">'+(null==(t=e)?"":t)+"</span>")}.call(this,"value"in r?r.value:"undefined"!=typeof value?value:void 0),i.join("")},s.markdown_line=function(e){var t=[];return t.push('<span class="crisp-36 crisp-44"></span>'),t.join("")},s.markdown_link=function(e){var t,i=[],n=e||{};return function(e,n){i.push("<a"+r.Library.jade.runtime.attr("href",""+n,!1,!1)+' target="_blank" class="crisp-36 crisp-45">'+(null==(t=e)?"":t)+"</a>")}.call(this,"type"in n?n.type:"undefined"!=typeof type?type:void 0,"value"in n?n.value:"undefined"!=typeof value?value:void 0),i.join("")},s.markdown_list=function(e){var t,i=[],n=e||{};return function(e,n){i.push("<span"+r.Library.jade.runtime.attr("data-type",""+e,!1,!1)+' class="crisp-36 crisp-46">'+(null==(t=n)?"":t)+"</span>")}.call(this,"type"in n?n.type:"undefined"!=typeof type?type:void 0,"value"in n?n.value:"undefined"!=typeof value?value:void 0),i.join("")},s.markdown_title=function(e){var t,i=[],n=e||{};return function(e,n){i.push("<span"+r.Library.jade.runtime.attr("data-type",""+e,!1,!1)+' class="crisp-36 crisp-47 crisp-39">'+(null==(t=n)?"":t)+"</span>")}.call(this,"type"in n?n.type:"undefined"!=typeof type?type:void 0,"value"in n?n.value:"undefined"!=typeof value?value:void 0),i.join("")},s.markdown_underline=function(e){var t,i=[],r=e||{};return function(e){i.push('<span class="crisp-36 crisp-48">'+(null==(t=e)?"":t)+"</span>")}.call(this,"value"in r?r.value:"undefined"!=typeof value?value:void 0),i.join("")},s.smiley=function(e){var t=[],i=e||{};return function(e,i){t.push("<span"+r.Library.jade.runtime.attr("data-size",i,!0,!1)+r.Library.jade.runtime.attr("data-name",e,!0,!1)+' class="crisp-49"></span>')}.call(this,"name"in i?i.name:"undefined"!=typeof name?name:void 0,"size"in i?i.size:"undefined"!=typeof size?size:void 0),t.join("")},s.sounds_events=function(e){var t=[],i=e||{};return function(e,i,n,s){t.push("");var a=[["oga","audio/ogg"],["m4a","audio/aac"],["mp3","audio/mpeg"]],o="events",c=["chat-message-receive"],_="auto";t.push("<div"+r.Library.jade.runtime.attr("data-subset",""+o,!0,!1)+' class="crisp-50">'),function(){var n=c;if("number"==typeof n.length)for(var l=0,p=n.length;l<p;l++){var h=n[l];t.push("<audio"+r.Library.jade.runtime.attr("data-name",""+h,!0,!1)+r.Library.jade.runtime.attr("preload",""+_,!0,!1)+' class="crisp-51">'),function(){var n=a;if("number"==typeof n.length)for(var c=0,_=n.length;c<_;c++){var l=n[c];i&&i!==l[0]||t.push("<source"+r.Library.jade.runtime.attr("src",""+s+"/static/sounds/"+o+"/"+h+"."+l[0]+"?"+e,!0,!1)+r.Library.jade.runtime.attr("type",""+l[1],!0,!1)+' class="crisp-52"/>')}else{var _=0;for(var c in n){_++;var l=n[c];i&&i!==l[0]||t.push("<source"+r.Library.jade.runtime.attr("src",""+s+"/static/sounds/"+o+"/"+h+"."+l[0]+"?"+e,!0,!1)+r.Library.jade.runtime.attr("type",""+l[1],!0,!1)+' class="crisp-52"/>')}}}.call(this),t.push("</audio>")}else{var p=0;for(var l in n){p++;var h=n[l];t.push("<audio"+r.Library.jade.runtime.attr("data-name",""+h,!0,!1)+r.Library.jade.runtime.attr("preload",""+_,!0,!1)+' class="crisp-51">'),function(){var n=a;if("number"==typeof n.length)for(var c=0,_=n.length;c<_;c++){var l=n[c];i&&i!==l[0]||t.push("<source"+r.Library.jade.runtime.attr("src",""+s+"/static/sounds/"+o+"/"+h+"."+l[0]+"?"+e,!0,!1)+r.Library.jade.runtime.attr("type",""+l[1],!0,!1)+' class="crisp-52"/>')}else{var _=0;for(var c in n){_++;var l=n[c];i&&i!==l[0]||t.push("<source"+r.Library.jade.runtime.attr("src",""+s+"/static/sounds/"+o+"/"+h+"."+l[0]+"?"+e,!0,!1)+r.Library.jade.runtime.attr("type",""+l[1],!0,!1)+' class="crisp-52"/>')}}}.call(this),t.push("</audio>")}}}.call(this),t.push("</div>")}.call(this,"client_revision"in i?i.client_revision:"undefined"!=typeof client_revision?client_revision:void 0,"selected_format"in i?i.selected_format:"undefined"!=typeof selected_format?selected_format:void 0,"undefined"in i?i.undefined:void 0,"url_assets"in i?i.url_assets:"undefined"!=typeof url_assets?url_assets:void 0),t.join("")},s.magnify=function(e){var t=[],i=e||{};return function(e,i,n){switch(t.push('<div tabindex="0"'+r.Library.jade.runtime.attr("data-type",""+n,!0,!1)+' data-state="loading" class="crisp-53"><span class="crisp-54"></span>'),n){case"embed":t.push('<iframe type="text/html"'+r.Library.jade.runtime.attr("src",""+i,!0,!1)+' frameborder="0" sandbox="allow-popups allow-same-origin allow-scripts" class="crisp-55"></iframe>');break;default:t.push("<img"+r.Library.jade.runtime.attr("src",""+i,!0,!1)+' alt="" class="crisp-55"/>')}t.push('<div class="crisp-56">'),"file"===n&&t.push('<a data-action="download"'+r.Library.jade.runtime.attr("href",""+i,!0,!1)+r.Library.jade.runtime.attr("download",""+(e||i),!0,!1)+' target="_blank" class="crisp-57"></a><span class="crisp-58"></span>'),t.push('<a data-action="close" href="#" class="crisp-57"></a></div></div>')}.call(this,"name"in i?i.name:"undefined"!=typeof name?name:void 0,"source"in i?i.source:"undefined"!=typeof source?source:void 0,"type"in i?i.type:"undefined"!=typeof type?type:void 0),t.join("")},s.date_now=function(e){var t,i=[],n=e||{};return function(e){i.push('<span data-type="now" class="crisp-59">'+r.Library.jade.runtime.escape(null==(t=e("date","now"))?"":t)+"</span>")}.call(this,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0),i.join("")},s.date_seconds=function(e){var t,i=[],n=e||{};return function(e){i.push('<span data-type="seconds" class="crisp-59">'+r.Library.jade.runtime.escape(null==(t=e("date","second"))?"":t)+"</span>")}.call(this,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0),i.join("")},s.date_minutes=function(e){var t,i=[],n=e||{};return function(e,n){i.push('<span data-type="minutes" class="crisp-59">'),1===n?i.push(r.Library.jade.runtime.escape(null==(t=e("date","minute_singular"))?"":t)):i.push(r.Library.jade.runtime.escape(null==(t=e("date","minute_plural",[n]))?"":t)),i.push("</span>")}.call(this,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"minutes"in n?n.minutes:"undefined"!=typeof minutes?minutes:void 0),i.join("")},s.date_hours=function(e){var t,i=[],n=e||{};return function(e,n){i.push('<span data-type="hours" class="crisp-59">'),1===n?i.push(r.Library.jade.runtime.escape(null==(t=e("date","hour_singular"))?"":t)):i.push(r.Library.jade.runtime.escape(null==(t=e("date","hour_plural",[n]))?"":t)),i.push("</span>")}.call(this,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"hours"in n?n.hours:"undefined"!=typeof hours?hours:void 0),i.join("")},s.date_far_away=function(e){var t,i=[],n=e||{};return function(e){i.push('<span data-type="far_away" class="crisp-59">'+r.Library.jade.runtime.escape(null==(t=e)?"":t)+"</span>")}.call(this,"date_full"in n?n.date_full:"undefined"!=typeof date_full?date_full:void 0),i.join("")},s.duration_now=function(e){var t,i=[],n=e||{};return function(e){
i.push('<span data-type="now" class="crisp-60">'+r.Library.jade.runtime.escape(null==(t=e("duration","now"))?"":t)+"</span>")}.call(this,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0),i.join("")},s.duration_seconds=function(e){var t,i=[],n=e||{};return function(e){i.push('<span data-type="seconds" class="crisp-60">'+r.Library.jade.runtime.escape(null==(t=e("duration","second"))?"":t)+"</span>")}.call(this,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0),i.join("")},s.duration_minutes=function(e){var t,i=[],n=e||{};return function(e,n){i.push('<span data-type="minutes" class="crisp-60">'),1===n?i.push(r.Library.jade.runtime.escape(null==(t=e("duration","minute_singular"))?"":t)):i.push(r.Library.jade.runtime.escape(null==(t=e("duration","minute_plural",[n]))?"":t)),i.push("</span>")}.call(this,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"minutes"in n?n.minutes:"undefined"!=typeof minutes?minutes:void 0),i.join("")},s.duration_hours=function(e){var t,i=[],n=e||{};return function(e,n){i.push('<span data-type="hours" class="crisp-60">'),1===n?i.push(r.Library.jade.runtime.escape(null==(t=e("duration","hour_singular"))?"":t)):i.push(r.Library.jade.runtime.escape(null==(t=e("duration","hour_plural",[n]))?"":t)),i.push("</span>")}.call(this,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"hours"in n?n.hours:"undefined"!=typeof hours?hours:void 0),i.join("")},s.duration_days=function(e){var t,i=[],n=e||{};return function(e){i.push('<span data-type="days" class="crisp-60">'+r.Library.jade.runtime.escape(null==(t=e("duration","days"))?"":t)+"</span>")}.call(this,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0),i.join("")},s.chat=function(e){var t,i=[],n=e||{};return function(e,n,s,a,o,c,_,l,p){i.push("");i.push('<div class="crisp-25 crisp-24"><div data-visible="true" data-chat-status="none" class="crisp-27"><div class="crisp-61"><div class="crisp-62 crisp-11 crisp-17"><span class="crisp-63 crisp-11"></span><span class="crisp-64">');var h=_.active_operators(p.id,a);(function(){var n=h;if("number"==typeof n.length)for(var s=0,a=n.length;s<a;s++){var o=n[s],c=e(240,"operator",o.identifier,o.avatar);i.push('<span class="crisp-65 crisp-66 crisp-19"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+c+"') !important;",!0,!1)+' class="crisp-67 crisp-68"></span><span'+r.Library.jade.runtime.attr("data-has-name",o.name?"true":"false",!0,!1)+' class="crisp-69"><span class="crisp-70"><span class="crisp-71"></span><span class="crisp-72 crisp-73">'+r.Library.jade.runtime.escape(null==(t=o.name)?"":t)+"</span></span></span></span>")}else{var a=0;for(var s in n){a++;var o=n[s],c=e(240,"operator",o.identifier,o.avatar);i.push('<span class="crisp-65 crisp-66 crisp-19"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+c+"') !important;",!0,!1)+' class="crisp-67 crisp-68"></span><span'+r.Library.jade.runtime.attr("data-has-name",o.name?"true":"false",!0,!1)+' class="crisp-69"><span class="crisp-70"><span class="crisp-71"></span><span class="crisp-72 crisp-73">'+r.Library.jade.runtime.escape(null==(t=o.name)?"":t)+"</span></span></span></span>")}}}).call(this),i.push('</span><span class="crisp-74"><span class="crisp-75 crisp-2 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("theme_text",["default_chat",a.chat.theme_text+"_chat"]))?"":t)+'</span><span class="crisp-76"><span data-type="operator_name" class="crisp-77 crisp-78 crisp-2 crisp-39"></span><span class="crisp-77 crisp-2 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_header_ongoing_from"))?"":t)+'</span><span data-type="website_name" class="crisp-77 crisp-2 crisp-73">'+r.Library.jade.runtime.escape(null==(t=a.website.name)?"":t)+'</span><span class="crisp-30"></span></span><span class="crisp-79"><span data-id="online" class="crisp-80">');var u=a.chat.activity_metrics===!0&&s.metrics&&!0;i.push('<span data-type="default"'+r.Library.jade.runtime.attr("data-duration",u===!0?s.metrics.raw:null,!0,!1)+' class="crisp-81 crisp-2 crisp-73">'),u===!0?i.push(r.Library.jade.runtime.escape(null==(t=n("chat","chat_header_ongoing_status_metrics",[s.metrics.format]))?"":t)):i.push(r.Library.jade.runtime.escape(null==(t=n("chat","chat_header_ongoing_status_online"))?"":t)),i.push('</span><span data-type="ongoing" class="crisp-81 crisp-2 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_header_ongoing_status_online"))?"":t)+'</span></span><span data-id="away" class="crisp-80">');var u=a.chat.activity_metrics===!0&&s.last&&!0;i.push('<span data-type="default"'+r.Library.jade.runtime.attr("data-date-iso",u===!0?s.last.raw:null,!0,!1)+r.Library.jade.runtime.attr("data-date-format",u===!0?n("chat","chat_header_ongoing_status_last"):null,!0,!1)+r.Library.jade.runtime.attr("data-date-watch",u===!0?"true":null,!0,!1)+' class="crisp-81 crisp-2 crisp-73">'),u===!0?i.push(r.Library.jade.runtime.escape(null==(t=n("chat","chat_header_ongoing_status_last",[s.last.format]))?"":t)):i.push(r.Library.jade.runtime.escape(null==(t=n("chat","chat_header_ongoing_status_away"))?"":t)),i.push('</span><span data-type="ongoing" class="crisp-81 crisp-2 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_header_ongoing_status_away"))?"":t)+'</span></span><span class="crisp-30"></span></span></span><span class="crisp-82"><span class="crisp-83"></span></span></div><span class="crisp-84"></span></div><div class="crisp-85"><div'+r.Library.jade.runtime.attr("data-refer-hide-space","urn:crisp.im:debranding:0"in a.plugins?"true":"false",!0,!1)+' class="crisp-86"><div'+r.Library.jade.runtime.attr("data-tile",a.chat.tile?a.chat.tile:null,!0,!1)+' class="crisp-87 crisp-12"><div class="crisp-88"><div class="crisp-89"></div><div class="crisp-90"></div></div></div><div class="crisp-91"><div class="crisp-92"></div><div class="crisp-93"><div class="crisp-94"><div class="crisp-95"></div><div class="crisp-96 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_form_attach_tooltip"))?"":t)+'</div></div></div></div><div data-has-animation="true" class="crisp-97"><div class="crisp-98"><div class="crisp-99"><a href="#" data-type="smiley" class="crisp-100 crisp-7 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_pickers_selector_smileys"))?"":t)+'</a><span class="crisp-101"></span><a href="#" data-type="gif" class="crisp-100 crisp-7 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_pickers_selector_gifs"))?"":t)+'</a></div><div class="crisp-102"><div data-type="smiley" class="crisp-103"><span class="crisp-104">'),function(){var e=c.smileys;if("number"==typeof e.length)for(var t=0,n=e.length;t<n;t++){var s=e[t];i.push('<a href="#" data-size="large"'+r.Library.jade.runtime.attr("data-name",t,!0,!1)+r.Library.jade.runtime.attr("data-value",s,!0,!1)+' class="crisp-105 crisp-49"></a>')}else{var n=0;for(var t in e){n++;var s=e[t];i.push('<a href="#" data-size="large"'+r.Library.jade.runtime.attr("data-name",t,!0,!1)+r.Library.jade.runtime.attr("data-value",s,!0,!1)+' class="crisp-105 crisp-49"></a>')}}}.call(this),i.push('</span></div><div data-type="gif" data-has-search="false" class="crisp-103"><span class="crisp-106"><span data-action="search" class="crisp-107">');var d=n("chat","chat_pickers_gif_search");i.push('<a href="#" class="crisp-108"></a><input type="text" name="gif_search"'+r.Library.jade.runtime.attr("placeholder",""+d,!0,!1)+' maxlength="25" autocomplete="off" autocorrect="off" autocapitalize="off" class="crisp-109 crisp-110 crisp-73"/></span></span><span class="crisp-104"></span><span class="crisp-111"><span data-notice="no_results" class="crisp-112 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_pickers_gif_no_results"))?"":t)+'</span></span></div></div></div></div><div class="crisp-113"><a href="#" data-type="new_messages" class="crisp-114"><span class="crisp-115 crisp-116"><span class="crisp-117"></span><span class="crisp-118 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_new_messages"))?"":t)+'</span></span></a><a href="#" data-type="warn_reply" class="crisp-114"><div class="crisp-115"><span class="crisp-118 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_warn_reply"))?"":t)+'</span></div></a><a href="#" data-type="email_invalid" class="crisp-114"><div class="crisp-115"><span class="crisp-118 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_email_invalid"))?"":t)+'</span></div></a><div data-type="wait_reply" class="crisp-114"><div class="crisp-115 crisp-116"><span class="crisp-118 crisp-39"><span data-id="online" class="crisp-119">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_wait_reply_online"))?"":t)+'</span><span data-id="away" class="crisp-119">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_wait_reply_away"))?"":t)+'</span></span></div></div><div data-type="email_form" data-error="false" class="crisp-114"><div class="crisp-115"><span class="crisp-118 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_email_form_label"))?"":t)+'</span><span class="crisp-118 crisp-120 crisp-121 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_email_form_entice_default"))?"":t)+'</span><span class="crisp-118 crisp-120 crisp-122 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_email_form_entice_error"))?"":t)+'</span><form action="#" method="post" class="crisp-123"><div class="crisp-124">');var f=n("chat","chat_alerts_email_form_email_field");i.push('<div class="crisp-125"><input type="email" name="client_email"'+r.Library.jade.runtime.attr("placeholder",""+f,!0,!1)+' autocomplete="off" autocorrect="off" autocapitalize="off" class="crisp-126 crisp-110 crisp-21 crisp-73"/></div><a href="#" data-for="email_validate" class="crisp-127 crisp-23"><span class="crisp-128 crisp-2 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_email_form_email_button"))?"":t)+'</span></a><span class="crisp-30"></span></div></form><div class="crisp-129"><a href="#" data-for="email_validate" class="crisp-130 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_alerts_email_form_email_cancel"))?"":t)+'</a></div></div></div></div><div data-has-value="false" class="crisp-131"><form name="form_message" action="#" method="post" class="crisp-132">');var g=n("chat","chat_form_field_message");if(i.push('<textarea name="message"'+r.Library.jade.runtime.attr("placeholder",""+g,!0,!1)+' cols="20" rows="1" autocomplete="off" data-has-selection-range="data-has-selection-range" class="crisp-133 crisp-110 crisp-22 crisp-73"></textarea></form><div class="crisp-134"><div class="crisp-135"><div data-type="smiley" data-state="none" class="crisp-136"><span class="crisp-137"><span class="crisp-138 crisp-73"><span class="crisp-139">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_form_smiley_tooltip"))?"":t)+'</span></span><span class="crisp-140"></span><span class="crisp-30"></span></span><span class="crisp-141"><span class="crisp-142"><span class="crisp-143"><span class="crisp-144 crisp-145"></span><span class="crisp-146 crisp-145"></span></span></span></span></div><div data-type="file" data-state="none" class="crisp-136"><span class="crisp-137"><span class="crisp-138 crisp-73"><span class="crisp-139">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_form_attach_tooltip"))?"":t)+'</span></span><span class="crisp-140"></span><span class="crisp-30"></span></span><span class="crisp-141"><input type="file" name="attach_file" title="" multiple="multiple" class="crisp-147"/><span class="crisp-142 crisp-145"></span><span class="crisp-148"><span class="crisp-149"></span></span></span></div><span class="crisp-150"><a href="#" class="crisp-151 crisp-23"><span class="crisp-152"></span></a></span><span class="crisp-30"></span></div><span class="crisp-30"></span></div></div>'),!("urn:crisp.im:debranding:0"in a.plugins)){i.push('<div class="crisp-153"><div class="crisp-154">');var y=o(p.domain);i.push("<a"+r.Library.jade.runtime.attr("href",""+c.url.crisp_web+"?ref=chatbox&domain="+y,!0,!1)+' target="_blank" class="crisp-155"><span class="crisp-156 crisp-73">We run on</span><span class="crisp-157"></span><span class="crisp-156 crisp-158 crisp-39">Crisp</span><span class="crisp-30"></span></a><span class="crisp-30"></span></div><span class="crisp-30"></span></div>')}if(i.push('</div></div></div><a data-visible="false" data-is-failure="false" href="#" class="crisp-26"><span class="crisp-28"><span data-id="new_messages" class="crisp-29"><span class="crisp-159"><span class="crisp-160"></span></span><span class="crisp-161"><span class="crisp-162"><span data-variant="plural" data-for-id="new_messages" class="crisp-163 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","minimized_tooltip_unread_plural"))?"":t)+'</span><span data-variant="singular" data-for-id="new_messages" class="crisp-163 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("chat","minimized_tooltip_unread_singular"))?"":t)+'</span><span class="crisp-30"></span></span><span class="crisp-164"><span class="crisp-165 crisp-166"></span><span class="crisp-165 crisp-167"></span><span class="crisp-30"></span></span></span></span></span><span class="crisp-168 crisp-11"><span data-id="chat_opened" class="crisp-169"><span data-is-ongoing="false" class="crisp-170">'),a.chat.last_operator_face===!0&&a.website.active_operators.length>0){var m=a.website.active_operators[0],v=e(240,"operator",m.user_id,m.avatar);i.push('<span class="crisp-171 crisp-66"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+v+"') !important;",!0,!1)+' class="crisp-172 crisp-68"></span></span>')}else i.push('<span class="crisp-171 crisp-66"><span class="crisp-172 crisp-68"></span></span>');i.push('<span class="crisp-173"></span><span class="crisp-174 crisp-39">0</span></span></span></span></a><span data-visible="false" data-visible-subtle="false" class="crisp-175"><span class="crisp-176"></span></span></div>')}.call(this,"_a"in n?n._a:"undefined"!=typeof _a?_a:void 0,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"activity"in n?n.activity:"undefined"!=typeof activity?activity:void 0,"configuration"in n?n.configuration:"undefined"!=typeof configuration?configuration:void 0,"encodeURIComponent"in n?n.encodeURIComponent:"undefined"!=typeof encodeURIComponent?encodeURIComponent:void 0,"environment"in n?n.environment:"undefined"!=typeof environment?environment:void 0,"methods"in n?n.methods:"undefined"!=typeof methods?methods:void 0,"undefined"in n?n.undefined:void 0,"website"in n?n.website:"undefined"!=typeof website?website:void 0),i.join("")},s.minimized_authorized=function(e){var t,i=[],n=e||{};return function(e,n,s,a,o,c){i.push("");var _=!1;if(i.push('<div class="crisp-25 crisp-24"><a data-maximized="false"'+r.Library.jade.runtime.attr("data-is-failure",_===!0?"true":"false",!0,!1)+' href="#" class="crisp-26"><span class="crisp-28">'),!_){i.push('<span data-id="general_entice" class="crisp-29"><span class="crisp-161"><span class="crisp-162 crisp-8 crisp-73">');var l=a.active_operators(c.id,s);i.push('<span class="crisp-177 crisp-178 crisp-39"><span class="crisp-179 crisp-178"></span><span class="crisp-180 crisp-178">'+r.Library.jade.runtime.escape(null==(t=n("minimized","tooltip_entice_close"))?"":t)+'</span><span class="crisp-30"></span></span><span'+r.Library.jade.runtime.attr("data-avatar-count",""+(l.length||0),!0,!1)+' class="crisp-181">'),l.length>0&&(i.push('<span class="crisp-182">'),function(){var t=l;if("number"==typeof t.length)for(var n=0,s=t.length;n<s;n++){var a=t[n],o=e(240,"operator",a.identifier,a.avatar);i.push('<span class="crisp-183 crisp-66"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+o+"') !important;",!0,!1)+' class="crisp-184 crisp-68"></span></span>')}else{var s=0;for(var n in t){s++;var a=t[n],o=e(240,"operator",a.identifier,a.avatar);i.push('<span class="crisp-183 crisp-66"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+o+"') !important;",!0,!1)+' class="crisp-184 crisp-68"></span></span>')}}}.call(this),i.push("</span>")),i.push('<span class="crisp-185"><span class="crisp-186"><span class="crisp-187 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("minimized","tooltip_entice_title",[s.website.name]))?"":t)+'</span><span data-id="online" class="crisp-188 crisp-2 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("minimized","tooltip_entice_status_online"))?"":t)+'</span></span><span class="crisp-189 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("minimized","tooltip_entice_explain_online"))?"":t)+'</span></span></span><span class="crisp-190"><span class="crisp-191"><span class="crisp-192"></span><span class="crisp-193"></span></span><span class="crisp-194 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("minimized","tooltip_entice_form_compose"))?"":t)+'</span></span></span><span class="crisp-164"><span class="crisp-165 crisp-166"></span><span class="crisp-165 crisp-167"></span><span class="crisp-30"></span></span></span></span>')}if(_&&i.push('<span data-id="failure_notice" class="crisp-29"><span class="crisp-161"><span class="crisp-162 crisp-39"></span><span class="crisp-164"><span class="crisp-165 crisp-166"></span><span class="crisp-165 crisp-167"></span><span class="crisp-30"></span></span></span></span>'),i.push("</span>"),_)i.push('<span class="crisp-168 crisp-195"><span data-id="in_failure" class="crisp-169"><span data-is-ongoing="false" class="crisp-170"></span></span></span>');else{if(i.push('<span class="crisp-168 crisp-11"><span data-id="chat_closed" class="crisp-169"><span data-is-ongoing="false" class="crisp-170">'),s.chat.last_operator_face===!0&&s.website.active_operators.length>0){var p=s.website.active_operators[0],h=e(240,"operator",p.user_id,p.avatar);i.push('<span class="crisp-171 crisp-66"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+h+"') !important;",!0,!1)+' class="crisp-172 crisp-68"></span></span>')}i.push("</span></span></span>")}i.push("</a></div>")}.call(this,"_a"in n?n._a:"undefined"!=typeof _a?_a:void 0,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"configuration"in n?n.configuration:"undefined"!=typeof configuration?configuration:void 0,"methods"in n?n.methods:"undefined"!=typeof methods?methods:void 0,"undefined"in n?n.undefined:void 0,"website"in n?n.website:"undefined"!=typeof website?website:void 0),i.join("")},s.minimized_unauthorized=function(e){var t,i=[],n=e||{};return function(e,n,s){i.push("");var a=!0;if(i.push('<div class="crisp-25 crisp-24"><a data-maximized="false"'+r.Library.jade.runtime.attr("data-is-failure",a===!0?"true":"false",!0,!1)+' href="#" class="crisp-26"><span class="crisp-28">'),a||i.push('<span data-id="general_entice" class="crisp-29"><span class="crisp-161"><span class="crisp-162 crisp-8 crisp-73"></span><span class="crisp-164"><span class="crisp-165 crisp-166"></span><span class="crisp-165 crisp-167"></span><span class="crisp-30"></span></span></span></span>'),a&&i.push('<span data-id="failure_notice" class="crisp-29"><span class="crisp-161"><span class="crisp-162 crisp-39">'+r.Library.jade.runtime.escape(null==(t=n("minimized","unauthorized_pane"))?"":t)+'</span><span class="crisp-164"><span class="crisp-165 crisp-166"></span><span class="crisp-165 crisp-167"></span><span class="crisp-30"></span></span></span></span>'),i.push("</span>"),a)i.push('<span class="crisp-168 crisp-195"><span data-id="in_failure" class="crisp-169"><span data-is-ongoing="false" class="crisp-170"></span></span></span>');else{if(i.push('<span class="crisp-168 crisp-11"><span data-id="chat_closed" class="crisp-169"><span data-is-ongoing="false" class="crisp-170">'),s.chat.last_operator_face===!0&&s.website.active_operators.length>0){var o=s.website.active_operators[0],c=e(240,"operator",o.user_id,o.avatar);i.push('<span class="crisp-171 crisp-66"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+c+"') !important;",!0,!1)+' class="crisp-172 crisp-68"></span></span>')}i.push("</span></span></span>")}i.push("</a></div>")}.call(this,"_a"in n?n._a:"undefined"!=typeof _a?_a:void 0,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"configuration"in n?n.configuration:"undefined"!=typeof configuration?configuration:void 0),i.join("")},s.chat_preview_message=function(e){var t,i=[],n=e||{};return function(e,n,s,a,o,c,_,l,p,h){if(i.push(""),"text"===p||"file"===p||"animation"===p){i.push('<span class="crisp-196"><span class="crisp-197">');var u=e(240,h.type||l,h.user_id,h.avatar);switch(i.push('<span class="crisp-198 crisp-66"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+u+"') !important;",!0,!1)+' class="crisp-199 crisp-68"></span></span><span class="crisp-200"><span class="crisp-201"></span><span class="crisp-202"><span class="crisp-203 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","minimized_tooltip_message_from"))?"":t)+'</span><span class="crisp-204 crisp-39">'+r.Library.jade.runtime.escape(null==(t=a(h.nickname))?"":t)+'</span><span class="crisp-30"></span></span><span class="crisp-205 crisp-73">'),p){case"text":i.push(null==(t=s(o))?"":t);break;case"file":case"animation":switch(o.type){case"image/jpg":case"image/jpeg":case"image/png":case"image/gif":var d=c(o.url);switch(p){case"animation":i.push("<span"+r.Library.jade.runtime.attr("style","background-image: url('"+_.url.crisp_image+"/process/original/?url="+d+"') !important;",!0,!1)+' class="crisp-206"></span>');break;default:var f=180,g=180;i.push("<span"+r.Library.jade.runtime.attr("style","background-image: url('"+_.url.crisp_image+"/process/resize/?url="+d+"&width="+f+"&height="+g+"') !important;",!0,!1)+' class="crisp-206"></span>')}break;default:o.name?i.push(""+r.Library.jade.runtime.escape(null==(t=o.name)?"":t)):i.push(r.Library.jade.runtime.escape(null==(t=n("chat","chat_message_file_name"))?"":t))}}i.push('</span></span></span><span class="crisp-30"></span></span>')}}.call(this,"_a"in n?n._a:"undefined"!=typeof _a?_a:void 0,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"_f"in n?n._f:"undefined"!=typeof _f?_f:void 0,"_n"in n?n._n:"undefined"!=typeof _n?_n:void 0,"content"in n?n.content:"undefined"!=typeof content?content:void 0,"encodeURIComponent"in n?n.encodeURIComponent:"undefined"!=typeof encodeURIComponent?encodeURIComponent:void 0,"environment"in n?n.environment:"undefined"!=typeof environment?environment:void 0,"from"in n?n.from:"undefined"!=typeof from?from:void 0,"type"in n?n.type:"undefined"!=typeof type?type:void 0,"user"in n?n.user:"undefined"!=typeof user?user:void 0),i.join("")},s.chat_message_text=function(e){var t,i=[],n=e||{};return function(e,n,s,a,o,c,_,l,p,h,u,d,f,g,y){i.push("");var m="text";if(i.push("<div"+r.Library.jade.runtime.attr("data-from",""+u,!0,!1)+r.Library.jade.runtime.attr("data-date-iso",""+_,!0,!1)+r.Library.jade.runtime.attr("data-fingerprint",""+h,!0,!1)+r.Library.jade.runtime.attr("data-type",""+m,!0,!1)+r.Library.jade.runtime.attr("data-is-preview",""+d,!0,!1)+' class="crisp-207">'),"operator"===u){var v=e(96,y.type||u,y.user_id,y.avatar);i.push('<span class="crisp-208 crisp-66"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+v+"') !important;",!0,!1)+' class="crisp-209 crisp-68"></span>'),y.nickname&&i.push('<span class="crisp-210"><span class="crisp-211"><span class="crisp-212"></span><span class="crisp-213 crisp-73">'+r.Library.jade.runtime.escape(null==(t=a(y.nickname))?"":t)+"</span></span></span>"),i.push("</span>")}i.push("<span"+r.Library.jade.runtime.cls(["crisp-214","crisp-110","operator"===u?"crisp-11":""],[null,null,!0])+"><span"+r.Library.jade.runtime.cls(["crisp-215","crisp-73","operator"===u?"crisp-2":""],[null,null,!0])+">"+(null==(t=s(o))?"":t)),f.preview&&function(){var e=f.preview;if("number"==typeof e.length)for(var n=0,s=e.length;n<s;n++){var a=e[n];if(i.push('<span class="crisp-216">'),a.preview&&a.preview.embed&&a.preview.image){var o=l(a.preview.image),c=600,_=600;i.push("<a"+r.Library.jade.runtime.attr("href",""+a.preview.embed,!0,!1)+' target="_blank" data-type="embed"'+r.Library.jade.runtime.attr("style","background-image: url('"+p.url.crisp_image+"/process/resize/?url="+o+"&width="+c+"&height="+_+"') !important;",!0,!1)+' class="crisp-217 crisp-217"><span class="crisp-218"></span><span class="crisp-219"></span></a>')}else{i.push("<a"+r.Library.jade.runtime.attr("href",""+a.url,!0,!1)+' target="_blank" data-type="link"'+r.Library.jade.runtime.cls(["crisp-217","crisp-73","operator"===u?"crisp-15 crisp-2":""],[null,null,!0])+">");var h=a.title||a.website||a.url;i.push(""+r.Library.jade.runtime.escape(null==(t=h)?"":t)+"</a>")}i.push("</span>")}else{var s=0;for(var n in e){s++;var a=e[n];if(i.push('<span class="crisp-216">'),a.preview&&a.preview.embed&&a.preview.image){var o=l(a.preview.image),c=600,_=600;i.push("<a"+r.Library.jade.runtime.attr("href",""+a.preview.embed,!0,!1)+' target="_blank" data-type="embed"'+r.Library.jade.runtime.attr("style","background-image: url('"+p.url.crisp_image+"/process/resize/?url="+o+"&width="+c+"&height="+_+"') !important;",!0,!1)+' class="crisp-217 crisp-217"><span class="crisp-218"></span><span class="crisp-219"></span></a>')}else{i.push("<a"+r.Library.jade.runtime.attr("href",""+a.url,!0,!1)+' target="_blank" data-type="link"'+r.Library.jade.runtime.cls(["crisp-217","crisp-73","operator"===u?"crisp-15 crisp-2":""],[null,null,!0])+">");var h=a.title||a.website||a.url;i.push(""+r.Library.jade.runtime.escape(null==(t=h)?"":t)+"</a>")}i.push("</span>")}}}.call(this),i.push("</span>"),c&&i.push('<span class="crisp-220"><span class="crisp-221"><span class="crisp-222"></span><span'+r.Library.jade.runtime.attr("data-date-iso",""+_,!0,!1)+' data-date-watch="true" class="crisp-223 crisp-73">'+r.Library.jade.runtime.escape(null==(t=c)?"":t)+"</span></span></span>"),i.push('<span class="crisp-30"></span></span><span class="crisp-30"></span>'),"visitor"===u&&i.push('<span class="crisp-224"><span class="crisp-225"><span class="crisp-226"></span><span class="crisp-227 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_message_info_read"))?"":t)+'</span><span class="crisp-30"></span></span><span class="crisp-30"></span></span>'),"visitor"===u&&i.push('<a href="#" class="crisp-228"><span class="crisp-229 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_message_error_retry"))?"":t)+'</span><span class="crisp-230"></span><span class="crisp-30"></span></a>'),i.push('<span class="crisp-30"></span></div>')}.call(this,"_a"in n?n._a:"undefined"!=typeof _a?_a:void 0,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"_f"in n?n._f:"undefined"!=typeof _f?_f:void 0,"_n"in n?n._n:"undefined"!=typeof _n?_n:void 0,"content"in n?n.content:"undefined"!=typeof content?content:void 0,"date_formatted"in n?n.date_formatted:"undefined"!=typeof date_formatted?date_formatted:void 0,"date_iso"in n?n.date_iso:"undefined"!=typeof date_iso?date_iso:void 0,"encodeURIComponent"in n?n.encodeURIComponent:"undefined"!=typeof encodeURIComponent?encodeURIComponent:void 0,"environment"in n?n.environment:"undefined"!=typeof environment?environment:void 0,"fingerprint"in n?n.fingerprint:"undefined"!=typeof fingerprint?fingerprint:void 0,"from"in n?n.from:"undefined"!=typeof from?from:void 0,"message_is_preview"in n?n.message_is_preview:"undefined"!=typeof message_is_preview?message_is_preview:void 0,"metas"in n?n.metas:"undefined"!=typeof metas?metas:void 0,"undefined"in n?n.undefined:void 0,"user"in n?n.user:"undefined"!=typeof user?user:void 0),i.join("")},s.chat_message_file=function(e){var t,i=[],n=e||{};return function(e,n,s,a,o,c,_,l,p,h,u){i.push("");var d="file",f=["image/jpg","image/jpeg","image/png","image/gif"].indexOf(a.type)!==-1&&!0;if(i.push("<div"+r.Library.jade.runtime.attr("data-from",""+h,!0,!1)+r.Library.jade.runtime.attr("data-date-iso",""+c,!0,!1)+r.Library.jade.runtime.attr("data-fingerprint",""+p,!0,!1)+r.Library.jade.runtime.attr("data-type",""+d,!0,!1)+r.Library.jade.runtime.attr("data-is-preview",""+f,!0,!1)+' class="crisp-207">'),"operator"===h){var g=e(96,u.type||h,u.user_id,u.avatar);i.push('<span class="crisp-208 crisp-66"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+g+"') !important;",!0,!1)+' class="crisp-209 crisp-68"></span>'),u.nickname&&i.push('<span class="crisp-210"><span class="crisp-211"><span class="crisp-212"></span><span class="crisp-213 crisp-73">'+r.Library.jade.runtime.escape(null==(t=s(u.nickname))?"":t)+"</span></span></span>"),i.push("</span>")}switch(i.push("<span"+r.Library.jade.runtime.cls(["crisp-214","crisp-110","operator"===h?"crisp-11":""],[null,null,!0])+"><span"+r.Library.jade.runtime.cls(["crisp-215","crisp-73","operator"===h?"crisp-2":""],[null,null,!0])+'><span class="crisp-231"><span class="crisp-232 crisp-73">'),a.name?i.push(""+r.Library.jade.runtime.escape(null==(t=a.name)?"":t)):i.push(r.Library.jade.runtime.escape(null==(t=n("chat","chat_message_file_name"))?"":t)),i.push("</span>"),a.type){case"image/jpg":case"image/jpeg":case"image/png":case"image/gif":i.push("<a"+r.Library.jade.runtime.attr("href",""+a.url,!0,!1)+r.Library.jade.runtime.attr("data-name",""+a.name,!0,!1)+' class="crisp-233">');var y=_(a.url),m=600,v=600;i.push("<span"+r.Library.jade.runtime.attr("style","background-image: url('"+l.url.crisp_image+"/process/resize/?url="+y+"&width="+m+"&height="+v+"') !important;",!0,!1)+' class="crisp-234"></span></a>');break;default:i.push("<a"+r.Library.jade.runtime.attr("href",""+a.url,!0,!1)+r.Library.jade.runtime.attr("download","text/html"===a.type?null:""+(a.name||a.url),!0,!1)+' target="_blank"'+r.Library.jade.runtime.cls(["crisp-235","operator"===h?"crisp-2 crisp-13":""],[null,!0])+'><span class="crisp-236">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_message_file_button"))?"":t)+"</span></a>")}i.push("</span></span>"),o&&i.push('<span class="crisp-220"><span class="crisp-221"><span class="crisp-222"></span><span'+r.Library.jade.runtime.attr("data-date-iso",""+c,!0,!1)+' data-date-watch="true" class="crisp-223 crisp-73">'+r.Library.jade.runtime.escape(null==(t=o)?"":t)+"</span></span></span>"),i.push('<span class="crisp-30"></span></span><span class="crisp-30"></span>'),"visitor"===h&&i.push('<span class="crisp-224"><span class="crisp-225"><span class="crisp-226"></span><span class="crisp-227 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_message_info_read"))?"":t)+'</span><span class="crisp-30"></span></span><span class="crisp-30"></span></span>'),"visitor"===h&&i.push('<a href="#" class="crisp-228"><span class="crisp-229 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_message_error_retry"))?"":t)+'</span><span class="crisp-230"></span><span class="crisp-30"></span></a>'),i.push('<span class="crisp-30"></span></div>')}.call(this,"_a"in n?n._a:"undefined"!=typeof _a?_a:void 0,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"_n"in n?n._n:"undefined"!=typeof _n?_n:void 0,"content"in n?n.content:"undefined"!=typeof content?content:void 0,"date_formatted"in n?n.date_formatted:"undefined"!=typeof date_formatted?date_formatted:void 0,"date_iso"in n?n.date_iso:"undefined"!=typeof date_iso?date_iso:void 0,"encodeURIComponent"in n?n.encodeURIComponent:"undefined"!=typeof encodeURIComponent?encodeURIComponent:void 0,"environment"in n?n.environment:"undefined"!=typeof environment?environment:void 0,"fingerprint"in n?n.fingerprint:"undefined"!=typeof fingerprint?fingerprint:void 0,"from"in n?n.from:"undefined"!=typeof from?from:void 0,"user"in n?n.user:"undefined"!=typeof user?user:void 0),i.join("")},s.chat_message_animation=function(e){var t,i=[],n=e||{};return function(e,n,s,a,o,c,_,l,p,h,u){i.push("");var d="animation",f=!0;if(i.push("<div"+r.Library.jade.runtime.attr("data-from",""+h,!0,!1)+r.Library.jade.runtime.attr("data-date-iso",""+c,!0,!1)+r.Library.jade.runtime.attr("data-fingerprint",""+p,!0,!1)+r.Library.jade.runtime.attr("data-type",""+d,!0,!1)+r.Library.jade.runtime.attr("data-is-preview",""+f,!0,!1)+' class="crisp-207">'),
"operator"===h){var g=e(96,u.type||h,u.user_id,u.avatar);i.push('<span class="crisp-208 crisp-66"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+g+"') !important;",!0,!1)+' class="crisp-209 crisp-68"></span>'),u.nickname&&i.push('<span class="crisp-210"><span class="crisp-211"><span class="crisp-212"></span><span class="crisp-213 crisp-73">'+r.Library.jade.runtime.escape(null==(t=s(u.nickname))?"":t)+"</span></span></span>"),i.push("</span>")}i.push("<span"+r.Library.jade.runtime.cls(["crisp-214","crisp-110","operator"===h?"crisp-11":""],[null,null,!0])+"><span"+r.Library.jade.runtime.cls(["crisp-215","crisp-73","operator"===h?"crisp-2":""],[null,null,!0])+">");var y=a.url.match(/^(?:https?:)?(?:\/\/)?([^\/\?]+)/)[1],m=_(a.url);i.push("<span"+r.Library.jade.runtime.attr("data-source",y?y:null,!0,!1)+' class="crisp-237"><span'+r.Library.jade.runtime.attr("style","background-image: url('"+l.url.crisp_image+"/process/original/?url="+m+"') !important;",!0,!1)+' class="crisp-238"><span class="crisp-239"><span class="crisp-240"></span></span></span></span></span>'),o&&i.push('<span class="crisp-220"><span class="crisp-221"><span class="crisp-222"></span><span'+r.Library.jade.runtime.attr("data-date-iso",""+c,!0,!1)+' data-date-watch="true" class="crisp-223 crisp-73">'+r.Library.jade.runtime.escape(null==(t=o)?"":t)+"</span></span></span>"),i.push('<span class="crisp-30"></span></span><span class="crisp-30"></span>'),"visitor"===h&&i.push('<span class="crisp-224"><span class="crisp-225"><span class="crisp-226"></span><span class="crisp-227 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_message_info_read"))?"":t)+'</span><span class="crisp-30"></span></span><span class="crisp-30"></span></span>'),"visitor"===h&&i.push('<a href="#" class="crisp-228"><span class="crisp-229 crisp-73">'+r.Library.jade.runtime.escape(null==(t=n("chat","chat_message_error_retry"))?"":t)+'</span><span class="crisp-230"></span><span class="crisp-30"></span></a>'),i.push('<span class="crisp-30"></span></div>')}.call(this,"_a"in n?n._a:"undefined"!=typeof _a?_a:void 0,"_e"in n?n._e:"undefined"!=typeof _e?_e:void 0,"_n"in n?n._n:"undefined"!=typeof _n?_n:void 0,"content"in n?n.content:"undefined"!=typeof content?content:void 0,"date_formatted"in n?n.date_formatted:"undefined"!=typeof date_formatted?date_formatted:void 0,"date_iso"in n?n.date_iso:"undefined"!=typeof date_iso?date_iso:void 0,"encodeURIComponent"in n?n.encodeURIComponent:"undefined"!=typeof encodeURIComponent?encodeURIComponent:void 0,"environment"in n?n.environment:"undefined"!=typeof environment?environment:void 0,"fingerprint"in n?n.fingerprint:"undefined"!=typeof fingerprint?fingerprint:void 0,"from"in n?n.from:"undefined"!=typeof from?from:void 0,"user"in n?n.user:"undefined"!=typeof user?user:void 0),i.join("")},s.chat_bubble_composing=function(e){var t=[],i=e||{};return function(e){t.push('<div class="crisp-241"><span class="crisp-242 crisp-11">'),function(){var e=[1,2,3];if("number"==typeof e.length)for(var i=0,r=e.length;i<r;i++){e[i];t.push('<span class="crisp-243 crisp-10"></span>')}else{var r=0;for(var i in e){r++;e[i];t.push('<span class="crisp-243 crisp-10"></span>')}}}.call(this),t.push('</span><span class="crisp-30"></span></div>')}.call(this,"undefined"in i?i.undefined:void 0),t.join("")},s.chat_bubble_thread=function(e){var t,i=[],n=e||{};return function(e,n,s,a){i.push("<div"+r.Library.jade.runtime.attr("data-day",""+(e||"none"),!0,!1)+r.Library.jade.runtime.attr("data-month",""+(n||"none"),!0,!1)+r.Library.jade.runtime.attr("data-year",""+(a||"none"),!0,!1)+' class="crisp-244">'),s&&i.push('<div class="crisp-245"><span class="crisp-246 crisp-39">'+r.Library.jade.runtime.escape(null==(t=s)?"":t)+"</span></div>"),i.push('<div class="crisp-247"></div></div>')}.call(this,"day"in n?n.day:"undefined"!=typeof day?day:void 0,"month"in n?n.month:"undefined"!=typeof month?month:void 0,"title"in n?n.title:"undefined"!=typeof title?title:void 0,"year"in n?n.year:"undefined"!=typeof year?year:void 0),i.join("")},s.chat_bubble_group=function(e){var t=[],i=e||{};return function(e,i){t.push("<div"+r.Library.jade.runtime.attr("data-from",""+e,!0,!1)+r.Library.jade.runtime.attr("data-user-marker",""+i,!0,!1)+' class="crisp-248"></div>')}.call(this,"from"in i?i.from:"undefined"!=typeof from?from:void 0,"user_marker"in i?i.user_marker:"undefined"!=typeof user_marker?user_marker:void 0),t.join("")},s.chat_picker_gif_item=function(e){var t=[];return t.push('<a href="#" data-removable="true" data-loading="true" class="crisp-105 crisp-13 crisp-20"></a>'),t.join("")},this.logger=i.Console,this.dom=i.cash,this.crisp={web:i.CrispLibraryWeb,client:i.CrispLibraryClient},this.jade={runtime:i.jade,client:s},this.__extends()}catch(t){this.logger.error(this.ns+"."+e,t)}}return e.prototype.__extends=function(){var e="__extends";try{this.__extend_dom()}catch(t){this.logger.error(this.ns+"."+e,t)}},e.prototype.__extend_dom=function(){var e="__extend_dom";try{this.dom.fn.extend({safe_css_text:function(e,t){return e?t?(this.each(function(i){i.style.cssText=e+": "+t+" !important;"}),this):this[0].style.cssText:void this.each(function(e){e.style.cssText=""})}})}catch(t){this.logger.error(this.ns+"."+e,t)}},e}()),t.Polyfill=new(function(){function e(){var e="constructor";try{this.ns="CrispPolyfill",this.__apply()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.__apply=function(){var e="__apply";try{this.__function_bind()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__function_bind=function(){var e="__function_bind";try{Function.prototype.__crisp_bind=function(e){var t=void 0,i=void 0,r=void 0,n=void 0;if("function"!=typeof this)throw new TypeError("Function.prototype.__crisp_bind - not callable");return t=Array.prototype.slice.call(arguments,1),i=this,r=function(){},n=function(){return i.apply(this instanceof r?this:e,t.concat(Array.prototype.slice.call(arguments)))},this.prototype&&(r.prototype=this.prototype),n.prototype=new r,n}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}());var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.Utility=new(function(){function e(){var e="constructor";try{this.ns="CrispUtility",this.__rule_single_key="[match:single]",this.__rule_double_key="[match:double]",this.__rule_single_regex=/([\*]{1})/g,this.__rule_double_regex=/([\*]{2})/g,this.__rule_single_key_regex=/(\[match:single\])/g,this.__rule_double_key_regex=/(\[match:double\])/g,this.__page_url_regex=/^(?:https?:[\/]*)?([^\/]+)([^#]*)?(?:[\/]+)?(?:#.*)?$/i}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.is_empty=function(e){var i="is_empty",r=!0;try{this.keys(e).length>0&&(r=!1)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.is_equal=function(e,r){var n="is_equal",s=!0;try{var a=-1,o=void 0,c=void 0;if(("undefined"==typeof e?"undefined":i(e))!==("undefined"==typeof r?"undefined":i(r)))s=!1;else if(e&&"object"===("undefined"==typeof e?"undefined":i(e))&&r&&"object"===("undefined"==typeof r?"undefined":i(r)))for(e instanceof Array||r instanceof Array?(c=this.union(e,r),e.length===c.length&&r.length===c.length||(s=!1)):c=this.union(this.keys(e),this.keys(r));++a<c.length&&s===!0;)o=c[a],s=this.is_equal(e[o],r[o]);else s=e===r&&!0}catch(e){t.Library.logger.error(this.ns+"."+n,e)}finally{return s}},e.prototype.keys=function(e){var r="keys",n=[];try{"object"===("undefined"==typeof e?"undefined":i(e))&&e&&(n=Object.keys(e))}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e.prototype.clone=function(e){var r="clone",n=void 0;try{var s=void 0,a=void 0;n=Array.isArray(e)?[]:{};for(s in e)a=e[s],n[s]="object"===("undefined"==typeof a?"undefined":i(a))?this.clone(a):a}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e.prototype.intersect=function(e,i){var r="intersect",n=[];try{for(var s=0;s<e.length;s++)i.indexOf(e[s])!==-1&&n.push(e[s])}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e.prototype.union=function(e,i){var r="union",n=[];try{for(var s=0;s<e.length;s++)n.indexOf(e[s])===-1&&n.push(e[s]);for(var a=0;a<i.length;a++)n.indexOf(i[a])===-1&&n.push(i[a])}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e.prototype.extract=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s="extract",a=i||r||"";try{var o=(i||"").trim().match(e);a=o&&o[n]?o[n]:r||""}catch(e){t.Library.logger.error(this.ns+"."+s,e)}finally{return a}},e.prototype.compare_rule=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",s="compare_rule",a=!1;try{i.indexOf("*")!==-1?(i=i.replace(this.__rule_double_regex,this.__rule_double_key),i=i.replace(this.__rule_single_regex,this.__rule_single_key),i=i.replace(this.__rule_double_key_regex,n+"*"),i=i.replace(this.__rule_single_key_regex,r+"*"),a=new RegExp("^"+i+"$").test(e)&&!0):a=e===i&&!0}catch(e){t.Library.logger.error(this.ns+"."+s,e)}finally{return a}},e.prototype.compare_rules=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",s="compare_rules",a=!1;try{for(var o=0;o<i.length&&a!==!0;)a=this.compare_rule(e,i[o],r,n),o++}catch(e){t.Library.logger.error(this.ns+"."+s,e)}finally{return a}},e.prototype.compare_page_rules=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n="compare_page_rules",s=!1;try{if(i.length>0){var a=void 0,o=[];null===r&&(r=t.Base._website_domain);for(var c=0;c<i.length;c++){var _=(i[c]||"").trim();_?(a=_.match(this.__page_url_regex),a?o.push(""+a[1]+(a[2]||"/")):o.push(""+r+_)):t.Library.logger.warn(this.ns+"."+n,"Parsed page URL: "+identifier+" is not valid: "+i[c])}var l=e.match(this.__page_url_regex),p=l?""+l[1]+(l[2]||"/"):null;this.compare_rules(p,o,match_single="[^/]",match_double=".")===!0&&(s=!0)}}catch(e){t.Library.logger.error(this.ns+"."+n,e)}finally{return s}},e}()),t.Feature=new(function(){function e(){var e="constructor";try{this.ns="CrispFeature",this.__has_screen_touch=this.__has_window_property("ontouchstart"),this.__has_device_vibrate=this.__has_navigator_property("vibrate"),this.__has_css_animations=this.__has_css_support_for("animation"),this.__html_audio_format=this.__detect_html_audio_support()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.has_screen_touch=function(){var e="has_screen_touch";try{return this.__has_screen_touch}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.has_device_vibrate=function(){var e="has_device_vibrate";try{return this.__has_device_vibrate}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.has_css_animations=function(){var e="has_css_animations";try{return this.__has_css_animations}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.has_html_audio=function(){var e="has_html_audio";try{return null!==this.__html_audio_format&&!0}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.html_audio_format=function(){var e="html_audio_format";try{return this.__html_audio_format}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__has_window_property=function(e){var i="__has_window_property",r=!1;try{r=!!(e in window)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.__has_navigator_property=function(e){var i="__has_navigator_property",r=!1;try{r=!!(e in window.navigator)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.__has_css_support_for=function(e){var i="__has_css_support_for",r=!1;try{var n=document.documentElement.style,s=["Khtml","Ms","O","Moz","Webkit"],a=s.length;if(e in n)r=!0;else for(e=e.replace(/^[a-z]/,function(e){return e.toUpperCase()});a--;)if(s[a]+e in n){r=!0;break}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.__detect_html_audio_support=function(){var e="__detect_html_audio_support",i=null;try{var r=document.createElement("audio"),n=!(!r.canPlayType||!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/no/,"")),s=!(!r.canPlayType||!r.canPlayType('audio/mp4; codecs="mp4a.40.2"').replace(/no/,"")),a=!(!r.canPlayType||!r.canPlayType("audio/mpeg;").replace(/no/,""));n===!0?i="oga":s===!0?i="m4a":a===!0&&(i="mp3")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}finally{return i}},e}());var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.Action=new(function(){function e(){var e="constructor";try{this.ns="CrispAction",this._events=["session:loaded","chat:initiated","chat:opened","chat:closed","message:sent","message:received","message:compose:sent","message:compose:received","user:email:changed","user:phone:changed","user:nickname:changed","user:avatar:changed","website:availability:changed"],this.__session_data_key=/^([A-Za-z0-9_\\-]+)$/,this.__event_register={}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.do_chat_open=function(){t.Chat._is_initialized===!0?t.Chat.Interface._maximize():t.Minimized.Interface._pane_open_handler()},e.prototype.do_chat_close=function(){t.Chat._is_initialized===!0&&t.Chat.Interface._minimize()},e.prototype.do_chat_toggle=function(){this.is_chat_closed()===!0?this.do_chat_open():this.do_chat_close()},e.prototype.do_chat_show=function(){this.is_chat_hidden()===!0&&null!==t.Base._container_sel&&(t.Base._container_sel.safe_css_text(null),t.Chat.Interface._apply_dynamic_sizing_properties())},e.prototype.do_chat_hide=function(){this.is_chat_visible()===!0&&null!==t.Base._container_sel&&t.Base._container_sel.safe_css_text("display","none")},e.prototype.do_message_send=function(e,i){var r=this.__generate_message(e,i);if(null!==r.type&&null!==r.content){switch(r.type){case"text":t.Library.crisp.client.Message.send_text_message(r.content);break;case"file":t.Library.crisp.client.Message.send_file_message(r.content.name,r.content.url,r.content.type);break;case"animation":t.Library.crisp.client.Message.send_animation_message(r.content.url,r.content.type)}t.Chat._start_maximized(),t.Chat.Message._mark_has_exchanged_messages()}},e.prototype.do_message_show=function(e,i){var r=this.__generate_message(e,i);null!==r.type&&null!==r.content&&t.Chat.Message._dispatch_local(r.type,r.content)},e.prototype.do_session_reset=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.Library.crisp.client.Session.clear(),e!==!1&&document.location.reload(!1)},e.prototype.do_trigger_run=function(e){if(t.Trigger._run(e)!==!0)throw new Error("Trigger does not exist")},e.prototype.is_chat_opened=function(){return!(t.Chat.Interface._is_maximized!==!0||t.Chat._is_initialized!==!0)},e.prototype.is_chat_closed=function(){return this.is_chat_opened()===!1&&!0},e.prototype.is_chat_visible=function(){return this.is_chat_hidden()===!1&&!0},e.prototype.is_chat_hidden=function(){return(null===t.Base._container_sel||"none"===t.Base._container_sel.css("display"))&&!0},e.prototype.is_chat_small=function(){return t.Base._is_full_view()===!1&&!0},e.prototype.is_chat_large=function(){return this.is_chat_small()===!1&&!0},e.prototype.is_website_available=function(){return t.Availability._users_available&&!0},e.prototype.get_chat_unread_count=function(){return t.Chat.Notification._unread_count||0},e.prototype.get_message_text=function(){return t.Chat.Selector.get("form_textarea_message").val()||""},e.prototype.get_session_identifier=function(){return t.Broker._session_id||null},e.prototype.get_session_data=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t.Library.crisp.client.Session.get_data(e)||null},e.prototype.get_user_email=function(){return t.Library.crisp.client.Session.get_email()||null},e.prototype.get_user_phone=function(){return t.Library.crisp.client.Session.get_phone()||null},e.prototype.get_user_nickname=function(){return t.Library.crisp.client.Session.get_nickname()||null},e.prototype.get_user_avatar=function(){return t.Library.crisp.client.Session.get_avatar()||null},e.prototype.set_message_text=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if("string"!=typeof e)throw new Error("Invalid message text");var i=t.Chat.Selector.get("form_textarea_message");i&&(i.val(e),i.trigger("keypress"))},e.prototype.set_session_data=function(e,i){if("string"!=typeof e||this.__session_data_key.test(e)!==!0)throw new Error("Invalid data key");if("string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i)throw new Error("Invalid data value");t.Library.crisp.client.Session.set_data(e,i)},e.prototype.set_session_segments=function(e){if(!(e instanceof Array))throw new Error("Invalid segments value");t.Library.crisp.client.Session.set_segments(e)},e.prototype.set_user_email=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!e||!t.Validate.is_email(e))throw new Error("Invalid email");t.Library.crisp.client.Session.set_email(e),t.Chat._is_initialized===!0&&t.Chat.Alert._update({email_form:"lock",wait_reply:"show"}),this._event("user:email:changed",e)},e.prototype.set_user_phone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if("number"==typeof e&&(e=""+e),!e||!t.Validate.is_phone(e))throw new Error("Invalid phone");t.Library.crisp.client.Session.set_phone(e),this._event("user:phone:changed",e)},e.prototype.set_user_nickname=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if("string"!=typeof e||!e)throw new Error("Invalid nickname");t.Library.crisp.client.Session.set_nickname(e),this._event("user:nickname:changed",e)},e.prototype.set_user_avatar=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!e||!t.Validate.is_avatar(e))throw new Error("Invalid avatar");t.Library.crisp.client.Session.set_avatar(e),this._event("user:avatar:changed",e)},e.prototype.config_availability_tooltip=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.Base._update_configuration("availability_tooltip",e)},e.prototype.config_hide_on_away=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.Base._update_configuration("hide_on_away",e)},e.prototype.config_position_reverse=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.Base._update_configuration("position_reverse",e)},e.prototype._on_event=function(e,t){if("function"!=typeof t)throw new Error("Handler must be a function");this.__event_register[e]=t},e.prototype._off_event=function(e){"undefined"!=typeof this.__event_register[e]&&delete this.__event_register[e]},e.prototype._event=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(this._events.indexOf(e)===-1)throw new Error("Event namespace not recognized: "+e);if("function"==typeof this.__event_register[e])try{this.__event_register[e].apply(window,t instanceof Array?t:"undefined"!=typeof t?[t]:[])}catch(e){}},e.prototype._unstack_pending=function(){var e="_unstack_pending";try{var i=t.Base._dollar_crisp.__spool.pending_actions;if(i&&i.length>0){for(var r=0;r<i.length;r++)try{t.Pipeline.push(i[r])}catch(e){}t.Library.logger.info(this.ns+"."+e,"Unstacked "+i.length+" pending actions"),delete t.Base._dollar_crisp.__spool.pending_actions}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__generate_message=function(e,t){var r={type:null,content:null};switch(e){case"text":if("string"!=typeof t||!t)throw new Error("Invalid text message");r.type="text",r.content=t;break;case"file":if("object"!==("undefined"==typeof t?"undefined":i(t))||!t.name||!t.url||!t.type)throw new Error("Invalid file message");r.type="file",r.content={name:t.name,url:t.url,type:t.type};break;case"animation":if("object"!==("undefined"==typeof t?"undefined":i(t))||!t.url||!t.type)throw new Error("Invalid animation message");r.type="animation",r.content={url:t.url,type:t.type}}return r},e}()),t.Pipeline=new(function(){function e(){var e="constructor";try{this.ns="CrispPipeline",this.__safe_mode=!1}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.push=function(e){e[0]&&e[1]&&"function"==typeof this[e[0]]&&this[e[0]](e[1],e[2]||[])},e.prototype.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.__pipe_target("get",e,this.__args(t))},e.prototype.set=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.__pipe_target("set",e,this.__args(t))},e.prototype.is=function(e){return this.__pipe_target("is",e)},e.prototype.do=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.__pipe_target("do",e,this.__args(t))},e.prototype.on=function(e,t){return this.__pipe_event("on",e,[e,t])},e.prototype.off=function(e){return this.__pipe_event("off",e,[e])},e.prototype.config=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.__pipe_target("config",e,this.__args(t))},e.prototype.safe=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("boolean"!=typeof e)throw new Error("Safe mode value must be 'true' or 'false'.");this.__safe_mode=e},e.prototype.help=function(){var e=[];for(var i in t.Action)"_"!==i[0]&&"function"==typeof t.Action[i]&&e.push("$crisp."+i.replace("_","('").replace(/_/g,":")+"')");for(var r=["on","off"],n=0;n<r.length;n++)for(var s=0;s<t.Action._events.length;s++)e.push("$crisp."+r[n]+"('"+t.Action._events[s]+"')");return e},e.prototype.__args=function(e){return e?e instanceof Array?e:[e]:[]},e.prototype.__pipe_target=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];try{var n=e+"_"+(i||"").replace(/:/g,"_");if("function"==typeof t.Action[n])return t.Action[n].apply(t.Action,r);this.__namespace_error(i)}catch(e){if(this.__safe_mode!==!0)throw e}},e.prototype.__pipe_event=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];try{var n="_"+e+"_event";if("function"!=typeof t.Action[n])throw new Error("No such event method for action: "+e);if(t.Action._events.indexOf(i)!==-1)return t.Action[n].apply(t.Action,r);this.__namespace_error(i)}catch(e){if(this.__safe_mode!==!0)throw e}},e.prototype.__namespace_error=function(e){throw new Error("No such namespace: "+e+" - Call $crisp.help() for a list of available actions.")},e}()),t.Validate=new(function(){function e(){var e="constructor";try{this.ns="CrispValidate",this.__email_regex=/^(([^\s@]+)@([^\s@]+)\.([^\s@]+))$/,this.__phone_regex=new RegExp(["^(?:(?:\\(?(?:00|\\+)([1-4]\\d\\d|[1-9]\\d?)\\)?)?","[\\-\\.\\ \\\\\\/]?)?((?:\\(?\\d{1,}\\)?[\\-\\.\\ \\\\\\/]?){0,})","(?:[\\-\\.\\ \\\\\\/]?(?:#|ext\\.?|extension|x)[\\-\\.\\ \\\\/]?","(\\d+))?$"].join(""),"i"),this.__avatar_regex=/^https?:\/\/(.+)$/}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.is_email=function(e){var i="is_email",r=!1;try{e.match(this.__email_regex)&&(r=!0)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.is_phone=function(e){var i="is_phone",r=!1;try{e.match(this.__phone_regex)&&(r=!0)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.is_avatar=function(e){var i="is_avatar",r=!1;try{e.match(this.__avatar_regex)&&(r=!0)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e}()),t.Date=new(function(){function e(){var e="constructor";try{this.ns="CrispDate",this.__watch_interval=15,this.__days_map=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],this.__months_map=["january","february","march","april","may","june","july","august","september","october","november","december"],this.__second_in_milliseconds=1e3,this.__minutes_in_hour=60,this.__hours_in_day=24,this.__seconds_in_minute=60,this.__seconds_in_hour=this.__minutes_in_hour*this.__seconds_in_minute,this.__seconds_in_day=this.__hours_in_day*this.__seconds_in_hour}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.timestamp_to_iso=function(e){var i="timestamp_to_iso";try{return new Date(e).toISOString()}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.iso_to_timestamp=function(e){var i="iso_to_timestamp";try{return new Date(e).getTime()}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.timestamp_to_properties=function(e){var i="timestamp_to_properties",r={day:null,month:null,year:null,title:null};try{if(e>0){var n=new Date(e),s=t.Locale.text("days",this.__days_map[n.getDay()]),a=t.Locale.text("months",this.__months_map[n.getMonth()]);r.day=""+n.getDate(),r.month=""+(n.getMonth()+1),r.year=""+n.getFullYear(),r.title=s+", "+n.getDate()+" "+a,(new Date).getYear()!==n.getYear()&&(r.title+=" ("+r.year+")")}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.seconds_in_timestamp=function(e){var i="seconds_in_timestamp",r=0;try{if(isNaN(e))throw new Error("Timestamp is not a number");r=Math.floor(parseInt(e,10)/this.__second_in_milliseconds)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.now=function(){var e="now";try{return(new Date).toISOString()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.timestamp=function(){var e="timestamp";try{return(new Date).getTime()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.difference=function(e,i){var r="difference",n=-1;try{var s=this.iso_to_timestamp(e),a=this.iso_to_timestamp(i);n=s-a}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e.prototype.equal=function(e,i){var r="equal",n=!1;try{n=0===this.difference(e,i)&&!0}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e.prototype.format_date=function(e){var i="format_date",r=null;try{var n=new Date,s=new Date(e),a=n.getTime()-s.getTime(),o=this.__render_select(a);o.type||(o.type="far_away",o.data={date_full:s.toLocaleDateString()});var c=t.Library.dom(t.Template.render("date_"+o.type,o.data));if(r=c.text(),!r)throw new Error("Empty parsed date for ISO string: "+e)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.format_duration=function(e){var i="format_duration",r=null;try{var n=this.__render_select(e);n.type||(n.type="days");var s=t.Library.dom(t.Template.render("duration_"+n.type,n.data));if(r=s.text(),!r)throw new Error("Empty parsed duration for duration: "+e)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.watch=function(){var e=this,i="watch";try{t.Library.logger.debug(this.ns+"."+i,"Watch trigger scheduled in "+this.__watch_interval+" seconds"),setTimeout(function(){try{null!==t.Base._container_sel&&(t.Base._container_sel.find('[data-date-iso][data-date-watch="true"]').each(function(i,r,n){var s=n.eq(r),a=s.attr("data-date-iso"),o=s.attr("data-date-format"),c=e.format_date(a);o&&(c=t.Library.crisp.web.Parse.replace(o,[c.toLowerCase()])),s.text(c)}),t.Library.logger.debug(e.ns+"."+i,"Updated dates and durations in DOM"),e.watch())}catch(r){t.Library.logger.error(e.ns+"."+i+":timeout",r)}},this.__watch_interval*this.__second_in_milliseconds)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__render_select=function(e){var i="__render_select",r={};try{var n=Math.round(e/this.__second_in_milliseconds);n<10?r.type="now":n<this.__seconds_in_minute?r.type="seconds":n<this.__seconds_in_hour?(r.type="minutes",r.data={minutes:Math.floor(n/this.__seconds_in_minute)}):n<this.__seconds_in_day&&(r.type="hours",r.data={hours:Math.floor(n/this.__seconds_in_hour)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e}()),t.Theme=new(function(){function e(){var e="constructor";try{this.ns="CrispTheme",this.__color_hex_regex=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,this.__color_hex_to_number_base=16,this.__default_color="default",this.__available_colors={default:{10:"#f5f8fb",100:"#bbdefb",200:"#a6c5db",300:"#6193bc",500:"#298ee8",700:"#2e88d3",800:"#288ade",900:"#2271b3",reverse:"#ffffff"},red:{10:"#fafafa",100:"#ffcdd2",200:"#a6c5db",300:"#a46a6a",500:"#f44336",700:"#d32f2f",800:"#e33e32",900:"#b71c1c",reverse:"#ffffff"},pink:{10:"#fafafa",100:"#f8bbd0",200:"#a6c5db",300:"#b66a84",500:"#e91e63",700:"#c2185b",800:"#da1457",900:"#880e4f",reverse:"#ffffff"},purple:{10:"#fafafa",100:"#e1bee7",200:"#a6c5db",300:"#937099",500:"#9c27b0",700:"#7b1fa2",800:"#9121a4",900:"#4a148c",reverse:"#ffffff"},deep_purple:{10:"#fafafa",100:"#d1c4e9",200:"#a6c5db",300:"#786699",500:"#673ab7",700:"#512da8",800:"#6336b3",900:"#311b92",reverse:"#ffffff"},indigo:{10:"#fafafa",100:"#c5cae9",200:"#a6c5db",300:"#697099",500:"#3f51b5",700:"#303f9f",800:"#394aaa",900:"#1a237e",reverse:"#ffffff"},blue:{10:"#f5f8fb",100:"#bbdefb",200:"#a6c5db",300:"#6193bc",500:"#298ee8",700:"#2e88d3",800:"#288ade",900:"#2271b3",reverse:"#ffffff"},light_blue:{10:"#fafafa",100:"#b3e5fc",200:"#a6c5db",300:"#628da1",500:"#07a6ed",700:"#0288d1",800:"#069fe4",900:"#01579b",reverse:"#ffffff"},cyan:{10:"#fafafa",100:"#b2ebf2",200:"#a6c5db",300:"#6ca7ae",500:"#00adc3",700:"#0093a3",800:"#00a1b6",900:"#006064",reverse:"#ffffff"},teal:{10:"#fafafa",100:"#b2dfdb",200:"#a6c5db",300:"#638c88",500:"#009688",700:"#00796b",800:"#018a7d",900:"#004d40",reverse:"#ffffff"},green:{10:"#fafafa",100:"#c8e6c9",200:"#a6c5db",300:"#719873",500:"#4caf50",700:"#388e3c",800:"#47a74b",900:"#1b5e20",reverse:"#ffffff"},light_green:{10:"#fafafa",100:"#dcedc8",200:"#a6c5db",300:"#839a68",500:"#84bc44",700:"#689f38",800:"#80b840",900:"#407f28",reverse:"#ffffff"},amber:{10:"#fafafa",100:"#ffecb3",200:"#a6c5db",300:"#8a7b4e",500:"#e8b10c",700:"#e69308",800:"#e3ad0c",900:"#ed7112",reverse:"#ffffff"},orange:{10:"#fafafa",100:"#ffe0b2",200:"#a6c5db",300:"#bf9b64",500:"#ff9800",700:"#f57c00",800:"#f59302",900:"#e65100",reverse:"#ffffff"},deep_orange:{10:"#fafafa",100:"#ffccbc",200:"#a6c5db",300:"#ad8073",500:"#ff5722",700:"#e64a19",800:"#ec4c1a",900:"#bf360c",reverse:"#ffffff"},brown:{10:"#fafafa",100:"#d7ccc8",200:"#a6c5db",300:"#8a695e",500:"#795548",700:"#5d4037",800:"#6b4a40",900:"#3e2723",reverse:"#ffffff"},grey:{10:"#fafafa",100:"#757575",200:"#a6c5db",300:"#635d5d",500:"#7d7d7d",700:"#616161",800:"#767676",900:"#4d4d4d",reverse:"#ffffff"},blue_grey:{10:"#fafafa",100:"#cfd8dc",200:"#a6c5db",300:"#7f949f",500:"#607d8b",700:"#455a64",800:"#516771",900:"#263238",reverse:"#ffffff"},black:{10:"#fafafa",100:"#757575",200:"#a6c5db",300:"#3c3c3c",500:"#282828",700:"#252525",800:"#202020",900:"#161616",reverse:"#ffffff"}}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.colors=function(){var e="colors",i={};try{var r=void 0,n=void 0;r=t.Plugin.get_customization("color","chatbox"),n=this.__available_colors[t.Base._website_configuration.chat.theme]||this.__available_colors[this.__default_color],this.__filter_colors_map_with_defaults(r,n);for(var s in r)i[s]={hex:r[s],rgba:this.__generate_color_rgba.__crisp_bind(this,r[s])}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}finally{return i}},e.prototype.__filter_colors_map_with_defaults=function(e,i){var r="__filter_colors_map_with_defaults";try{for(var n in i)e[n]||(e[n]=i[n])}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__generate_color_rgba=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r="__generate_color_rgba",n="rgba(0, 0, 0, 1)";try{var s=[0,0,0],a=e.match(this.__color_hex_regex);a&&(s[0]=parseInt(a[1],this.__color_hex_to_number_base),s[1]=parseInt(a[2],this.__color_hex_to_number_base),s[2]=parseInt(a[3],this.__color_hex_to_number_base)),n="rgba("+(s[0]+", ")+(s[1]+", ")+(s[2]+", ")+(""+i)+")"}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e}()),t.Plugin=new(function(){function e(){
var e="constructor";try{this.ns="CrispPlugin"}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.get_triggers=function(){var e="get_triggers",i={};try{i=(((t.Base._website_configuration.plugins||{})["urn:crisp.im:triggers:0"]||{}).settings||{}).triggers||{}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}finally{return i}},e.prototype.get_customization=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n="get_customization",s=null;try{s=((((t.Base._website_configuration.plugins||{})["urn:crisp.im:customization:0"]||{}).settings||{})[e]||{})[i]||{},r&&(s=s[r]||null)}catch(e){t.Library.logger.error(this.ns+"."+n,e)}finally{return s}},e}()),t.Sound=new(function(){function e(){var e="constructor";try{this.ns="CrispSound",this.__vibration_duration=200,this.__is_playback_allowed=!0,this.__active_subsets={}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.allow=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i="allow";try{this.__is_playback_allowed=e}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.initialize=function(e){var i=this,r="initialize";try{if(this.__is_playback_allowed===!1)return void t.Library.logger.warn(this.ns+"."+r,"Playback not allowed");if("undefined"==typeof this.__active_subsets[e]){var n=t.Feature.html_audio_format(),s=t.Library.dom(t.Template.render("sounds_"+e,{selected_format:n,url_assets:t.Base._url_assets,client_revision:t.Base._client_revision}));this.__active_subsets[e]={subset:s,names:{}},s.find(".crisp-51").each(function(t,r,n){var s=n.eq(r),a=s.attr("data-name");i.__active_subsets[e].names[a]=s}),t.Base._container_sel.append(s),t.Library.logger.debug(this.ns+"."+r,"Initialized subset "+e)}}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.start=function(e,i){var r="start";try{if(this.__is_playback_allowed===!1)return void t.Library.logger.warn(this.ns+"."+r,"Playback not allowed");if(t.Feature.has_device_vibrate()===!0&&window.navigator.vibrate(this.__vibration_duration),t.Feature.has_html_audio()===!0){this.initialize(e);var n=this.__active_subsets[e];if("undefined"==typeof n)throw new Error("Subset does not exist: "+e);var s=n.names[i];if("undefined"==typeof s)throw new Error("Sound does not exist: "+i+" in subset "+e);s[0].paused||s[0].pause(),0!==s[0].currentTime&&(s[0].currentTime=0),s[0].load(),s[0].play(),t.Library.logger.debug(this.ns+"."+r,"Started sound named "+i+" in subset "+e)}}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.stop=function(e,i){var r="stop";try{if(this.__is_playback_allowed===!1)return void t.Library.logger.warn(this.ns+"."+r,"Playback not allowed");if(t.Feature.has_html_audio()===!0){var n=this.__active_subsets[e];if("undefined"==typeof n)throw new Error("Subset does not exist: "+e);var s=n.names[i];if("undefined"==typeof s)throw new Error("Sound does not exist: "+i+" in subset "+e);s[0].paused||(s[0].pause(),0!==s[0].currentTime&&(s[0].currentTime=0),t.Library.logger.debug(this.ns+"."+r,"Stopped sound named "+i+" in subset "+e))}}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__is_supported=function(){var e="__is_supported";try{return t.Feature.has_html_audio()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}());var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.Locale=new(function(){function e(){var e="constructor";try{this.ns="CrispLocale",this.__default_locale="en",this.__available_locales=["ar","az","bg","bn","cs","da","de","el","en","eo","es","fa","fi","fr","he","hi","hr","hu","id","is","it","ja","ko","lt","lv","ml","ms","nl","no","pl","pt-br","pt-pt","ro","ru","sk","sr-cyrl-cs","sr","sv","ta","th","tr","uk","vi","zh-tw","zh"],this.__allowed_locales=this.__available_locales,this.__data=null}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.detect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i="detect",r=this.__default_locale;try{var n=void 0,s=void 0,a=!1,o=[],c=[];if(e.length&&(this.__allowed_locales=t.Utility.intersect(e,this.__available_locales),this.__allowed_locales.length>0&&this.__allowed_locales.indexOf(r)===-1&&(r=this.__default_locale=this.__allowed_locales[0])),o=navigator.languages&&navigator.languages.length>0?navigator.languages:[],0===o.length){var _=navigator.language||navigator.userLanguage;_&&o.push(_)}for(n=0;n<o.length;n++)s=o[n],s&&(c.push(s.toLowerCase()),s.indexOf("-")!==-1&&(s=s.split("-")[0],s&&c.push(s.toLowerCase())));for(n=0;n<c.length;n++)if(this.__allowed_locales.indexOf(c[n])!==-1){r=c[n],a=!0;break}a===!0?t.Library.logger.info(this.ns+"."+i,"Detected user language: "+r):t.Library.logger.warn(this.ns+"."+i,"No user language supported, fallback to default: "+r)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.load=function(e,i){var r=this,n="load";try{var s=e;this.__allowed_locales.indexOf(e)===-1&&(s=this.__default_locale,t.Library.logger.warn(this.ns+"."+n,"Unsupported locale requested: "+e)),null===this.__data?(t.Library.logger.debug(this.ns+"."+n,"Loading locale: "+s+"..."),t.Base._load_dependency("locale","locales/"+s+".js",function(e){try{r.__handle_locale_injection(s,e,i)}catch(e){t.Library.logger.error(r.ns+"."+n+":load",e)}})):t.Library.logger.warn(this.ns+"."+n,"Locale already loaded")}catch(e){t.Library.logger.error(this.ns+"."+n,e)}},e.prototype.name=function(){var e="name",i=null;try{if(null===this.__data)throw new Error("Cannot get locale name, locale data not loaded");i=this.__data._meta.locale_name}catch(i){t.Library.logger.error(this.ns+"."+e,i)}finally{return i}},e.prototype.code=function(){var e="code",i=null;try{if(null===this.__data)throw new Error("Cannot get locale code, locale data not loaded");i=this.__data._meta.locale_code}catch(i){t.Library.logger.error(this.ns+"."+e,i)}finally{return i}},e.prototype.direction=function(){var e="direction",i=null;try{if(null===this.__data)throw new Error("Cannot get locale direction, locale data not loaded");i=this.__data._meta.locale_direction}catch(i){t.Library.logger.error(this.ns+"."+e,i)}finally{return i}},e.prototype.text=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s="text",a=null;try{var o=void 0,c=void 0;if("object"===("undefined"==typeof r?"undefined":i(r))?(o=r[0],c=r[1]):o=c=r,null===this.__data)throw new Error("Cannot get locale text, locale data not loaded");if("undefined"==typeof this.__data._strings[e])throw new Error("Locale text group not found: "+e);if("undefined"==typeof this.__data._strings[e][c])throw new Error("Locale text namespace not found in group: "+(c+" in "+e));a=t.Plugin.get_customization("text",e,o)||this.__data._strings[e][c],a=t.Library.crisp.web.Parse.replace(a,n),a=this.__convert_to_iso(a)}catch(e){t.Library.logger.error(this.ns+"."+s,e)}finally{return a}},e.prototype.__handle_locale_injection=function(e,r,n){var s="__handle_locale_injection",a=null;try{if(null!==this.__data)throw new Error("Locale has already been loaded (double requested handled?)");if("object"!==("undefined"==typeof r?"undefined":i(r)))throw new Error("Did not receive a proper locale data file");if(r._meta.locale_code!==e)throw new Error("Received a mismatching locale code, expected: "+e);t.Library.logger.debug(this.ns+"."+s,"Done loading locale: "+e),this.__data=r,"function"==typeof n&&n()}catch(e){t.Library.logger.error(this.ns+"."+s,e)}finally{return a}},e.prototype.__convert_to_iso=function(e){var i="__convert_to_iso",r=null;try{try{r=decodeURIComponent(escape(e))}catch(t){r=e}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e}()),t.Avatar=new(function(){function e(){var e="constructor";try{this.ns="CrispAvatar",this.__active_operators_maximum=3}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.url=function(e,i,r,n){var s="url",a="";try{a=n?t.Base._url_image+"/process/thumbnail/?url="+encodeURIComponent(n)+("&width="+e+"&height="+e)+("&"+t.Base._website_configuration.website.avatar_buster):t.Base._url_image+"/avatar/"+i+"/"+((r||"default")+"/"+e+"/")+("?"+t.Base._website_configuration.website.avatar_buster)}catch(e){t.Library.logger.error(this.ns+"."+s,e)}finally{return a}},e.prototype.active_operators=function(e,i){var r="active_operators",n=[];try{var s=i.website.active_operators;if(s.length>0)for(var a=0;a<s.length;a++)a<this.__active_operators_maximum&&n.push({type:"operator",identifier:s[a].user_id,avatar:s[a].avatar,name:t.Library.crisp.web.Name.parse_first_name(s[a].nickname)});else n.push({type:"website",identifier:e,name:i.website.name})}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e}());var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.Template=new(function(){function e(){var e="constructor";try{this.ns="CrispTemplate"}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.render=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="render",s="";try{if("function"!=typeof t.Library.jade.client[e])throw new Error("No such template: "+e);if("object"!==("undefined"==typeof r?"undefined":i(r)))throw new Error("Object argument is not an object");r._e=t.Locale.text.__crisp_bind(t.Locale),r._f=t.Library.crisp.web.Parse.format.__crisp_bind(t.Library.crisp.web.Parse),r._n=t.Library.crisp.web.Name.parse_first_name.__crisp_bind(t.Library.crisp.web.Name),r._a=t.Avatar.url.__crisp_bind(t.Avatar),s=t.Library.jade.client[e](r).trim(),t.Library.logger.debug(this.ns+"."+n,"Generated template for: "+e)}catch(e){t.Library.logger.error(this.ns+"."+n,e)}finally{return s}},e}()),t.Broker=new(function(){function e(){var e="constructor";try{this.ns="CrispBroker",this.__maximum_session_create_retry=1,this._default_session_configuration={chat:{locale:"en",theme:"default",theme_text:"default",theme_welcome:"default",tile:"default",blocked_pages:[],blocked_locales:[],last_operator_face:!1,activity_metrics:!0,availability_tooltip:!0,hide_on_away:!1,position_reverse:!1,email_visitors:!0,force_identify:!1,ignore_privacy:!1},website:{name:"",domain:"",avatar_buster:1,active_operators:[]},plugins:[]},this.__domain_regex=/^(?:https?:[\/]*)?([^\/]+)(?:\/.*)?$/i,this._session_id=null,this.__newly_created_session=!1,this.__newly_joined_session=!0,this.__initialization_sequence_step=0,this.__count_session_create_retry=0,this.__response_ids_spool={}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(e,i,r,n,s,a,o,c,_,l,p,h){var u="init";try{t.Library.logger.debug(this.ns+"."+u,"Initialize"),t.Library.crisp.client.init({environment:e,url_relay:i,url_go:r,website_domain:n,website_id:s,token_id:a,page_url:o,page_title:c,page_referrer:_,useragent:l,timezone:p,locales:h}),this.__event_session_created(),this.__event_session_joined(),this.__event_session_state(),this.__event_session_error(),this.__event_session_request_initiate(),this.__event_website_users_available(),this.__event_message_received(),this.__event_message_received_local(),this.__event_message_send(),this.__event_message_sent(),this.__event_message_compose_received(),this.__event_message_compose_send(),this.__event_message_acknowledge_pending(),this.__event_message_acknowledge_read_send(),this.__event_message_acknowledge_read_received(),this.__event_history_message_received(),this.__event_history_message_sent(),this.__event_browsing_request_initiate(),this.__event_bucket_url_upload_generate(),this.__event_bucket_url_upload_generated(),this.__event_media_animation_list(),this.__event_media_animation_listed(),this.__event_storage_sync_update(),this.__event_storage_sync_updated(),this.__event_issue_report()}catch(e){t.Library.logger.error(this.ns+"."+u,e)}},e.prototype.__event_session_created=function(){var e=this,i="__event_session_created";try{t.Library.crisp.client.event.subscribe("session:created",function(r,n){t.Library.logger.info(e.ns+"."+i+":event",n),n.error?(t.Library.logger.warn(e.ns+"."+i+":event","Session could not be created from server"),"invalid_website_id"===n.error&&t.Locale.load(e._default_session_configuration.chat.locale,function(){t.Base.spawn_client(e._default_session_configuration),t.Minimized.init(is_initial=!1,is_unauthorized=!0)})):n.session_id?e.__newly_created_session=!0:t.Library.logger.error(e.ns+"."+i+":event","Unrecognized session creation error")})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_session_joined=function(){var e=this,i="__event_session_joined";try{t.Library.crisp.client.event.subscribe("session:joined",function(r,n){if(t.Library.logger.debug(e.ns+"."+i+":event",n),n.error)t.Library.logger.warn(e.ns+"."+i+":event","Session could not be joined from server"),"invalid_session"===n.error&&(++e.__count_session_create_retry<=e.__maximum_session_create_retry?(t.Library.logger.info(e.ns+"."+i+":event","Flushing local session..."),t.Library.crisp.client.Session.clear(function(){t.Library.logger.info(e.ns+"."+i+":event","Flushed local session, trying to create a new one..."),t.Library.crisp.client.Session.create()},function(){t.Library.logger.warn(e.ns+"."+i+":event","Error flushing local session")})):t.Library.logger.warn(e.ns+"."+i+":event","Not flushing local session (retries limit reached)"));else if(e._session_id=n.session_id||null,e.__newly_joined_session===!0){e.__newly_joined_session=!1;var s={website:{name:n.website||"",domain:t.Utility.extract(e.__domain_regex,n.domain,t.Base._website_domain,1),avatar_buster:n.avatar_buster||1,active_operators:n.active_operators||[],response_metrics:n.response_metrics||{}},plugins:n.plugins,chat:{locale:t.Locale.detect(n.settings.locale?[n.settings.locale]:[]),theme:n.settings.color_theme||"default",blocked_pages:n.settings.blocked_pages||[],blocked_locales:n.settings.blocked_locales||[],tile:"string"==typeof n.settings.tile?n.settings.tile:"default",last_operator_face:"boolean"==typeof n.settings.last_operator_face&&n.settings.last_operator_face,activity_metrics:"boolean"!=typeof n.settings.activity_metrics||n.settings.activity_metrics,availability_tooltip:"boolean"!=typeof n.settings.availability_tooltip||n.settings.availability_tooltip,hide_on_away:"boolean"==typeof n.settings.hide_on_away&&n.settings.hide_on_away,position_reverse:"boolean"==typeof n.settings.position_reverse&&n.settings.position_reverse,email_visitors:"boolean"!=typeof n.settings.email_visitors||n.settings.email_visitors,force_identify:"boolean"==typeof n.settings.force_identify&&n.settings.force_identify,ignore_privacy:"boolean"==typeof n.settings.ignore_privacy&&n.settings.ignore_privacy,theme_text:n.settings.text_theme||"default",theme_welcome:n.settings.welcome_message||"default"}};t.Locale.load(s.chat.locale,function(){t.Base.spawn_client(s),t.Library.crisp.client.Website.get_users_available()})}else t.Library.logger.warn(e.ns+"."+i,"Recovered session from network reconnect, not joining it again")})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_session_state=function(){var e=this,i="__event_session_state";try{t.Library.crisp.client.event.subscribe("session:state",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),1===e.__initialization_sequence_step&&(e.__initialization_sequence_step++,t.Library.logger.info(e.ns+"."+i+":event","Initialization sequence finished")),t.Chat._is_initialized===!1?(t.Utility.is_empty(n)?(t.Minimized.init(is_initial=e.__newly_created_session),t.Library.crisp.client.Session.get_request_initiate()):t.Chat.init(n=n),t.Base._trigger_session_loaded()):t.Chat._is_initialized===!0&&t.Chat.State.receive(n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_session_error=function(){var e=this,i="__event_session_error";try{t.Library.crisp.client.event.subscribe("session:error",function(r,n){switch(t.Library.logger.debug(e.ns+"."+i+":event",r,n),n.type){case"email:invalid_format":case"email:domain_not_found":t.Chat.Selector.get("alerts_email_form_input").val(n.value),t.Chat.Selector.get("alerts_email_form").attr("data-error","true"),t.Chat.Alert._update({warn_reply:"hide",wait_reply:"hide",email_invalid:"show"});break;default:t.Library.logger.warn(e.ns+"."+i+":event","Got an unrecognized session error type: "+n.type)}})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_session_request_initiate=function(){var e=this,i="__event_session_request_initiate";try{t.Library.crisp.client.event.subscribe("session:request:initiate",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_website_users_available=function(){var e=this,i="__event_website_users_available";try{t.Library.crisp.client.event.subscribe("website:users:available",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),t.Availability.receive(n),0===e.__initialization_sequence_step?(e.__initialization_sequence_step++,t.Library.crisp.client.Session.get_state()):t.Availability.apply()})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_message_received=function(){var e=this,i="__event_message_received";try{t.Library.crisp.client.event.subscribe("message:received",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),e.__handle_message_received(n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_message_received_local=function(){var e=this,i="__event_message_received_local";try{t.Library.crisp.client.event.subscribe("message:received:local",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),e.__handle_message_received(n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_message_send=function(){var e=this,i="__event_message_send";try{t.Library.crisp.client.event.subscribe("message:send",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),t.Chat._is_initialized===!0&&t.Chat.Message.sent(n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_message_sent=function(){var e=this,i="__event_message_sent";try{t.Library.crisp.client.event.subscribe("message:sent",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),t.Chat._is_initialized===!0&&t.Chat.Message.sent_acknowledgement(n),t.Action._event("message:sent",n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_message_compose_send=function(){var e=this,i="__event_message_compose_send";try{t.Library.crisp.client.event.subscribe("message:compose:send",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),t.Action._event("message:compose:sent",n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_message_acknowledge_pending=function(){var e=this,i="__event_message_acknowledge_pending";try{t.Library.crisp.client.event.subscribe("message:acknowledge:pending",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_message_acknowledge_read_send=function(){var e=this,i="__event_message_acknowledge_read_send";try{t.Library.crisp.client.event.subscribe("message:acknowledge:read:send",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),t.Chat.Message._acknowledge_read_send(n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_message_acknowledge_read_received=function(){var e=this,i="__event_message_acknowledge_read_received";try{t.Library.crisp.client.event.subscribe("message:acknowledge:read:received",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_message_compose_received=function(){var e=this,i="__event_message_compose_received";try{t.Library.crisp.client.event.subscribe("message:compose:received",function(r,n){if(t.Library.logger.debug(e.ns+"."+i+":event",n),t.Chat._is_initialized===!0)switch(n.type){case"start":t.Chat.Message._show_compose(n.timestamp);break;case"stop":t.Chat.Message._hide_compose()}t.Action._event("message:compose:received",n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_history_message_received=function(){var e=this,i="__event_history_message_received";try{t.Library.crisp.client.event.subscribe("history:message:received",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),t.Chat._is_initialized===!0&&t.Chat.Message.received_from_history(n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_history_message_sent=function(){var e=this,i="__event_history_message_sent";try{t.Library.crisp.client.event.subscribe("history:message:sent",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),t.Chat._is_initialized===!0&&t.Chat.Message.sent_from_history(n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_browsing_request_initiate=function(){var e=this,i="__event_browsing_request_initiate";try{t.Library.crisp.client.event.subscribe("browsing:request:initiate",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),t.Base._load_dependency("browsing","browsing.js",function(r){try{t.Library.crisp.client.Browsing.init({resume:n.resume||!1,deps:{tree_mirror:r.TreeMirrorClient}})}catch(r){t.Library.logger.error(e.ns+"."+i+":load",r)}})})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_bucket_url_upload_generate=function(){var e=this,i="__event_bucket_url_upload_generate";try{t.Library.crisp.client.event.subscribe("bucket:url:upload:generate",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),e.__response_ids_spool.bucket_url_upload_generate=n.id})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_bucket_url_upload_generated=function(){var e=this,i="__event_bucket_url_upload_generated";try{t.Library.crisp.client.event.subscribe("bucket:url:upload:generated",function(r,n){if(t.Library.logger.debug(e.ns+"."+i+":event",n),e.__response_ids_spool.bucket_url_upload_generate===n.id){var s=t.Chat.Selector.get("form_button_attach").attr("data-state");"preparing"===s?t.Chat.Selector.get("form_attach").attr("data-action",n.url.signed).attr("data-resource",n.url.resource).attr("data-size-limit",n.policy.size_limit).trigger("event:attach"):t.Library.logger.warn(e.ns+"."+i,"Dropped file upload trigger because state is already: "+s)}else t.Library.logger.warn(e.ns+"."+i,"Dropped file upload trigger because ID does not match with spool: "+n.id)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_media_animation_list=function(){var e=this,i="__event_media_animation_list";try{t.Library.crisp.client.event.subscribe("media:animation:list",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),e.__response_ids_spool.media_animation_list=n.id})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_media_animation_listed=function(){var e=this,i="__event_media_animation_listed";try{t.Library.crisp.client.event.subscribe("media:animation:listed",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n),e.__response_ids_spool.media_animation_list===n.id?t.Chat.Picker._handle_data_gif(n.results):t.Library.logger.warn(e.ns+"."+i,"Dropped media animation list because ID does not match with spool: "+n.id)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_storage_sync_update=function(){var e=this,i="__event_storage_sync_update";try{t.Library.crisp.client.event.subscribe("storage:sync:update",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_storage_sync_updated=function(){var e=this,i="__event_storage_sync_updated";try{t.Library.crisp.client.event.subscribe("storage:sync:updated",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__event_issue_report=function(){var e=this,i="__event_issue_report";try{t.Library.crisp.client.event.subscribe("issue:report",function(r,n){t.Library.logger.debug(e.ns+"."+i+":event",n)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__handle_message_received=function(e){var i="__handle_message_received";try{t.Chat._start_minimized();var r="network"===e.origin&&!0;t.Chat.Message.received(e,with_sounds=r,with_animations=r,with_exchanged=r,with_scroll=!0,is_locally_generated=!1),t.Action._event("message:received",e)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e}()),t.Availability=new(function(){function e(){var e="constructor";try{this.ns="CrispAvailability",this._users_available=!1,this._was_availability_online=!1}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.receive=function(e){var i="receive";try{this._users_available=e,t.Action._event("website:availability:changed",this._users_available),t.Library.logger.info(this.ns+"."+i,"Received new availability, stored changes: "+e)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.apply=function(){var e="apply";try{var i=this._users_available===!0?"online":"away";null!==t.Base._container_sel&&(t.Base._container_sel.attr("data-availability",i),this._was_availability_online===!1&&"online"===i&&(this._was_availability_online=!0,t.Base._container_sel.attr("data-was-availability-online","true"))),t.Library.logger.info(this.ns+"."+e,"Applied availability: "+this._users_available)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}()),t.Event=new(function(){function e(){var e="constructor";try{this.ns="CrispEvent",this.__inactivity_timeout=12e5,this.__is_inactive=!1,this.__inactivity_timeout_wait=null}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(e){var i="init";try{t.Library.logger.debug(this.ns+"."+i,"Initialize"),this.__bind()}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__bind=function(){var e="__bind";try{this.__bind_window_resize(),this.__bind_watch_activity()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__bind_window_resize=function(){var e=this,i="__bind_window_resize";try{window.addEventListener("resize",function(){try{t.Chat._is_initialized===!0?t.Chat.Interface._apply_dynamic_sizing_properties():t.Base._apply_sizing()}catch(r){t.Library.logger.error(e.ns+"."+i+":resize:self",r)}})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__bind_watch_activity=function(){var e="__bind_watch_activity";try{this.__become_active(),window.addEventListener("click",this.__become_active.__crisp_bind(this),!1),window.addEventListener("mousemove",this.__become_active.__crisp_bind(this),!1),window.addEventListener("keydown",this.__become_active.__crisp_bind(this),!1),window.addEventListener("focus",this.__become_active.__crisp_bind(this),!1),window.addEventListener("blur",this.__become_active.__crisp_bind(this),!1)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__become_active=function(){var e=this,i="__become_active";try{null!==this.__inactivity_timeout_wait&&clearTimeout(this.__inactivity_timeout_wait),this.__inactivity_timeout_wait=setTimeout(function(){e.__become_inactive()},this.__inactivity_timeout),this.__is_inactive===!0&&(t.Library.crisp.client.socket.connect(),t.Library.logger.warn(this.ns+"."+i,"Client became active, socket will connect again (resume network)")),this.__is_inactive=!1,t.Library.crisp.client.Session.mark_active()}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__become_inactive=function(){var e="__become_inactive";try{this.__is_inactive=!0,t.Library.crisp.client.socket.disconnect(),t.Library.logger.warn(this.ns+"."+e,"Client became inactive, socket will disconnect (pause network)")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}()),t.Trigger=new(function(){function e(){var e="constructor";try{this.ns="CrispTrigger",this.__second_in_milliseconds=1e3,this._processed=[],this.__triggers=null,this.__readiness_ensured=!1,this.__event_mouse_inside=!1,this.__event_mouse_defer=null,this.__event_mouse_top_margin=10}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(e){var i="init";try{t.Library.logger.debug(this.ns+"."+i,"Initialize"),this.__triggers=e,this.__listen()}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._run=function(e){var i="_run",r=!1;try{var n=(this.__triggers||{})[e];n&&n.enabled===!0&&(this.__actions(e,n),r=!0)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.__listen=function(){var e="__listen";try{var i=void 0,r=void 0,n=void 0,s=void 0;for(var a in this.__triggers)if(i=this.__triggers[a],i.enabled===!0){if(r=i.events)for(var o in r)n=r[o],n.enabled===!0?(s=this["__event_"+o],"function"==typeof s?(s.__crisp_bind(this)(a,i,r,n.settings||{}),t.Library.logger.info(this.ns+"."+e,"Attached "+o+" event listener for trigger: "+a)):t.Library.logger.error(this.ns+"."+e,"Did not attach "+o+" event listener for trigger: "+(a+" because: no such event listener"))):t.Library.logger.debug(this.ns+"."+e,"Did not attach "+o+" event listener for trigger: "+(a+" because: not enabled"));t.Library.logger.debug(this.ns+"."+e,"Processed trigger: "+a+" ("+i.name+")")}else t.Library.logger.debug(this.ns+"."+e,"Ignored trigger: "+a+" ("+i.name+") because: not enabled")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__actions=function(e,i){var r=this,n="__actions";try{if(this.__satisfy_preconditions(i)===!0){if(this._processed.indexOf(e)===-1){var s=t.Utility.clone(this._processed);s.push(e),this.__ensure_ready(),t.Chat.State.propagate("trigger",s,force=!1,function(s){if(s===!0&&r.__satisfy_preconditions(i)===!0){if(i.actions){var a=void 0,o=void 0;for(var c in i.actions)a=i.actions[c],a.enabled===!0?(o=r["__action_"+c],"function"==typeof o?(o.__crisp_bind(r)(e,a.settings||{}),t.Library.logger.info(r.ns+"."+n,"Executed "+c+" action for trigger: "+e)):t.Library.logger.error(r.ns+"."+n,"Did not execute "+c+" action for trigger: "+(e+" because: no such action processor"))):t.Library.logger.debug(r.ns+"."+n,"Did not execute "+c+" action for trigger: "+(e+" because: not enabled"))}t.Library.logger.debug(r.ns+"."+n,"Processed all actions for trigger: "+e+" "+("("+i.name+")"))}})}}else t.Library.logger.debug(this.ns+"."+n,"Did not process actions for trigger: "+e+" "+("("+i.name+") because: trigger actions bypassed"))}catch(e){t.Library.logger.error(this.ns+"."+n,e)}},e.prototype.__ensure_ready=function(){var e="__ensure_ready";try{this.__readiness_ensured!==!0&&(this.__readiness_ensured=!0,t.Chat._start_minimized())}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__satisfy_preconditions=function(e){var i="__satisfy_preconditions",r=!1;try{r=t.Base._is_invisible()===!1,this.__has_behavior(e,"if_website_online")===!0&&(r=t.Action.is_website_available()===!0&&r),this.__has_behavior(e,"if_trigger_sole")===!0&&(r=t.Chat.Message._has_messages!==!0&&r)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.__generate_settings_after=function(e){var i="__generate_settings_after",r=100;try{e&&e.after&&e.after>0&&(r=e.after*this.__second_in_milliseconds)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.__event_delay=function(e,i,r,n){var s=this,a="__event_delay";try{if(n.after&&n.after>0){var o=!1;for(var c in r)if("delay"!==c&&r[c].enabled===!0){o=!0;break}o===!1&&setTimeout(function(){s.__actions(e,i)},this.__generate_settings_after(n))}}catch(e){t.Library.logger.error(this.ns+"."+a,e)}},e.prototype.__event_leave=function(e,i,r,n){var s=this,a="__event_leave";try{window.addEventListener("mouseout",function(n){try{s.__event_mouse_inside===!0&&!n.relatedTarget&&!n.toElement&&n.clientY<=s.__event_mouse_top_margin&&(s.__event_mouse_inside=!1,
null===s.__event_mouse_defer&&(s.__event_mouse_defer=setTimeout(function(){s.__actions(e,i)},s.__generate_settings_after((r.delay||{}).settings))))}catch(e){t.Library.logger.error(s.ns+"."+a+":mouseout",e)}}),window.addEventListener("mouseover",function(){try{s.__event_mouse_inside!==!0&&(s.__event_mouse_inside=!0,null!==s.__event_mouse_defer&&(clearTimeout(s.__event_mouse_defer),s.__event_mouse_defer=null))}catch(e){t.Library.logger.error(s.ns+"."+a+":mouseover",e)}})}catch(e){t.Library.logger.error(this.ns+"."+a,e)}},e.prototype.__event_link=function(e,i,r,n){var s=this,a="__event_link";try{n.ids&&n.ids.length>0&&document.addEventListener("click",function(o){try{o&&o.target&&"a"===(o.target.nodeName||"").toLowerCase()&&n.ids.indexOf(o.target.id)!==-1&&setTimeout(function(){s.__actions(e,i)},s.__generate_settings_after((r.delay||{}).settings))}catch(e){t.Library.logger.error(s.ns+"."+a+":click",e)}})}catch(e){t.Library.logger.error(this.ns+"."+a,e)}},e.prototype.__event_page=function(e,i,r,n){var s=this,a="__event_page";try{if(n.urls&&n.urls.length>0){var o=t.Utility.compare_page_rules(t.Base._page_url,n.urls);o===!0&&setTimeout(function(){s.__actions(e,i)},this.__generate_settings_after((r.delay||{}).settings))}}catch(e){t.Library.logger.error(this.ns+"."+a,e)}},e.prototype.__action_message=function(e,i){var r="__action_message";try{if(i){var n=(i[t.Locale.code()]||i.default||"").trim();n&&t.Action.do_message_show("text",n)}}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__action_open=function(e,i){var r="__action_open";try{t.Action.do_chat_open()}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__action_sound=function(e,i){var r="__action_sound";try{t.Sound.start("events","chat-message-receive")}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__has_behavior=function(e,i){var r="__has_behavior",n=!1;try{((e.behaviors||{})[i]||{}).enabled===!0&&(n=!0)}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e}());var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.Base=new(function(){function e(){var e="constructor";try{this.ns="CrispBase",this._client_sel=null,this._container_sel=null,this.__full_view_width_threshold=560,this.__small_view_height_threshold=640,this.__large_view_height_threshold=780,this.__insert_check_every=1e3,this.__issue_report_interval_limit=1e4,this.__website_context_protocol="http:",this.__toggle_config_namespace_regex=/_/g,this._is_initialized=!1,this._website_configuration={},this._dollar_crisp=null,this._project_name=null,this._url_relay=null,this._url_website=null,this._url_go=null,this._url_image=null,this._url_assets=null,this._client_environment=null,this._client_revision=null,this._website_domain=null,this._website_id=null,this._token_id=null,this._page_url=null,this._page_title=null,this._page_referrer=null,this._browser_useragent=null,this._browser_timezone=null,this._browser_locales=null,this._is_blocked_page=!1,this._is_blocked_locale=!1,this._ready_trigger=null,this._runtime_configuration={},this.__issue_report_last_date=0}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(e){var i="init";try{this._is_initialized===!1?(t.Library.logger.debug(this.ns+"."+i,"Initialize"),this._dollar_crisp=e.dollar_crisp||null,this._project_name=e.project_name||null,this._url_relay=e.url_relay||null,this._url_website=e.url_website||null,this._url_go=e.url_go||null,this._url_image=e.url_image||null,this._url_assets=e.url_assets||null,this._client_environment=e.client_environment||null,this._client_revision=e.client_revision||null,this._website_domain=e.website_domain||null,this._website_id=e.website_id||null,this._token_id=e.token_id||null,this._page_url=e.page_url||null,this._page_title=e.page_title||null,this._page_referrer=e.page_referrer||null,this._browser_useragent=e.browser_useragent||null,this._browser_timezone=e.browser_timezone||null,this._browser_locales=e.browser_locales||null,this._ready_trigger=e.ready_trigger||null,this._runtime_configuration=e.runtime_configuration||{},t.Broker.init(this._client_environment,this._url_relay,this._url_go,this._website_domain,this._website_id,this._token_id,this._page_url,this._page_title,this._page_referrer,this._browser_useragent,this._browser_timezone,this._browser_locales),this.__configure_console_sink(),t.Event.init(),this._is_initialized=!0):t.Library.logger.warn(this.ns+"."+i,"Already initialized, not re-initializing")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.spawn_client=function(e){var i="spawn_client";try{if(null!==this._client_sel)throw new Error("Base client already spawned");var r=t.Locale.code();this._website_configuration=e,t.Library.crisp.web.init({template:t.Template,config:{url:{crisp_web:this._url_website,crisp_image:this._url_image},context:{name:this._website_configuration.website.name,domain:this._website_configuration.website.domain,protocol:this.__website_context_protocol},runtime:this._runtime_configuration}}),t.Library.crisp.client.Config.set_ignore_privacy(this._website_configuration.chat.ignore_privacy),t.Trigger.init(t.Plugin.get_triggers()),this._is_blocked_page=t.Utility.compare_page_rules(this._page_url,this._website_configuration.chat.blocked_pages)&&!0,this._is_blocked_locale=this._website_configuration.chat.blocked_locales.indexOf(r)!==-1&&!0||!1,this._client_sel=t.Library.dom(t.Template.render("client",{lang:r,direction:t.Locale.direction(),colors:t.Theme.colors(),position:t.Plugin.get_customization("position","chatbox"),blocked_page:this._is_blocked_page,blocked_locale:this._is_blocked_locale,lock_maximized:this._runtime_configuration.lock_maximized||!1,last_operator_face:this._website_configuration.chat.last_operator_face===!0&&this._website_configuration.website.active_operators.length>0,availability_tooltip:this._website_configuration.chat.availability_tooltip,hide_on_away:this._website_configuration.chat.hide_on_away,position_reverse:this._website_configuration.chat.position_reverse,force_identify:this._website_configuration.chat.force_identify})),this._container_sel=this._client_sel.find(".crisp-1"),this.__insert_client(),this._apply_sizing(),t.Library.logger.info(this.ns+"."+i,"Base client spawned")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._apply_sizing=function(){var e="_apply_sizing";try{null!==this._container_sel&&(this._container_sel.attr("data-full-view",this._is_full_view()===!0?"true":"false"),this._container_sel.attr("data-small-view",this._is_small_view()===!0?"true":"false"),this._container_sel.attr("data-large-view",this._is_large_view()===!0?"true":"false"))}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._is_full_view=function(){var e="_is_full_view";try{return this._runtime_configuration.lock_full_view===!0||(window.innerHeight<window.innerWidth&&window.innerHeight<this.__full_view_width_threshold||window.innerWidth<this.__full_view_width_threshold)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._is_large_view=function(){var e="_is_large_view";try{return window.innerHeight<window.innerWidth&&window.innerHeight>=this.__large_view_height_threshold||window.innerWidth<window.innerHeight&&window.innerWidth>=this.__large_view_height_threshold}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._is_small_view=function(){var e="_is_small_view";try{return window.innerHeight<window.innerWidth&&window.innerHeight<this.__small_view_height_threshold||window.innerWidth<window.innerHeight&&window.innerWidth<this.__small_view_height_threshold}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._is_invisible=function(){var e="_is_invisible";try{if(this._runtime_configuration.lock_maximized!==!0&&t.Chat.Message._has_messages!==!0){if(this._is_blocked_page===!0)return!0;if(this._is_blocked_locale===!0)return!0;if(this._website_configuration.chat.hide_on_away===!0&&t.Availability._was_availability_online===!1&&t.Availability._users_available!==!0)return!0}return!1}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._trigger_session_loaded=function(){var e="_trigger_session_loaded";try{if("function"==typeof this._ready_trigger)try{this._ready_trigger(),this._ready_trigger=null}catch(e){}t.Action._unstack_pending(),t.Action._event("session:loaded",t.Broker._session_id)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._update_configuration=function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="_update_configuration";try{if(i((this._website_configuration.chat||{})[e])===("undefined"==typeof r?"undefined":i(r))&&(this._website_configuration.chat[e]=r,null!==this._container_sel)){var s=e.replace(this.__toggle_config_namespace_regex,"-");this._container_sel.attr("data-"+s,r===!0?"true":"false")}}catch(e){t.Library.logger.error(this.ns+"."+n,e)}},e.prototype._load_dependency=function(e,i,r){var n=this,s="_load_dependency";try{var a=e+"_handler",o=document.createElement("script");o.type="text/javascript",o.async=1,o.src=[this._url_assets+"/static/javascripts/"+i,"?"+this._client_revision].join(""),this._dollar_crisp.__spool[a]=function(e){document.head.removeChild(o),delete n._dollar_crisp.__spool[a],"function"==typeof r&&r(e)};var c=document.getElementsByTagName("head");c&&c[0]&&c[0].appendChild(o)}catch(e){t.Library.logger.error(this.ns+"."+s,e)}},e.prototype.__configure_console_sink=function(){var e=this,i="__configure_console_sink";try{"production"===this._client_environment?(t.Library.crisp.client.Issue.configure({project:this._project_name,revision:this._client_revision,environment:this._client_environment,useragent:this._browser_useragent,page:this._page_url}),t.Library.logger.set_log_sink(function(i,r,n){if("error"===i){e._dollar_crisp.__spool.error_last={ns:r,value:n};var s=Date.now();s-e.__issue_report_last_date>=e.__issue_report_interval_limit&&(e.__issue_report_last_date=s,t.Library.crisp.client.Issue.report(i,r,n))}})):t.Library.logger.warn(this.ns+"."+i,"Console sink is disabled in "+("'"+this._client_environment+"' environment"))}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__insert_client=function(){var e=this,i="__insert_client";try{this.__append_client(),setInterval(function(){0===t.Library.dom(".crisp-client").length&&(e.__append_client(),t.Library.logger.info(e.ns+"."+i,"Re-inserted client because body mutated"))},this.__insert_check_every)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__append_client=function(){var e="__append_client";try{var i=t.Library.dom("body")||[];i.length>0&&i.append(this._client_sel)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}()),t.Minimized=new(function(){function e(){var e="constructor";try{this.ns="CrispMinimized",this._is_initialized=!1}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="init";try{t.Library.logger.debug(this.ns+"."+r,"Initialize"),this.__initialize_children(),this.__launch(e=e,i=i),this._is_initialized=!0}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__initialize_children=function(){var e="__initialize_children";try{var i=void 0,r=[t.Minimized.Interface,t.Minimized.Selector,t.Minimized.Event];for(i=0;i<r.length;i++)r[i].init()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__launch=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="__launch";try{i!==!0?t.Minimized.Interface._pane_authorized(e=e):t.Minimized.Interface._pane_unauthorized(e=e),t.Base._runtime_configuration.lock_maximized===!0&&(t.Library.logger.info(this.ns+"."+r,"Applied locked maximized state from runtime configuration"),t.Minimized.Interface._pane_open_handler())}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e}()),t.Minimized.Event=new(function(){function e(){var e="constructor";try{this.ns="CrispMinimizedEvent"}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._pane_click=function(e){var i=this,r="_pane_click";try{t.Minimized.Selector._minimized_sel.on("click",function(e){try{var n=e.target?t.Library.dom(e.target):null,s=".crisp-178";n&&n.is(s)?t.Chat._start_minimized():t.Minimized.Interface._pane_open_handler()}catch(e){t.Library.logger.error(i.ns+"."+r,e)}finally{return!1}}),t.Minimized.Selector._minimized_sel[0].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e}()),t.Minimized.Interface=new(function(){function e(){var e="constructor";this.__second_in_milliseconds=1e3,this.__tooltip_short_show_delay=.25,this.__tooltip_full_show_delay=2,this.__animate_initial_pane_timeout=1e3,this.__animate_general_entice_tooltip_timeout=500,this._pane_open_handler=function(){};try{this.ns="CrispMinimizedInterface"}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize"),this.__launch()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._pane_authorized=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i="_pane_authorized";try{this.__spawn_pane("minimized_authorized",is_clickable=!0,e=e),this._pane_open_handler=function(){t.Chat.init()},t.Availability.apply(),t.Minimized.Event._pane_click()}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._pane_unauthorized=function(){var e=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r="_pane_unauthorized";try{this.__spawn_pane("minimized_unauthorized",is_clickable=!1,i=i),this._pane_open_handler=function(){t.Library.logger.warn(e.ns+"."+r,"Cannot open a non-configured chatbox")},t.Minimized.Event._pane_click()}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__spawn_pane=function(e){var i=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s="__spawn_pane";try{if(t.Minimized.Selector._excerpt_sel=t.Library.dom(t.Template.render(e,{configuration:t.Base._website_configuration,methods:{active_operators:t.Avatar.active_operators.__crisp_bind(t.Avatar)},website:{id:t.Base._website_id}})),t.Base._container_sel.empty(),t.Base._container_sel.append(t.Minimized.Selector._excerpt_sel),t.Minimized.Selector._bind(),r===!0){var a=t.Minimized.Selector._tooltips_sel.find([".crisp-29",'[data-id="general_entice"]'].join(""));if(t.Feature.has_css_animations()){if(n===!0){var o="crisp-249";t.Minimized.Selector._minimized_sel.addClass(o),setTimeout(function(){t.Minimized.Selector._minimized_sel.removeClass(o)},this.__animate_initial_pane_timeout)}if(t.Base._is_full_view()!==!0){var c=n===!0?"full":"short";setTimeout(function(){a.safe_css_text("display","block");var e="full"===c?"crisp-250":"crisp-251";a.addClass(e),setTimeout(function(){a.removeClass(e)},i.__animate_general_entice_tooltip_timeout)},this["__tooltip_"+c+"_show_delay"]*this.__second_in_milliseconds)}}else t.Base._is_full_view()!==!0&&a.safe_css_text("display","block")}}catch(e){t.Library.logger.error(this.ns+"."+s,e)}},e.prototype.__launch=function(){var e="__launch";try{t.Library.crisp.client.Message.get_message_history()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}())(t),t.Minimized.Selector=new(function(){function e(){var e="constructor";try{this.ns="CrispMinimizedSelector",this._excerpt_sel=null,this._minimized_sel=null,this._tooltips_sel=null}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._bind=function(){var e="_bind";try{this.__bind_main(),this.__bind_tooltips()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__bind_main=function(){var e="__bind_main";try{this._minimized_sel=this._excerpt_sel.find(".crisp-26")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__bind_tooltips=function(){var e="__bind_tooltips";try{this._tooltips_sel=this._minimized_sel.find(".crisp-28")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}()),t.Chat=new(function(){function e(){var e="constructor";try{this.ns="CrispChat",this._is_initialized=!1}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i="init";try{t.Library.logger.debug(this.ns+"."+i,"Initialize"),this.__initialize_children(),null!==e&&t.Chat.State._restore(e),null===e&&t.Action._event("chat:initiated"),this.__launch(),this._is_initialized=!0}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._start_minimized=function(){var e="_start_minimized";try{this.__start_state(!1)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._start_maximized=function(){var e="_start_maximized";try{this.__start_state(!0)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__start_state=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i="__start_state";try{this._is_initialized!==!0&&(this.init({maximized:e}),t.Chat.State.propagate("maximized",e,force=!0))}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__initialize_children=function(){var e="__initialize_children";try{var i=void 0,r=[t.Chat.Alert,t.Chat.Field,t.Chat.Interface,t.Chat.Message,t.Chat.Misc,t.Chat.Notification,t.Chat.Scroll,t.Chat.State,t.Chat.Selector,t.Chat.Event,t.Chat.Viewport];for(i=0;i<r.length;i++)r[i].init()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__launch=function(){var e="__launch";try{t.Chat.Interface._pane(),t.Chat.Field._focus_on_foreground(),t.Availability.apply(),t.Sound.initialize("events"),t.Chat.Message._show_welcome(),t.Library.crisp.client.Message.get_message_compose(),t.Library.crisp.client.Message.get_message_history(),t.Library.crisp.client.Message.get_unread_messages(),t.Date.watch()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}());var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if(t.Chat.Alert=new(function(){function e(){var e="constructor";try{this.ns="CrispChatAlert",this._states={}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._update=function(e,r){var n="_update";try{var s=void 0,a=void 0,o=void 0,c=void 0;"object"===("undefined"==typeof e?"undefined":i(e))?s=e:(s={},s[e]=r);var _=t.Utility.clone(this._states);for(a in s)s.hasOwnProperty(a)&&(o=s[a],c=!1,"undefined"!=typeof this._states[a]&&this._states[a]===o&&(c=!0),"lock"===this._states[a]&&"unlock"!==o&&(c=!0),c===!1&&(_[a]=o));t.Chat.State.propagate("alert",_)}catch(e){t.Library.logger.error(this.ns+"."+n,e)}},e.prototype._is_visible=function(e){var i="_is_visible",r=!1;try{r=("show"===this._states[e]||"unlock"===this._states[e])&&!0}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e}()),t.Chat.Picker=new(function(){function e(){var e="constructor";try{this.ns="CrispChatPicker",this.__items_gif_maximum=10,this.__visible=null,this.__last_search_query=null}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._is_open=function(){var e="_is_open",i=!1;try{i=null!==this.__visible&&!0}catch(i){t.Library.logger.error(this.ns+"."+e,i)}finally{return i}},e.prototype._toggle=function(e){var i="_toggle";try{var r=t.Chat.Selector.get("pickers").find([".crisp-103",'[data-type="'+e+'"]'].join(""));if(r.length>0){var n=this._is_open();this._reset(),t.Chat.Selector.get("pickers").attr("data-has-animation",n===!1?"true":"false"),this.__show(e,r),t.Chat.Field._focus_on_foreground()}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._reset=function(){var e="_reset";try{this.__last_search_query=null,null!==this.__visible&&(t.Chat.Selector.get("pickers_inner_one").safe_css_text("display","none"),t.Chat.Selector.get("content").removeAttr("data-has-picker-"+this.__visible),t.Library.dom([".crisp-105",'[data-removable="true"]'].join("")).remove(),t.Library.logger.debug(this.ns+"."+e,'Picker "'+this.__visible+'" hidden'),this.__visible=null)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._load_data_gif=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i="_load_data_gif";try{if(null!==t.Chat.Event._search_defer_timeout&&(clearTimeout(t.Chat.Event._search_defer_timeout),t.Chat.Event._search_defer_timeout=null),this.__last_search_query!==e){this.__last_search_query=e;var r=t.Chat.Selector.get("pickers_gif").find(".crisp-104"),n=t.Chat.Selector.get("pickers_gif").find(".crisp-111"),s=t.Template.render("chat_picker_gif_item");r.empty(),n.safe_css_text("display","none"),r.safe_css_text("display","block"),t.Chat.Selector.get("pickers_gif").attr("data-has-search",e?"true":"false"),t.Chat.Selector.get("pickers_search_input").val()!==e&&t.Chat.Selector.get("pickers_search_input").val(e||"");for(var a=0;a<this.__items_gif_maximum;a++)r.append(s);t.Chat.Event._picker_actions_gif_items(r),t.Library.crisp.client.Media.get_animation_list(e)}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._handle_data_gif=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i="_handle_data_gif";try{var r=t.Chat.Selector.get("pickers_gif").find(".crisp-105"),n=0;r&&r.length>0&&(r.each(function(i,r,s){var a=s.eq(r);e[r]&&e[r].type&&e[r].url?(a.attr("data-type",e[r].type),a.attr("data-url",e[r].url),a.safe_css_text("background-image","url('"+t.Base._url_image+"/process/original/"+("?url="+encodeURIComponent(e[r].url)+"')")),a.removeAttr("data-loading"),n++):a.remove()}),0===n&&(t.Chat.Selector.get("pickers_gif").find(".crisp-104").safe_css_text("display","none"),t.Chat.Selector.get("pickers_gif").find(".crisp-111").safe_css_text("display","block")))}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__show=function(e,i){var r="__show";try{i.safe_css_text("display","block"),t.Chat.Selector.get("content").attr("data-has-picker-"+e,"true"),this.__visible=e;var n=this["__trigger_show_"+e];"function"==typeof n&&n.__crisp_bind(this)(),t.Library.logger.debug(this.ns+"."+r,'Picker "'+e+'" shown')}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__trigger_show_gif=function(){var e="__trigger_show_gif";try{this._load_data_gif()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}()),t.Chat.Event=new(function(){function e(){var e="constructor";try{this.ns="CrispChatEvent",this.__textarea_height_safety_margin=120,this.__scroll_propagate_defer_wait=500,this.__search_defer_wait=500,this.__textarea_propagate_defer_wait=1e3,this.__textarea_change_multiplier_gap=.2,this.__file_name_default="File",this.__file_type_default="application/octet-stream",this.__file_change_stack=[],this._search_defer_timeout=null}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._bind=function(){var e="_bind";try{this.__chat_click_fuzzy(),this.__chat_pane_minimize(),this.__chat_pane_toggle(),this.__chat_flow_scroll(),this.__pickers_click(),this.__picker_smiley(),this.__picker_gif(),this.__alert_warn_reply(),this.__alert_email_invalid(),this.__alert_email_form(),this.__textarea_submit(),this.__textarea_change(),this.__file_drop(),this.__file_submit(),this.__file_change(),this.__page_scroll(),this.__page_change()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._message_actions_text=function(e){var i=this,r="_message_actions_file";try{var n=e.find('.crisp-217[data-type="embed"]')||[];n.length>0&&(n.on("click",function(){try{t.Chat.Interface._magnify("embed",n.attr("href"))}catch(e){t.Library.logger.error(i.ns+"."+r+":click",e)}finally{return!1}}),this.__touch_as_click(n),n[0].onclick=function(){return!1})}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype._message_actions_file=function(e){var i=this,r="_message_actions_file";try{var n=e.find(".crisp-233")||[];n.length>0&&(n.on("click",function(){try{t.Chat.Interface._magnify("file",n.attr("href"),n.attr("data-name"))}catch(e){t.Library.logger.error(i.ns+"."+r+":click",e)}finally{return!1}}),this.__touch_as_click(n),n[0].onclick=function(){return!1})}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype._message_actions_sent=function(e,i){var r=this,n="_message_actions_sent";try{var s=e.find(".crisp-228");s.on("click",function(){try{e.remove(),t.Action.do_message_send(i.type,i.content)}catch(e){t.Library.logger.error(r.ns+"."+n+":click",e)}finally{return!1}}),this.__touch_as_click(s),s[0].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+n,e)}},e.prototype._magnify_actions=function(e){var i=this,r="_magnify_actions";try{var n=function(){e.remove(),t.Chat.Field._focus_on_foreground()};e.on("keydown",function(e){try{27===e.keyCode&&n()}catch(e){t.Library.logger.error(i.ns+"."+r+":keydown",e)}}),e.find(".crisp-55").on("load",function(){e.attr("data-state","loaded")}),e[0].onclick=function(e){var s=!1;try{var a=null,o=e.target?t.Library.dom(e.target):null;switch(o&&o.is(".crisp-57")&&(a=o.attr("data-action")),a){case"download":s=!0;break;default:n()}}catch(e){t.Library.logger.error(i.ns+"."+r+":click",e)}finally{return s}},this.__touch_as_click(e)}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype._picker_actions_gif_items=function(e){var i=this,r="_picker_actions_gif_items";try{var n=e.find(".crisp-105")||[];if(n.length>0){n.on("click",function(e){try{var n=e.target?t.Library.dom(e.target):null;if(n){var s=n.attr("data-type"),a=n.attr("data-url");a&&s&&(t.Action.do_message_send("animation",{type:s,url:a}),t.Chat.Picker._reset())}}catch(e){t.Library.logger.error(i.ns+"."+r+":click",e)}finally{return!1}}),this.__touch_as_click(n);for(var s=0;s<n.length;s++)n[s].onclick=function(){return!1}}}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__chat_click_fuzzy=function(){var e=this,i="__chat_click_fuzzy";try{var r=t.Chat.Selector._chat_sel.find(".crisp-85");r.on("click",function(r){try{var n=r.target?t.Library.dom(r.target):null;n&&!n.is(".crisp-110")&&0===n.parents(".crisp-110").length&&t.Chat.Field._focus_on_foreground()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__chat_pane_minimize=function(){var e=this,i="__chat_pane_minimize";try{t.Chat.Selector._chat_sel.on("keydown",function(r){try{27===r.keyCode&&t.Action.do_chat_close()}catch(r){t.Library.logger.error(e.ns+"."+i+":keydown",r)}}),t.Chat.Selector.get("header").on("click",function(){try{t.Action.do_chat_close()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(t.Chat.Selector.get("header")),t.Chat.Selector.get("header")[0].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__chat_pane_toggle=function(){var e=this,i="__chat_pane_toggle";try{t.Chat.Selector._minimized_sel.on("click",function(){try{t.Action.do_chat_toggle()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(t.Chat.Selector._minimized_sel),t.Chat.Selector._minimized_sel[0].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__chat_flow_scroll=function(){var e=this,i="__chat_flow_scroll";try{var r=null,n=function(i){null!==r&&clearTimeout(r),r=setTimeout(function(){t.Chat.State.propagate("scroll",i)},e.__scroll_propagate_defer_wait)};t.Chat.Selector.get("flow").on("scroll",function(){try{t.Chat.Scroll._position=t.Chat.Selector.get("flow")[0].scrollTop,t.Chat.Notification._check_clearance(),n(t.Chat.Scroll._position)}catch(r){t.Library.logger.error(e.ns+"."+i+":scroll",r)}}),t.Chat.Selector.get("alerts_new_messages").on("click",function(){try{t.Chat.Scroll._to()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(t.Chat.Selector.get("alerts_new_messages")),t.Chat.Selector.get("alerts_new_messages")[0].onclick=function(){return!1},t.Chat.Selector.get("flow")[0].onscroll=function(e){e.preventDefault()}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__pickers_click=function(){var e=this,i="__pickers_click";try{var r=t.Chat.Selector.get("pickers_selector_one");t.Chat.Selector.get("pickers").on("click",function(r){try{var n=r.target?t.Library.dom(r.target):null;n&&0===n.parents(".crisp-97").length&&t.Chat.Picker._reset()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}}),r.on("click",function(r){try{var n=r.target?t.Library.dom(r.target):null;if(n){var s=n.attr("data-type");s?t.Chat.Picker._toggle(s):t.Chat.Picker._reset()}}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(r);for(var n=0;n<r.length;n++)r[n].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__picker_smiley=function(){var e=this,i="__picker_smiley";try{var r=t.Chat.Selector.get("pickers_smiley").find(".crisp-105");t.Chat.Selector.get("form_button_smiley").on("click",function(){try{t.Chat.Picker._is_open()===!1?t.Chat.Picker._toggle("smiley"):t.Chat.Picker._reset()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}}),r.on("click",function(r){try{var n=r.target?t.Library.dom(r.target):null,s=n?n.attr("data-value"):null;if(s){var a=void 0,o=void 0,c=t.Chat.Selector.get("form_textarea_message"),_=c[0].selectionStart;a=o=t.Action.get_message_text(),a&&(_>0&&" "!==a[_-1]&&(s=" "+s),_<a.length&&" "!==a[_]&&(s+=" ")),o=a.substr(0,_)+s+a.substr(_),t.Action.set_message_text(o),c.trigger("keyup"),setTimeout(function(){_+=s.length,c[0].selectionStart=c[0].selectionEnd=_},0)}t.Chat.Picker._reset(),t.Chat.Field._focus_on_foreground()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(r);for(var n=0;n<r.length;n++)r[n].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__picker_gif=function(){var e=this,i="__picker_gif";try{var r=t.Chat.Selector.get("pickers_gif").find(".crisp-108")||[];t.Chat.Selector.get("pickers_search_input").on("keyup",function(){try{null!==e._search_defer_timeout&&clearTimeout(e._search_defer_timeout),e._search_defer_timeout=setTimeout(function(){var e=t.Chat.Selector.get("pickers_search_input").val().trim();t.Chat.Picker._load_data_gif(e)},e.__search_defer_wait)}catch(r){t.Library.logger.error(e.ns+"."+i+":keyup",r)}}),r.length>0&&(r.on("click",function(){try{t.Chat.Picker._load_data_gif()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(r),r[0].onclick=function(){return!1})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__alert_warn_reply=function(){var e=this,i="__alert_warn_reply";try{t.Chat.Selector.get("alerts_warn_reply").on("click",function(){try{t.Chat.Alert._update({warn_reply:"hide",email_form:"unlock"})}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(t.Chat.Selector.get("alerts_warn_reply")),t.Chat.Selector.get("alerts_warn_reply")[0].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__alert_email_invalid=function(){var e=this,i="__alert_email_invalid";
try{t.Chat.Selector.get("alerts_email_invalid").on("click",function(){try{t.Chat.Alert._update({email_invalid:"hide",email_form:"unlock"})}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(t.Chat.Selector.get("alerts_email_invalid")),t.Chat.Selector.get("alerts_email_invalid")[0].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__alert_email_form=function(){var e=this,i="__alert_email_form";try{var r=function(){t.Chat.Scroll._to_last_message()},n=function(){var e=t.Chat.Selector.get("alerts_email_form_input").val().trim();try{t.Action.set_user_email(e)}catch(e){}r()},s=function(){if(t.Base._website_configuration.chat.force_identify!==!0){var e=t.Chat.Selector.get("alerts_email_form").attr("data-error");"true"===e?t.Chat.Alert._update({email_form:"lock",email_invalid:"show"}):t.Chat.Alert._update({email_form:"lock",warn_reply:"show"}),r()}};t.Chat.Selector.get("alerts_email_form_form").on("keyup",function(r){try{if(13===r.keyCode)return n(),!1}catch(r){t.Library.logger.error(e.ns+"."+i+":submit",r)}}),t.Chat.Selector.get("alerts_email_form").on("click",function(r){try{var n=r.target?t.Library.dom(r.target):null;n&&0===n.parents(".crisp-114").length&&s()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),t.Chat.Selector.get("alerts_email_form_validate").on("click",function(){try{n()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),t.Chat.Selector.get("alerts_email_form_cancel").on("click",function(){try{s()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(t.Chat.Selector.get("alerts_email_form_validate")),this.__touch_as_click(t.Chat.Selector.get("alerts_email_form_cancel")),t.Chat.Selector.get("alerts_email_form_form")[0].onsubmit=function(){return!1},t.Chat.Selector.get("alerts_email_form_validate")[0].onclick=function(){return!1},t.Chat.Selector.get("alerts_email_form_cancel")[0].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__textarea_submit=function(){var e=this,i="__textarea_submit";try{var r=function(){t.Chat.Message.send()};t.Chat.Selector.get("form_textarea_message").on("keyup",function(n){try{if(13===n.keyCode&&!n.shiftKey)return r(),!1}catch(r){t.Library.logger.error(e.ns+"."+i+":keyup",r)}}),t.Chat.Selector.get("form_button_send").on("click",function(){try{r()}catch(r){t.Library.logger.error(e.ns+"."+i+":click",r)}finally{return!1}}),this.__touch_as_click(t.Chat.Selector.get("form_button_send")),t.Chat.Selector.get("form_textarea_message")[0].onkeydown=function(e){if(13===e.keyCode&&!e.shiftKey)return!1},t.Chat.Selector.get("form_message")[0].onsubmit=function(){return!1},t.Chat.Selector.get("form_button_send")[0].onclick=function(){return!1}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__textarea_change=function(){var e=this,i="__textarea_change";try{var r=1,n=null,s=parseInt(t.Chat.Selector.get("form_textarea_message").attr("rows"),10),a=function(i){null!==n&&clearTimeout(n),n=setTimeout(function(){t.Chat.State.propagate("textarea",i)},e.__textarea_propagate_defer_wait)},o=function(n){try{if(_textarea_val="",13!==n.keyCode||n.shiftKey)if(_textarea_val=t.Action.get_message_text(),a(_textarea_val),_textarea_val){var o=8.5*_textarea_val.length,c=o/t.Chat.Interface._textarea_base_width;c+=(_textarea_val.match(/\n/g)||[]).length;var _=Math.ceil(c);if(_-c<e.__textarea_change_multiplier_gap||_!==r){c=_,r=c;var l=t.Chat.Interface._form_container_height-t.Chat.Interface._textarea_base_line_height+t.Chat.Interface._textarea_base_line_height*c,p=t.Chat.Interface._textarea_base_line_height*(c-1);t.Chat.Selector.get("form_textarea_message").attr("rows",s+(c-1)),l<t.Chat.Interface._flow_height+t.Chat.Interface._form_container_height-e.__textarea_height_safety_margin?(t.Chat.Field._update_textarea_overlapping(p),t.Chat.Selector.get("form_container").safe_css_text("height",l+"px"),t.Library.logger.info(e.ns+"."+i+":fn","New height set to: "+l)):t.Library.logger.warn(e.ns+"."+i+":fn","Max height reached for new height: "+l)}t.Chat.Selector.get("form_container").attr("data-has-value","true")}else t.Chat.Selector.get("form_container").safe_css_text(null),t.Chat.Selector.get("form_container").attr("data-has-value","false"),t.Chat.Selector.get("form_textarea_message").attr("rows",s),t.Chat.Field._update_textarea_overlapping(0),t.Library.logger.info(e.ns+"."+i+":fn","Restored base properties");t.Library.crisp.client.Message.send_message_compose(_textarea_val?"start":"stop",_textarea_val||null)}catch(r){t.Library.logger.error(e.ns+"."+i+":fn",r)}};t.Chat.Selector.get("form_textarea_message").on("keypress",function(r){try{o(r)}catch(r){t.Library.logger.error(e.ns+"."+i+":keypress",r)}}),t.Chat.Selector.get("form_textarea_message").on("keyup",function(r){try{o(r)}catch(r){t.Library.logger.error(e.ns+"."+i+":keyup",r)}})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__file_drop=function(){var e=this,i="__file_drop";try{var r=function(e){e.preventDefault(),e.stopPropagation()};t.Chat.Selector.get("content").on("dragover",function(e){r(e),t.Chat.Selector.get("content").attr("data-has-drop-zone","true")}),t.Chat.Selector.get("drop_over").on("dragleave",function(e){r(e),t.Chat.Selector.get("content").removeAttr("data-has-drop-zone")}),t.Chat.Selector.get("drop_over").on("drop",function(i){return r(i),t.Chat.Selector.get("content").removeAttr("data-has-drop-zone"),i.dataTransfer&&i.dataTransfer.files&&i.dataTransfer.files.length>0&&e.__handle_file_change(i.dataTransfer.files),!1})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__file_submit=function(){var e=this,i="__file_submit";try{t.Chat.Selector.get("form_attach").on("event:attach",function(){try{var r=void 0,n=void 0,s=void 0,a=void 0,o=function(){r&&(r.removeEventListener("progress",l,!1),r.removeEventListener("error",_,!1),r.removeEventListener("abort",_,!1),r.removeEventListener("load",c,!1)),t.Chat.Selector.get("form_input_attach")[0].value=null,t.Chat.Selector.get("form_button_attach").attr("data-state","none"),e.__file_change_stack.shift(),e.__file_change_stack.length>0&&e.__handle_file_change(e.__file_change_stack)},c=function(){e.__file_change_stack.length>0&&s&&(t.Library.logger.info(e.ns+"."+i,"Succeeded uploading file"),t.Action.do_message_send("file",{url:s,name:e.__file_change_stack[0].name||e.__file_name_default,type:e.__file_change_stack[0].type||e.__file_type_default})),o()},_=function(){e.__file_change_stack.length>0&&(t.Library.logger.info(e.ns+"."+i,"Failed uploading file"),alert(t.Locale.text("chat","chat_form_attach_alert_error"))),o()},l=function(e){t.Chat.Selector.get("form_button_attach").attr("data-state","uploading")};if(n=t.Chat.Selector.get("form_attach").attr("data-action"),s=t.Chat.Selector.get("form_attach").attr("data-resource"),a=parseInt(t.Chat.Selector.get("form_attach").attr("data-size-limit"),10),!e.__file_change_stack[0])throw o(),new Error("Empty file data read from attach input");if(!n||!s)throw o(),new Error(["Either empty bucket upload action or resource value ","received from backend"].join(""));if(e.__file_change_stack[0].size>=a)return alert(t.Locale.text("chat","chat_form_attach_alert_size")),void o();r=new XMLHttpRequest,r.file=e.__file_change_stack[0],r.addEventListener("progress",l,!1),r.addEventListener("error",_,!1),r.addEventListener("abort",_,!1),r.addEventListener("load",c,!1),r.open("PUT",n,!0),r.setRequestHeader("Content-Disposition","attachment"),r.send(e.__file_change_stack[0])}catch(r){t.Library.logger.error(e.ns+"."+i+":submit",r)}finally{return!1}})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__file_change=function(){var e=this,i="__file_change";try{t.Chat.Selector.get("form_input_attach").on("change",function(t){return!!(t.target.files&&t.target.files.length>0)&&e.__handle_file_change(t.target.files)})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__page_scroll=function(){var e=this,i="__page_scroll";try{document.addEventListener("wheel",function(r){try{var n=r.target?t.Library.dom(r.target):null;if(n&&"number"==typeof r.wheelDelta&&t.Action.is_chat_opened()===!0&&(n.parents(".crisp-client").length>0||n.is(".crisp-client"))){var s=t.Chat.Selector.get("flow"),a=".crisp-88";if(s&&s[0]&&(n.parents(a).length>0||n.is(a))){var o=s[0].scrollTop-r.wheelDelta;s[0].scrollTop=o>=0?o:0}r.stopPropagation(),r.preventDefault(),r.returnValue=!1}}catch(r){t.Library.logger.error(e.ns+"."+i+":wheel",r)}})}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__page_change=function(){var e="__page_change";try{window.addEventListener("beforeunload",function(e){var i=null;t.Library.crisp.client.Message.is_sending_messages()===!0&&(i=t.Locale.text("chat","chat_message_send_abort_warn"));var r=t.Chat.Selector.get("form_button_attach").attr("data-state");if(["preparing","uploading"].indexOf(r)!==-1&&(i=t.Locale.text("chat","chat_form_attach_abort_warn")),i)return e.returnValue=i})}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__touch_as_click=function(e){var i=this,r="__touch_as_click";try{e.on("touchstart",function(e){try{e.preventDefault()}catch(e){t.Library.logger.error(i.ns+"."+r+":touchstart",e)}}),e.on("touchend",function(e){try{e.preventDefault(),e.target&&"function"==typeof e.target.click&&e.target.click()}catch(e){t.Library.logger.error(i.ns+"."+r+":touchend",e)}})}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__handle_file_change=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i="__handle_file_change";try{var r=t.Chat.Selector.get("form_button_attach").attr("data-state");if(e.length>0&&"none"===r){this.__file_change_stack=[];for(var n=0;n<e.length;n++)this.__file_change_stack.push(e[n]);t.Chat.Selector.get("form_button_attach").attr("data-state","preparing"),t.Library.crisp.client.Bucket.get_url_upload(e[0].name||this.__file_name_default,e[0].type||this.__file_type_default)}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return!1}},e}()),t.Chat.Field=new(function(){function e(){var e="constructor";try{this.ns="CrispChatField",this._textarea_val=""}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._focus_on_foreground=function(){var e="_focus_on_foreground";try{if(!t.Feature.has_screen_touch()&&t.Chat.Interface._chat_is_visible()){var i=null;i=t.Chat.Picker._is_open()===!0?t.Chat.Selector.get("pickers_search_input"):t.Chat.Alert._is_visible("email_form")===!0?t.Chat.Selector.get("alerts_email_form_input"):t.Chat.Selector.get("form_textarea_message"),i&&i.length>0&&i[0].focus()}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._blur_from_foreground=function(){var e="_blur_from_foreground";try{t.Chat.Selector.get("form_textarea_message")[0].blur(),t.Chat.Selector.get("alerts_email_form_input")[0].blur()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._update_textarea_overlapping=function(e){var i="_update_textarea_overlapping";try{var r=t.Chat.Selector._chat_sel.find([".crisp-115",".crisp-97"].join(", "));r.safe_css_text("margin-bottom",e+"px")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e}()),t.Chat.Interface=new(function(){function e(){var e="constructor";try{this.ns="CrispChatInterface",this.__desktop_small_chat_width=320,this.__desktop_small_chat_height=380,this.__desktop_regular_chat_width=360,this.__desktop_regular_chat_height=460,this.__desktop_large_chat_width=400,this.__desktop_large_chat_height=560,this.__textarea_width_sefety=8,this.__toggle_clean_timeout=500,this.__magnify_focus_timeout=250,this.__metric_reply_min=3e4,this.__metric_reply_max=216e5,this.__smileys={angry:":@",blushing:":$",confused:"x)",cool:"8)",crying:":'(",embarrased:":/",heart:"<3",laughing:":'D",sad:":(",sick:":S","small-smile":":)","big-smile":":D","thumbs-up":"+1",surprised:":o",tongue:":P",winking:";)"},this._visibility_animate_classes={minimized:{minimize:"crisp-252",maximize:"crisp-253"},shade:{minimize:"crisp-254",maximize:"crisp-255"},chat:{minimize:"crisp-256",maximize:"crisp-257"}},this._is_maximized=!0,this.__toggle_clean_timeout_wait=null,this._flow_height=0,this._form_container_height=0,this._textarea_base_width=0,this._textarea_base_line_height=0,this._last_message_height=40,this.__effective_chat_width=0,this.__effective_chat_height=0,this.__has_window_focus=!0}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{this.__watch_focus(),t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._toggle_visibility=function(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pane",r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="_toggle_visibility";try{var s="chat"===i?"true":"false",a=function(i){var r="close"===i?"maximize":"minimize",n="close"===i?"minimize":"maximize";null!==e.__toggle_clean_timeout_wait&&clearTimeout(e.__toggle_clean_timeout_wait),t.Chat.Selector._minimized_sel&&(t.Chat.Selector._minimized_sel.removeClass(e._visibility_animate_classes.minimized[r]),t.Chat.Selector._minimized_sel.addClass(e._visibility_animate_classes.minimized[n])),t.Chat.Selector._shade_sel&&(t.Chat.Selector._shade_sel.removeClass(e._visibility_animate_classes.shade[r]),t.Chat.Selector._shade_sel.addClass(e._visibility_animate_classes.shade[n])),t.Chat.Selector._chat_sel&&(t.Chat.Selector._chat_sel.removeClass(e._visibility_animate_classes.chat[r]),t.Chat.Selector._chat_sel.addClass(e._visibility_animate_classes.chat[n])),e.__toggle_clean_timeout_wait=setTimeout(function(){o(i)},e.__toggle_clean_timeout)},o=function(i){var r=!(i&&"open"!==i),n=!(i&&"close"!==i);r===!0&&(t.Chat.Selector._minimized_sel&&(t.Chat.Selector._minimized_sel.attr("data-maximized","true"),t.Chat.Selector._minimized_sel.removeClass(e._visibility_animate_classes.minimized.maximize)),t.Chat.Selector._shade_sel&&t.Chat.Selector._shade_sel.removeClass(e._visibility_animate_classes.shade.maximize),t.Chat.Selector._chat_sel&&t.Chat.Selector._chat_sel.removeClass(e._visibility_animate_classes.chat.maximize)),n===!0&&(t.Chat.Selector._shade_sel&&t.Chat.Selector._shade_sel.attr("data-visible","false"),t.Chat.Selector._chat_sel&&t.Chat.Selector._chat_sel.attr("data-visible","false"),t.Chat.Selector._minimized_sel&&t.Chat.Selector._minimized_sel.removeClass(e._visibility_animate_classes.minimized.minimize),t.Chat.Selector._shade_sel&&t.Chat.Selector._shade_sel.removeClass(e._visibility_animate_classes.shade.minimize),t.Chat.Selector._chat_sel&&t.Chat.Selector._chat_sel.removeClass(e._visibility_animate_classes.chat.minimize))};"pane"===i?this._is_maximized=!1:this._is_maximized=!0,this.__apply_focus(),r===!0&&t.Feature.has_css_animations()?"pane"===i?(t.Chat.Selector._minimized_sel&&t.Chat.Selector._minimized_sel.attr("data-maximized",s),a("close")):(t.Chat.Selector._shade_sel&&t.Chat.Selector._shade_sel.attr("data-visible",s),t.Chat.Selector._chat_sel&&t.Chat.Selector._chat_sel.attr("data-visible",s),a("open")):(o(),t.Chat.Selector._shade_sel&&t.Chat.Selector._shade_sel.attr("data-visible",s),t.Chat.Selector._chat_sel&&t.Chat.Selector._chat_sel.attr("data-visible",s),t.Chat.Selector._minimized_sel&&t.Chat.Selector._minimized_sel.attr("data-maximized",s))}catch(e){t.Library.logger.error(this.ns+"."+n,e)}},e.prototype._minimize=function(){var e="_minimize";try{t.Base._runtime_configuration.lock_maximized!==!0?(t.Chat.State.propagate("maximized",!1),t.Library.logger.debug(this.ns+"."+e,"Minimizing chat...")):t.Library.logger.debug(this.ns+"."+e,"Cannot minimize chat, maximized mode is locked")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._maximize=function(){var e="_maximize";try{t.Chat.State.propagate("maximized",!0,force=!1,function(){t.Chat.Scroll._to()}),t.Library.logger.debug(this.ns+"."+e,"Maximizing chat...")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._chat_is_visible=function(){var e="_chat_is_visible",i=!0;try{i=this._is_maximized}catch(i){t.Library.logger.error(this.ns+"."+e,i)}finally{return i}},e.prototype._pane=function(){var e="_pane";try{var i=t.Base._website_configuration||{},r=i.website||{};t.Chat.Selector._excerpt_sel=t.Library.dom(t.Template.render("chat",{activity:{metrics:r.response_metrics&&r.response_metrics.mean&&r.response_metrics.mean>=this.__metric_reply_min&&r.response_metrics.mean<this.__metric_reply_max?{format:t.Date.format_duration(r.response_metrics.mean).toLowerCase(),raw:r.response_metrics.mean}:null,last:r.active_operators&&r.active_operators[0]&&r.active_operators[0].timestamp?{format:t.Date.format_date(t.Date.timestamp_to_iso(r.active_operators[0].timestamp)).toLowerCase(),raw:t.Date.timestamp_to_iso(r.active_operators[0].timestamp)}:null},configuration:i,environment:{smileys:this.__smileys,url:{crisp_web:t.Base._url_website}},methods:{active_operators:t.Avatar.active_operators.__crisp_bind(t.Avatar)},website:{id:t.Base._website_id,domain:t.Base._website_configuration.website.domain}})),t.Base._container_sel.empty(),t.Base._container_sel.append(t.Chat.Selector._excerpt_sel),t.Chat.Selector._bind(),t.Chat.Event._bind(),this._apply_dynamic_sizing_properties(),this.__force_chat_hide(),t.Chat.State._trigger_default_all()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._apply_dynamic_sizing_properties=function(){var e="_apply_dynamic_sizing_properties";try{if(t.Action.is_chat_visible()===!0){var i=window.innerWidth,r=window.innerHeight;t.Base._is_large_view()===!0?(this.__effective_chat_height=this.__desktop_large_chat_height,this.__effective_chat_width=this.__desktop_large_chat_width):t.Base._is_small_view()===!0?(this.__effective_chat_height=this.__desktop_small_chat_height,this.__effective_chat_width=this.__desktop_small_chat_width):(this.__effective_chat_height=this.__desktop_regular_chat_height,this.__effective_chat_width=this.__desktop_regular_chat_width),t.Base._apply_sizing(),t.Base._is_full_view()===!0&&(this.__effective_chat_height=r,this.__effective_chat_width=i,this.__effective_chat_height-=t.Chat.Selector.get("header").height());var n="rtl"===t.Locale.direction()?"right":"left",s="rtl"===t.Locale.direction()?"left":"right",a=parseInt(t.Chat.Selector.get("form_textarea_message").css(n).replace("px",""),10),o=parseInt(t.Chat.Selector.get("form_act").css(s).replace("px",""),10),c=this.__effective_chat_width-this.__textarea_width_sefety-a-o-t.Chat.Selector.get("form_act")[0].offsetWidth;t.Chat.Selector._chat_sel.safe_css_text("width",this.__effective_chat_width+"px"),t.Chat.Selector.get("content").safe_css_text("height",this.__effective_chat_height+"px"),t.Chat.Selector.get("form_textarea_message").safe_css_text("width",c+"px"),this._flow_height=t.Chat.Selector.get("flow").height(),this._textarea_base_width=t.Chat.Selector.get("form_textarea_message").width(),0===this._form_container_height&&(this._form_container_height=t.Chat.Selector.get("form_container").height()),0===this._textarea_base_line_height&&(this._textarea_base_line_height=parseInt(t.Chat.Selector.get("form_textarea_message").css("line-height").replace("px",""),10)),t.Chat.Scroll._margin=this._flow_height,t.Base._is_full_view()&&this._chat_is_visible()===!0?t.Chat.Viewport._adapt():t.Chat.Viewport._unadapt(),t.Sound.allow(!t.Base._is_full_view()&&!0),t.Chat.Selector.get("form_textarea_message").trigger("keyup"),t.Library.logger.debug(this.ns+"."+e,"Applied dynamic sizing properties matching current window properties")}else t.Library.logger.warn(this.ns+"."+e,"Did not apply dynamic sizing properties because chat is not visible")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._has_focus=function(){var e="_has_focus";try{return this.__has_window_focus&&this._chat_is_visible()&&!0}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._magnify=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n="_magnify";try{t.Library.logger.debug(this.ns+"."+n,"Magnifying media of type: "+e+"...");var s=t.Base._container_sel.find(".crisp-53");0===s.length?(s=t.Library.dom(t.Template.render("magnify",{type:e,source:i,name:r})),t.Chat.Event._magnify_actions(s),t.Base._container_sel.append(s),setTimeout(function(){s[0].focus()},this.__magnify_focus_timeout),t.Library.logger.info(this.ns+"."+n,"Magnified media of type: "+e)):t.Library.logger.warn(this.ns+"."+n,"Could not magnify media of type: "+e+" because: magnify container is missing")}catch(e){t.Library.logger.error(this.ns+"."+n,e)}},e.prototype.__apply_focus=function(){var e="__apply_focus";try{var i=this._has_focus();t.Library.crisp.client.Message.set_messages_in_view(i),t.Library.logger.info(this.ns+"."+e,"Toggled interface focus to state: "+i)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__watch_focus=function(){var e=this,i="__watch_focus";try{this.__has_window_focus=(!window.hasFocus||window.hasFocus())&&!0,window.addEventListener("focus",function(){e.__has_window_focus=!0,e.__apply_focus()},!1),window.addEventListener("blur",function(){e.__has_window_focus=!1,e.__apply_focus()},!1)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__force_chat_hide=function(){var e="__force_chat_hide";try{this._is_maximized=!1,t.Chat.Selector._shade_sel.attr("data-visible","false"),t.Chat.Selector._chat_sel.attr("data-visible","false")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}()),t.Chat.Message=new(function(){function e(){var e="constructor";try{this.ns="CrispChatMessage",this.__acknowledgement_timeout=3e4,this.__animate_entrance_timeout=400,this.__compose_expire_interval=5e3,this.__compose_expire_max_age=12e4,this._has_messages=!1,this.__has_exchanged_messages=!1,this.__has_local_messages=!1,this.__acknowledgement_queue=[],this.__sent_read_fingerprints=[],this.__show_email_form_after=1e3,this.__show_email_form_timeout=null,this.__message_compose_timestamp=null}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{this.__register_unread_handler(),t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.send=function(){var e="send";try{var i=t.Action.get_message_text();i=i.trim(),i&&(t.Action.do_message_send("text",i),t.Action.set_message_text(""),t.Chat.Selector.get("form_textarea_message").trigger("keyup"))}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.received=function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o="received";try{var c=this.__show("from",e);i===!0&&t.Chat.Interface._has_focus()===!1&&t.Sound.start("events","chat-message-receive"),s===!0&&t.Chat.Scroll._to_last_message(direction="from"),r===!0&&this.__animate_entrance(c),n===!0&&this._mark_has_exchanged_messages(),e.user&&"welcome"!==e.user.source&&t.Chat.Misc._update_operator_details(e.user),a===!1&&t.Chat.Alert._update("wait_reply","lock"),this.__message_compose_timestamp&&e.timestamp>0&&this.__message_compose_timestamp<e.timestamp&&this._hide_compose()}catch(e){t.Library.logger.error(this.ns+"."+o,e)}},e.prototype.sent=function(e){var i=this,r="sent";try{var n=this.__show("to",e);if(t.Chat.Scroll._to_last_message(direction="to"),this.__animate_entrance(n),this.__schedule_acknowledgement_check(e.fingerprint),t.Chat.Event._message_actions_sent(n,e),"lock"!==t.Chat.Alert._states.email_form){var s=t.Action.get_user_email();s||(t.Base._website_configuration.chat.email_visitors===!0?(null!==this.__show_email_form_timeout&&clearTimeout(this.__show_email_form_timeout),this.__show_email_form_timeout=setTimeout(function(){i.__show_email_form_timeout=null,t.Chat.Alert._update("email_form","show")},this.__show_email_form_after)):t.Chat.Alert._update("wait_reply","show"))}}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.sent_acknowledgement=function(e){var i="sent_acknowledgement";try{var r=this.__acknowledgement_queue.indexOf(e.fingerprint);r!==-1&&(this.__acknowledgement_queue.splice(r,1),t.Library.logger.info(this.ns+"."+i,"Acknowledged sent message with fingerprint: "+e.fingerprint)),this.__show("to",e),t.Chat.Scroll._to_last_message(direction="to")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.received_from_history=function(e){var i="received_from_history";try{this.__show("from",e),e.index.current===e.index.total&&this.__history_restore_done()}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.sent_from_history=function(e){var i="sent_from_history";try{this.__show("to",e),e.read===!0&&this.__sent_read_fingerprints.push(e.fingerprint),e.index.current===e.index.total&&this.__history_restore_done()}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._show_welcome=function(){var e="_show_welcome";try{var i=t.Chat.State._is_restored!==!0&&!0,r=t.Locale.text("theme_welcome",["default_chat",t.Base._website_configuration.chat.theme_welcome+"_chat"],[t.Base._website_configuration.website.name]);this.received({type:"text",timestamp:0,content:r,fingerprint:"1",user:{source:"welcome",type:"website",user_id:t.Base._website_id}},with_sounds=!1,with_animations=i,with_exchanged=i,with_scroll=i,is_locally_generated=!0)}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._show_compose=function(e){var i="_show_compose";try{var r=(t.Chat.Selector._chat_sel?t.Chat.Selector._chat_sel.find(".crisp-241"):null)||[];this.__message_compose_timestamp=e,0===r.length&&(r=t.Library.dom(t.Template.render("chat_bubble_composing")),t.Chat.Selector.get("flow_events").append(r),t.Chat.Scroll._to_last_message(direction=null),this.__check_compose_expire())}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._hide_compose=function(){var e="_hide_compose";try{var i=t.Chat.Selector._chat_sel?t.Chat.Selector._chat_sel.find(".crisp-241"):null;this.__message_compose_timestamp=null,i&&i.length>0&&i.remove()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._acknowledge_read_send=function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="_acknowledge_read_send";try{var n=null;if(e.length>0)for(var s=t.Chat.Selector.get("flow_messages").find(".crisp-207"),a=s.length-1;a>=0;a--){var o=s[a].getAttribute("data-fingerprint");if(o&&(isNaN(o)||(o=parseInt(o,10)),e.indexOf(o)!==-1)){n=o;break}}else{var c=t.Chat.Selector.get("flow_messages").find('.crisp-207[data-from="visitor"]');c.length>0&&(n=c.last().attr("data-fingerprint")||null)}null!==n&&(t.Chat.Selector.get("flow_messages").find(".crisp-225").safe_css_text("display","none"),t.Chat.Selector.get("flow_messages").find([".crisp-207",'[data-fingerprint="'+n+'"]'].join("")).find(".crisp-225").safe_css_text("display","inline-block"),i===!1&&t.Library.logger.debug(this.ns+"."+r,["Acknowledged send message read ","for fingerprint: "+n].join("")))}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype._mark_has_exchanged_messages=function(){var e="_mark_has_exchanged_messages";try{this.__has_exchanged_messages===!1&&(this.__has_exchanged_messages=!0,t.Base._container_sel.attr("data-has-exchanged-messages","true"),t.Chat.Interface._apply_dynamic_sizing_properties())}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._dispatch_local=function(e,i){var r="_dispatch_local";try{var n=t.Base._website_configuration.website.active_operators||[],s={source:"local"};n[0]?(s.user_id=n[0].user_id,s.nickname=n[0].nickname,n[0].avatar&&(s.avatar=n[0].avatar)):(s.type="website",s.user_id=t.Base._website_id,s.nickname=t.Base._website_configuration.website.name),t.Library.crisp.client.Message.receive_message_local(e,i,s)}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__check_compose_expire=function(){var e=this,i="__check_compose_expire";try{t.Library.logger.debug(this.ns+"."+i,"Checking for remote message compose state expiration"),this.__message_compose_timestamp&&(Date.now()-this.__message_compose_timestamp>=this.__compose_expire_max_age?(t.Library.logger.warn(this.ns+"."+i,"Remote message compose state has expired"),this._hide_compose()):setTimeout(function(){e.__check_compose_expire()},this.__compose_expire_interval))}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__display=function(e,i,r,n,s,a,o){var c="__display",_=null;try{var l="from"===i?"operator":"visitor",p="operator"===l?r.avatar||r.user_id:"session",h="",u="";s>0&&(h=t.Date.timestamp_to_iso(s),u=t.Date.format_date(h)),_=t.Library.dom(t.Template.render("chat_message_"+e,{from:l,user:r,content:n,date_iso:h,date_formatted:u,fingerprint:a,metas:o,configuration:t.Base._website_configuration,environment:{url:{crisp_image:t.Base._url_image}}}));var d=t.Chat.Selector.get("flow_messages").find([".crisp-207",'[data-fingerprint="'+a+'"]'].join(""));if(0===d.length){var f=t.Date.timestamp_to_properties(s),g=t.Chat.Selector.get("flow_messages").children().last(),y=g.filter(".crisp-244").length>0&&!0;y&&g.attr("data-day")===f.day&&g.attr("data-month")===f.month&&g.attr("data-year")===f.year||(g=t.Library.dom(t.Template.render("chat_bubble_thread",f)),t.Chat.Selector.get("flow_messages").append(g));var m=g.find(".crisp-247"),v=m.children().last(),b=v.filter(".crisp-248").length>0&&!0;!b||b&&(v.attr("data-from")!==l||v.attr("data-user-marker")!==p)?(v=t.Library.dom(t.Template.render("chat_bubble_group",{from:l,user_marker:p})),m.append(v)):(v.find(".crisp-208").remove(),v.find(".crisp-224").remove()),v.append(_),v.append(t.Template.render("clear")),t.Chat.Selector._last_message_height=_.height(),"operator"===l&&this.__message_compose_timestamp&&s>0&&s>this.__message_compose_timestamp&&this._hide_compose()}else{var w=".crisp-215",k=d.find(w),L=_.find(w);k[0].parentNode.replaceChild(L[0],k[0]),_=d}s>0&&(this._has_messages=!0),this.__has_local_messages===!1&&"local"===r.source&&(this.__has_local_messages=!0,t.Base._container_sel.attr("data-has-local-messages","true"))}catch(e){t.Library.logger.error(this.ns+"."+c,e)}finally{return _}},e.prototype.__animate_entrance=function(e){var i="__animate_entrance";try{if(t.Feature.has_css_animations()){var r="crisp-258";e.addClass(r),setTimeout(function(){e.removeClass(r)},this.__animate_entrance_timeout)}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__show=function(e,i){var r="__show",n=null;try{switch(i.type){case"text":if(!i.content)throw new Error("Got an empty text message, dropping it");n=this.__display("text",e,i.user||{},i.content,i.timestamp,i.fingerprint,{preview:i.preview}),t.Chat.Event._message_actions_text(n);break;case"file":if(!i.content||!i.content.url)throw new Error("Got an invalid file message, dropping it");n=this.__display("file",e,i.user||{},i.content,i.timestamp,i.fingerprint),t.Chat.Event._message_actions_file(n);break;case"animation":if(!i.content||!i.content.url)throw new Error("Got an invalid animation message, dropping it");n=this.__display("animation",e,i.user||{},i.content,i.timestamp,i.fingerprint);break;default:throw new Error("Got an unsupported message (with type: "+i.type+")")}}catch(e){t.Library.logger.error(this.ns+"."+r,e)}finally{return n}},e.prototype.__history_restore_done=function(){var e="__history_restore_done";try{this.__sent_read_fingerprints.length>0&&(this._acknowledge_read_send(this.__sent_read_fingerprints,!0),this.__sent_read_fingerprints=[]),t.Chat.State._retrigger("scroll")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__register_unread_handler=function(){var e="__register_unread_handler";try{t.Library.crisp.client.Message.set_unread_messages_callback(function(e,i,r){t.Chat.Notification._update_unread(e,i,r)})}catch(i){
t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__schedule_acknowledgement_check=function(e){var i=this,r="__schedule_acknowledgement_check";try{this.__acknowledgement_queue.push(e),setTimeout(function(){try{var n=i.__acknowledgement_queue.indexOf(e);if(n===-1)t.Library.logger.debug(i.ns+"."+r+":timeout","Message was delivered (fingerprint: "+e+")");else{var s=t.Chat.Selector.get("flow_messages").find([".crisp-207",'[data-fingerprint="'+e+'"]'].join(""));s.find(".crisp-224").safe_css_text("display","none"),s.find(".crisp-228").safe_css_text("display","block"),t.Library.logger.warn(i.ns+"."+r+":timeout","Message was not delivered (fingerprint: "+e+")")}i.__acknowledgement_queue.splice(n,1)}catch(e){t.Library.logger.error(i.ns+"."+r+":timeout",e)}},this.__acknowledgement_timeout),t.Library.logger.debug(this.ns+"."+r,["Scheduled a message acknowledgement check ","for fingerprint: "+e].join(""))}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e}()),t.Chat.Misc=new(function(){function e(){var e="constructor";try{this.ns="CrispChatMisc",this._operator_details={}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._update_operator_details=function(e){var i="_update_operator_details";try{t.Utility.is_equal(e,this._operator_details)||(t.Chat.State.propagate("operator",e),t.Library.logger.debug(this.ns+"."+i,"Updated operator details"))}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e}()),t.Chat.Notification=new(function(){function e(){var e="constructor";try{this.ns="CrispChatNotification",this.__preview_stack_maximum=5,this._unread_count=0,this.__second_in_milliseconds=1e3,this.__tooltip_show_delay=.1,this.__tooltip_show_delay_timeout_wait=null,this.__preview_stack_last_fingerprint=null,this.__page_title_current=null,this.__animate_new_messages_tooltip_timeout=500,this.__animate_extended_preview_timeout=1e3}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._update_unread=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s="_update_unread";try{var a="crisp-250";if(this._unread_count=e,e>0){var o=1===e?"singular":"plural";t.Chat.Selector.get("pane_unread").text(e),t.Chat.Selector.get("tooltips_new_messages_text").safe_css_text("display","none"),t.Chat.Selector.get("tooltips_new_messages").find([".crisp-163",'[data-variant="'+o+'"]'].join("")).safe_css_text("display","block");var c="none"===t.Chat.Selector.get("tooltips_new_messages").css("display")&&!0,_=this.__show_unread_preview(e,r,n,c);null===this.__page_title_current&&(this.__page_title_current=document.title),this.__page_title_current&&(document.title="💬"+e+" - "+this.__page_title_current),c===!0&&(t.Feature.has_css_animations()?(null!==this.__tooltip_show_delay_timeout_wait&&clearTimeout(this.__tooltip_show_delay_timeout_wait),this.__tooltip_show_delay_timeout_wait=setTimeout(function(){i.__tooltip_show_delay_timeout_wait=null,t.Chat.Selector.get("tooltips_new_messages").safe_css_text("display","block"),t.Chat.Selector.get("tooltips_new_messages").addClass(a),_.length>0&&(t.Chat.Selector._shade_sel.attr("data-visible-subtle","true"),t.Action.is_chat_closed()===!0&&t.Chat.Selector._shade_sel.addClass(t.Chat.Interface._visibility_animate_classes.shade.maximize)),setTimeout(function(){t.Chat.Selector._shade_sel.removeClass(t.Chat.Interface._visibility_animate_classes.shade.maximize),t.Chat.Selector.get("tooltips_new_messages").removeClass(a)},i.__animate_new_messages_tooltip_timeout)},this.__tooltip_show_delay*this.__second_in_milliseconds)):(t.Chat.Selector.get("tooltips_new_messages").safe_css_text("display","block"),_.length>0&&t.Chat.Selector._shade_sel.attr("data-visible-subtle","true")),t.Chat.Selector.get("pane_unread").safe_css_text("display","block")),t.Chat.Message._mark_has_exchanged_messages(),t.Library.logger.info(this.ns+"."+s,"Pending notifications count now: "+e)}else null!==this.__tooltip_show_delay_timeout_wait&&clearTimeout(this.__tooltip_show_delay_timeout_wait),t.Chat.Selector.get("tooltips_new_messages").removeClass(a),t.Chat.Selector.get("tooltips_new_messages").safe_css_text("display","none"),t.Chat.Selector.get("pane_unread").safe_css_text("display","none"),t.Chat.Selector._shade_sel.attr("data-visible-subtle","false"),t.Chat.Selector.get("tooltips_extended_preview").empty(),this.__page_title_current&&(document.title=this.__page_title_current),t.Library.logger.info(this.ns+"."+s,"Cleared pending notifications")}catch(e){t.Library.logger.error(this.ns+"."+s,e)}},e.prototype._check_clearance=function(){var e="_check_clearance";try{var i=t.Chat.Selector.get("flow")[0].scrollTop,r=t.Chat.Selector.get("flow")[0].scrollHeight,n=t.Chat.Selector.get("flow")[0].clientHeight;n+i>=r-t.Chat.Interface._last_message_height&&t.Chat.Alert._update("new_messages","hide")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__show_unread_preview=function(e,i,r,n){var s="__show_unread_preview",a=[];try{var o=null,c=[];t.Chat.Selector.get("tooltips_extended_preview").empty();for(var _=r.length-1;_>=0&&!(i.indexOf(r[_].fingerprint)!==-1&&(a.unshift(r[_]),a.length>=this.__preview_stack_maximum));_--);for(var l=0;l<a.length;l++){var p=t.Library.dom(t.Template.render("chat_preview_message",{type:a[l].type,from:a[l].from,content:a[l].content,user:a[l].user||{},environment:{url:{crisp_image:t.Base._url_image}}}));p&&(p.appendTo(t.Chat.Selector.get("tooltips_extended_preview")),l===a.length-1&&null===o&&(o=a[l].fingerprint),null===o&&null!==this.__preview_stack_last_fingerprint||c.push(p))}if(null!==o&&(this.__preview_stack_last_fingerprint=o),t.Feature.has_css_animations()&&c.length>0){for(var h="crisp-259",u=0;u<c.length;u++)c[u].addClass(h);setTimeout(function(){for(var e=0;e<c.length;e++)c[e].removeClass(h)},(n===!0?this.__tooltip_show_delay*this.__second_in_milliseconds:0)+this.__animate_extended_preview_timeout)}}catch(e){t.Library.logger.error(this.ns+"."+s,e)}finally{return a}},e}()),t.Chat.Scroll=new(function(){function e(){var e="constructor";try{this.ns="CrispChatScroll",this._margin=0,this._position=0}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._to=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i="_to";try{null===e&&(e=t.Chat.Selector.get("flow")[0].scrollHeight),t.Chat.State.propagate("scroll",e),t.Chat.Notification._check_clearance()}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._to_last_message=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"to",i="_to_last_message",r=!1;try{if(t.Chat.Interface._chat_is_visible()===!0){var n=t.Chat.Selector.get("flow")[0].scrollTop,s=t.Chat.Selector.get("flow")[0].scrollHeight,a=t.Chat.Selector.get("flow")[0].clientHeight;(!n||a+n>=s-this._margin/2)&&(r=!0,this._to(),t.Library.logger.debug(this.ns+"."+i,"Scrolled down to last message")),r===!1&&"from"===e&&t.Chat.Alert._is_visible("warn_reply")===!1&&t.Chat.Alert._is_visible("email_invalid")===!1&&t.Chat.Alert._is_visible("wait_reply")===!1&&t.Chat.Alert._update("new_messages","show")}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e}()),t.Chat.Selector=new(function(){function e(){var e="constructor";try{this.ns="CrispChatSelector",this.__namespaced_class_names={pane_icon:"crisp-170",pane_avatar_resource:"crisp-172",pane_unread:"crisp-174",header:"crisp-62",header_avatar:"crisp-65",header_avatar_resource:"crisp-67",header_operator:"crisp-78",drop_over:"crisp-92",content:"crisp-85",flow:"crisp-88",flow_messages:"crisp-89",flow_events:"crisp-90",pickers:"crisp-97",pickers_selector_one:"crisp-100",pickers_inner_one:"crisp-103",pickers_search_input:"crisp-109",pickers_smiley:["crisp-103",'[data-type="smiley"]'].join(""),pickers_gif:["crisp-103",'[data-type="gif"]'].join(""),alerts:"crisp-113",alerts_one:"crisp-114",alerts_new_messages:'crisp-114[data-type="new_messages"]',alerts_email_form:'crisp-114[data-type="email_form"]',alerts_warn_reply:'crisp-114[data-type="warn_reply"]',alerts_email_invalid:'crisp-114[data-type="email_invalid"]',alerts_email_form_form:"crisp-123",alerts_email_form_input:"crisp-126",alerts_email_form_validate:["crisp-127",'[data-for="email_validate"]'].join(""),alerts_email_form_cancel:["crisp-130",'[data-for="email_validate"]'].join(""),form_container:"crisp-131",form_message:"crisp-132",form_attach:"crisp-132",form_act:"crisp-134",form_button_send:"crisp-151",form_button_smiley:'crisp-136[data-type="smiley"]',form_button_attach:'crisp-136[data-type="file"]',form_textarea_message:"crisp-133",form_input_attach:"crisp-147",tooltips_new_messages:["crisp-29",'[data-id="new_messages"]'].join(""),tooltips_new_messages_text:["crisp-163",'[data-for-id="new_messages"]'].join(""),tooltips_extended_preview:"crisp-160"},this._viewport_sel=null,this._excerpt_sel=null,this._shade_sel=null,this._chat_sel=null,this._minimized_sel=null,this.__cache={}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.get=function(e){var i="get",r=null;try{if("undefined"!=typeof this.__cache[e])r=this.__cache[e];else{if("undefined"==typeof this.__namespaced_class_names[e])throw new Error("Selector with namespace "+e+" not found");if(r=this._excerpt_sel.find("."+this.__namespaced_class_names[e]),0===r.length)throw new Error("Could not select the element with namespace: "+e);this.__cache[e]=r}}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype._bind=function(){var e="_bind";try{this.__bind_page(),this.__bind_main()}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__bind_page=function(){var e="__bind_page";try{this._viewport_sel=t.Library.dom('head meta[name="viewport"]')}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__bind_main=function(){var e="__bind_main";try{this._shade_sel=this._excerpt_sel.find(".crisp-175"),this._chat_sel=this._excerpt_sel.find(".crisp-27"),this._minimized_sel=this._excerpt_sel.find(".crisp-26")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e}()),t.Chat.State=new(function(){function e(){var e="constructor";try{this.ns="CrispChatState",this.__propagate_wait=250,this.__avatar_size=240,this.__register={trigger:this.__handle_trigger,alert:this.__handle_alert,operator:this.__handle_operator,scroll:this.__handle_scroll,maximized:this.__handle_maximized,textarea:this.__handle_textarea},this._is_restored=!1,this._session={},this.__pending={},this.__restored_state=[],this.__pending_timeout=null,this.__default={trigger:t.Trigger._processed,alert:t.Chat.Alert._states,operator:t.Chat.Misc._operator_details,scroll:t.Chat.Scroll._position,maximized:t.Chat.Interface._is_maximized,textarea:t.Chat.Field._textarea_val}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.receive=function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="receive";try{var n=void 0,s=void 0,a=0,o=[];for(n in e)e.hasOwnProperty(n)&&(t.Utility.is_equal(e[n],this._session[n])||(o.push(n),this._session[n]=e[n],i===!1&&"undefined"!=typeof this.__pending[n]&&(delete this.__pending[n],t.Library.logger.warn(this.ns+"."+r,"Received network state corrupted pending local state with namespace: "+n))));for(s=0;s<o.length;s++)n=o[s],this.__register[n].__crisp_bind(this)(this._session[n]),a++;t.Library.logger.info(this.ns+"."+r,"Received new state, applied changes: "+a)}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.propagate=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o="propagate";try{if(r!==!0&&t.Utility.is_equal(this._session[e],i))t.Library.logger.debug(this.ns+"."+o,"Ignored propagation of remote state with namespace: "+e+" because: value already propagated"),"function"==typeof s&&s(!1);else{this.__pending[e]=i,null!==this.__pending_timeout&&(clearTimeout(this.__pending_timeout),this.__pending_timeout=null,t.Library.logger.info(this.ns+"."+o,"Grouped multiple changes in a single propagation (scheduled)"));var c=t.Utility.clone(this._session);c[e]=i,this.receive(c,!0),this.__pending_timeout=setTimeout(function(){if(t.Utility.is_empty(n.__pending))t.Library.logger.warn(n.ns+"."+o+":timeout","Did not propagate remote state with namespace: "+e+" because: pending state corrupted by incoming concurrent state"),"function"==typeof s&&s(!1);else{var i=t.Utility.clone(n.__pending);n.__pending={},n.__pending_timeout=null,t.Library.crisp.client.Session.set_state(i,function(e){e?"function"==typeof a&&a():"function"==typeof s&&s(!0)}),t.Library.logger.info(n.ns+"."+o+":timeout","Propagated remote state with namespace: "+e)}},this.__propagate_wait)}}catch(e){t.Library.logger.error(this.ns+"."+o,e)}},e.prototype._restore=function(e){var i="_restore";try{t.Base._is_full_view()===!0&&(e.maximized=!1);for(var r in this.__default)"undefined"==typeof e[r]&&(e[r]=this.__default[r]);this._is_restored=!0,this._session=e,this.__restored_state=t.Utility.keys(this._session)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._retrigger=function(e){var i="_retrigger";try{this._trigger_default(e,this.__default[e]),t.Library.logger.info(this.ns+"."+i,"Retriggered stored state with namespace: "+e)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype._trigger_default_all=function(){var e="_trigger_default_all";try{var i=void 0;for(i in this.__default)this.__default.hasOwnProperty(i)&&this._trigger_default(i,this.__default[i])}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._trigger_default=function(e,i){var r="_trigger_default";try{if("function"!=typeof this.__register[e])throw new Error("No such state handler: "+e);"undefined"==typeof this._session[e]&&(this._session[e]=i),this.__register[e].__crisp_bind(this)(this._session[e])}catch(e){t.Library.logger.error(this.ns+"."+r,e)}},e.prototype.__is_popped_restored_state=function(e){var i="__is_popped_restored_state",r=!1;try{var n=this.__restored_state.indexOf(e);n!==-1&&(this.__restored_state.splice(n,1),r=!0)}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e.prototype.__handle_trigger=function(e){var i="__handle_trigger";try{this.__is_popped_restored_state("trigger");if(e&&e.length>0)for(var r=0;r<e.length;r++)t.Trigger._processed.indexOf(e[r])===-1&&t.Trigger._processed.push(e[r]);t.Library.logger.debug(this.ns+"."+i,"Handled")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__handle_alert=function(e){var i="__handle_alert";try{var r=(this.__is_popped_restored_state("alert"),void 0),n=void 0,s=void 0,a=void 0,o=void 0,c=void 0,_=void 0,l=[["show","unlock"],["unlock","show"],["hide","lock"],["lock","hide"],["lock","show"]];for(n in e)if(e.hasOwnProperty(n)){if(s=e[n],o=t.Chat.Alert._states[n],a=t.Chat.Selector.get("alerts").find([".crisp-114",'[data-type="'+n+'"]'].join("")),r=!1,o===s)r=!0;else if("unlock"!==s&&"lock"===o)r=!0;else for(c=0;c<l.length;c++)_=l[c],o===_[0]&&s===_[1]&&(r=!0);if(a.length>0&&r===!1){if("show"===s||"unlock"===s)t.Chat.Selector.get("alerts_one").safe_css_text("display","none"),a.safe_css_text("display","inline-block"),t.Chat.Selector.get("content").attr("data-has-alert-"+n,"true"),t.Library.logger.debug(this.ns+"."+i,'Alert "'+n+'" shown');else{if("hide"!==s&&"lock"!==s)throw new Error("Unknown action: "+s);a.safe_css_text("display","none"),t.Chat.Selector.get("content").removeAttr("data-has-alert-"+n),t.Library.logger.debug(this.ns+"."+i,'Alert "'+n+'" hidden')}t.Chat.Alert._states[n]=s,t.Chat.Field._focus_on_foreground()}else t.Chat.Alert._states[n]=s}t.Library.logger.debug(this.ns+"."+i,"Handled")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__handle_operator=function(e){var i="__handle_operator";try{var r=(this.__is_popped_restored_state("operator"),void 0),n=void 0,s=void 0,a=void 0,o=void 0,c=void 0;if(t.Chat.Misc._operator_details=e||{},t.Utility.is_empty(t.Chat.Misc._operator_details)?(r="initial",s="website",a=t.Base._website_id):(r="ongoing",s=e.type||"operator",a=e.user_id,o=e.avatar,n=t.Library.crisp.web.Name.parse_first_name(e.nickname)),(o||a)&&(c=t.Avatar.url(this.__avatar_size,s,a,o)),c){if("ongoing"===r){for(var _=t.Chat.Selector.get("header_avatar").first().siblings()||[],l=t.Chat.Selector.get("header_avatar").find(".crisp-69"),p=0;p<_.length;p++)t.Library.dom(_[p]).remove();l&&(l.attr("data-has-name",n?"true":"false"),l.find(".crisp-72").text(n||"")),t.Chat.Selector.get("header_operator").text(n||""),t.Chat.Selector.get("header_avatar_resource").safe_css_text("background-image","url('"+c+"')"),t.Chat.Selector.get("pane_avatar_resource").safe_css_text("background-image","url('"+c+"')"),t.Chat.Selector.get("pane_icon").attr("data-is-ongoing","true")}t.Chat.Selector._chat_sel&&t.Chat.Selector._chat_sel.attr("data-chat-status",r)}t.Library.logger.debug(this.ns+"."+i,"Handled")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__handle_scroll=function(e){var i="__handle_scroll";try{var r=this.__is_popped_restored_state("scroll");r===!1&&(t.Chat.Scroll._position=e,t.Chat.Selector.get("flow")[0].scrollTop=t.Chat.Scroll._position,t.Library.logger.debug(this.ns+"."+i,"Handled"))}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__handle_maximized=function(e){var i="__handle_maximized";try{var r=this.__is_popped_restored_state("maximized"),n=r!==!0&&!0;t.Base._runtime_configuration.lock_maximized===!0&&(e=!0),e===!1?(t.Chat.Interface._toggle_visibility(visible_target="pane",width_animations=n),t.Chat.Field._blur_from_foreground(),t.Chat.Viewport._unadapt(),t.Chat.Picker._reset(),t.Action._event("chat:closed"),t.Library.logger.info(this.ns+"."+i,"Chat minimized")):(t.Chat.Interface._toggle_visibility(visible_target="chat",width_animations=n),t.Chat.Field._focus_on_foreground(),t.Chat.Viewport._adapt(),t.Chat.Notification._check_clearance(),t.Action._event("chat:opened"),t.Library.logger.info(this.ns+"."+i,"Chat maximized")),t.Library.logger.debug(this.ns+"."+i,"Handled")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e.prototype.__handle_textarea=function(e){var i="__handle_textarea";try{this.__is_popped_restored_state("textarea");t.Action.set_message_text(e),t.Library.logger.debug(this.ns+"."+i,"Handled")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}},e}()),t.Chat.Viewport=new(function(){function e(){var e="constructor";try{this.ns="CrispChatViewport",this.__content_regex=/;/g,this.__is_adapted=!1,this.__page_meta_values=null}catch(i){t.Library.logger.error(this.ns+"."+e,i)}}return e.prototype.init=function(){var e="init";try{t.Library.logger.debug(this.ns+"."+e,"Initialize")}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._adapt=function(){var e="_adapt";try{if(t.Base._is_full_view()===!0){if(this.__is_adapted===!1){null===this.__page_meta_values&&(this.__page_meta_values=this.__parse());var i=t.Utility.clone(this.__page_meta_values);i.width="device-width",i["initial-scale"]="1",i["maximum-scale"]="1",i["user-scalable"]="0";var r=this.__generate_content_value(i);null!==t.Chat.Selector._viewport_sel&&t.Chat.Selector._viewport_sel.length>0?t.Chat.Selector._viewport_sel.attr("content",r):(t.Chat.Selector._viewport_sel=t.Library.dom(t.Template.render("viewport",{content:r})),t.Library.dom("head").append(t.Chat.Selector._viewport_sel))}this.__is_adapted=!0,t.Library.logger.debug(this.ns+"."+e,"Adapted viewport")}else this.__is_adapted=!1}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype._unadapt=function(){var e="_unadapt";try{if(this.__is_adapted===!0){if(null!==t.Chat.Selector._viewport_sel&&t.Chat.Selector._viewport_sel.length>0){var i=this.__generate_content_value(this.__page_meta_values);i?t.Chat.Selector._viewport_sel.attr("content",i):(t.Chat.Selector._viewport_sel.remove(),t.Chat.Selector._viewport_sel=null)}this.__is_adapted=!1,t.Library.logger.debug(this.ns+"."+e,"Un-adapted viewport")}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}},e.prototype.__parse=function(){var e="__parse",i={};try{if(i={},t.Chat.Selector._viewport_sel.length>0){var r=t.Chat.Selector._viewport_sel.attr("content");if(r=r.trim(),r=r.replace(this.__content_regex,",")){var n=void 0,s=void 0,a=void 0,o=void 0,c=void 0,_=void 0;for(_=r.indexOf(",")!==-1?r.split(","):[r],n=0;n<_.length;n++)s=_[n],s.indexOf("=")!==-1&&(a=s.split("="),o=a[0].trim(),c=a[1].trim(),o&&c&&(i[o]=c))}}}catch(i){t.Library.logger.error(this.ns+"."+e,i)}finally{return i}},e.prototype.__generate_content_value=function(e){var i="__generate_content_value",r="";try{var n=void 0,s=[];for(n in e)e.hasOwnProperty(n)&&s.push([n,e[n]].join("="));r=s.join(", ")}catch(e){t.Library.logger.error(this.ns+"."+i,e)}finally{return r}},e}()),_dollar_crisp={__init:t.Base.init.__crisp_bind(t.Base),__spool:{},push:t.Pipeline.push.__crisp_bind(t.Pipeline),get:t.Pipeline.get.__crisp_bind(t.Pipeline),set:t.Pipeline.set.__crisp_bind(t.Pipeline),is:t.Pipeline.is.__crisp_bind(t.Pipeline),on:t.Pipeline.on.__crisp_bind(t.Pipeline),off:t.Pipeline.off.__crisp_bind(t.Pipeline),do:t.Pipeline.do.__crisp_bind(t.Pipeline),config:t.Pipeline.config.__crisp_bind(t.Pipeline),safe:t.Pipeline.safe.__crisp_bind(t.Pipeline),help:t.Pipeline.help.__crisp_bind(t.Pipeline)},e===!0&&(_dollar_crisp.debug=t),"object"==typeof window.$crisp&&window.$crisp.length>0){_dollar_crisp.__spool.pending_actions=[];for(var r=0;r<window.$crisp.length;r++)_dollar_crisp.__spool.pending_actions.push(window.$crisp[r])}window.$crisp=_dollar_crisp}catch(t){if(e===!0)throw t}})();